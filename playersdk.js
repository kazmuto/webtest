/*! TVPlus SDK */
/*! Copyright Â© 2015-2025 INFOCITY,Inc. All rights reserved. */
/*! For license information please see playersdk.LICENSE.txt */
/*! Version: v1.3.11 */
/*! Commit: b33895dcb8979cab36d246f86648e65cc22feb5d */
var yu=Object.create;var Ks=Object.defineProperty,Tu=Object.defineProperties,bu=Object.getOwnPropertyDescriptor,Eu=Object.getOwnPropertyDescriptors,xu=Object.getOwnPropertyNames,fa=Object.getOwnPropertySymbols,pa=Object.getPrototypeOf,ma=Object.prototype.hasOwnProperty,Su=Object.prototype.propertyIsEnumerable,Lu=Reflect.get;var va=Math.pow,ga=(n,t,e)=>t in n?Ks(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,It=(n,t)=>{for(var e in t||(t={}))ma.call(t,e)&&ga(n,e,t[e]);if(fa)for(var e of fa(t))Su.call(t,e)&&ga(n,e,t[e]);return n},wt=(n,t)=>Tu(n,Eu(t));var Ci=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var Iu=(n,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of xu(t))!ma.call(n,s)&&s!==e&&Ks(n,s,{get:()=>t[s],enumerable:!(i=bu(t,s))||i.enumerable});return n};var ya=(n,t,e)=>(e=n!=null?yu(pa(n)):{},Iu(t||!n||!n.__esModule?Ks(e,"default",{value:n,enumerable:!0}):e,n));var Di=(n,t,e)=>Lu(pa(n),e,t);var Y=(n,t,e)=>new Promise((i,s)=>{var r=l=>{try{o(e.next(l))}catch(u){s(u)}},a=l=>{try{o(e.throw(l))}catch(u){s(u)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(r,a);o((e=e.apply(n,t)).next())});var zl=Ci((og,jn)=>{"use strict";var bA=Object.prototype.hasOwnProperty,Ot="~";function bi(){}Object.create&&(bi.prototype=Object.create(null),new bi().__proto__||(Ot=!1));function EA(n,t,e){this.fn=n,this.context=t,this.once=e||!1}function Vl(n,t,e,i,s){if(typeof e!="function")throw new TypeError("The listener must be a function");var r=new EA(e,i||n,s),a=Ot?Ot+t:t;return n._events[a]?n._events[a].fn?n._events[a]=[n._events[a],r]:n._events[a].push(r):(n._events[a]=r,n._eventsCount++),n}function Ls(n,t){--n._eventsCount===0?n._events=new bi:delete n._events[t]}function Dt(){this._events=new bi,this._eventsCount=0}Dt.prototype.eventNames=function(){var t=[],e,i;if(this._eventsCount===0)return t;for(i in e=this._events)bA.call(e,i)&&t.push(Ot?i.slice(1):i);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t};Dt.prototype.listeners=function(t){var e=Ot?Ot+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var s=0,r=i.length,a=new Array(r);s<r;s++)a[s]=i[s].fn;return a};Dt.prototype.listenerCount=function(t){var e=Ot?Ot+t:t,i=this._events[e];return i?i.fn?1:i.length:0};Dt.prototype.emit=function(t,e,i,s,r,a){var o=Ot?Ot+t:t;if(!this._events[o])return!1;var l=this._events[o],u=arguments.length,c,h;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,i),!0;case 4:return l.fn.call(l.context,e,i,s),!0;case 5:return l.fn.call(l.context,e,i,s,r),!0;case 6:return l.fn.call(l.context,e,i,s,r,a),!0}for(h=1,c=new Array(u-1);h<u;h++)c[h-1]=arguments[h];l.fn.apply(l.context,c)}else{var d=l.length,A;for(h=0;h<d;h++)switch(l[h].once&&this.removeListener(t,l[h].fn,void 0,!0),u){case 1:l[h].fn.call(l[h].context);break;case 2:l[h].fn.call(l[h].context,e);break;case 3:l[h].fn.call(l[h].context,e,i);break;case 4:l[h].fn.call(l[h].context,e,i,s);break;default:if(!c)for(A=1,c=new Array(u-1);A<u;A++)c[A-1]=arguments[A];l[h].fn.apply(l[h].context,c)}}return!0};Dt.prototype.on=function(t,e,i){return Vl(this,t,e,i,!1)};Dt.prototype.once=function(t,e,i){return Vl(this,t,e,i,!0)};Dt.prototype.removeListener=function(t,e,i,s){var r=Ot?Ot+t:t;if(!this._events[r])return this;if(!e)return Ls(this,r),this;var a=this._events[r];if(a.fn)a.fn===e&&(!s||a.once)&&(!i||a.context===i)&&Ls(this,r);else{for(var o=0,l=[],u=a.length;o<u;o++)(a[o].fn!==e||s&&!a[o].once||i&&a[o].context!==i)&&l.push(a[o]);l.length?this._events[r]=l.length===1?l[0]:l:Ls(this,r)}return this};Dt.prototype.removeAllListeners=function(t){var e;return t?(e=Ot?Ot+t:t,this._events[e]&&Ls(this,e)):(this._events=new bi,this._eventsCount=0),this};Dt.prototype.off=Dt.prototype.removeListener;Dt.prototype.addListener=Dt.prototype.on;Dt.prefixed=Ot;Dt.EventEmitter=Dt;typeof jn!="undefined"&&(jn.exports=Dt)});var hu=Ci(()=>{});var du=Ci(()=>{});var Au=Ci((Wp,Us)=>{(function(){"use strict";var n="input is invalid type",t="finalize already called",e=typeof window=="object",i=e?window:{};i.JS_MD5_NO_WINDOW&&(e=!1);var s=!e&&typeof self=="object",r=!i.JS_MD5_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;r?i=global:s&&(i=self);var a=!i.JS_MD5_NO_COMMON_JS&&typeof Us=="object"&&Us.exports,o=typeof define=="function"&&define.amd,l=!i.JS_MD5_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",u="0123456789abcdef".split(""),c=[128,32768,8388608,-2147483648],h=[0,8,16,24],d=["hex","array","digest","buffer","arrayBuffer","base64"],A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),f=[],p;if(l){var m=new ArrayBuffer(68);p=new Uint8Array(m),f=new Uint32Array(m)}var v=Array.isArray;(i.JS_MD5_NO_NODE_JS||!v)&&(v=function(y){return Object.prototype.toString.call(y)==="[object Array]"});var b=ArrayBuffer.isView;l&&(i.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!b)&&(b=function(y){return typeof y=="object"&&y.buffer&&y.buffer.constructor===ArrayBuffer});var T=function(y){var S=typeof y;if(S==="string")return[y,!0];if(S!=="object"||y===null)throw new Error(n);if(l&&y.constructor===ArrayBuffer)return[new Uint8Array(y),!1];if(!v(y)&&!b(y))throw new Error(n);return[y,!1]},L=function(y){return function(S){return new O(!0).update(S)[y]()}},I=function(){var y=L("hex");r&&(y=k(y)),y.create=function(){return new O},y.update=function(E){return y.create().update(E)};for(var S=0;S<d.length;++S){var x=d[S];y[x]=L(x)}return y},k=function(y){var S=hu(),x=du().Buffer,E;x.from&&!i.JS_MD5_NO_BUFFER_FROM?E=x.from:E=function(N){return new x(N)};var F=function(N){if(typeof N=="string")return S.createHash("md5").update(N,"utf8").digest("hex");if(N==null)throw new Error(n);return N.constructor===ArrayBuffer&&(N=new Uint8Array(N)),v(N)||b(N)||N.constructor===x?S.createHash("md5").update(E(N)).digest("hex"):y(N)};return F},R=function(y){return function(S,x){return new P(S,!0).update(x)[y]()}},D=function(){var y=R("hex");y.create=function(E){return new P(E)},y.update=function(E,F){return y.create(E).update(F)};for(var S=0;S<d.length;++S){var x=d[S];y[x]=R(x)}return y};function O(y){if(y)f[0]=f[16]=f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=f[9]=f[10]=f[11]=f[12]=f[13]=f[14]=f[15]=0,this.blocks=f,this.buffer8=p;else if(l){var S=new ArrayBuffer(68);this.buffer8=new Uint8Array(S),this.blocks=new Uint32Array(S)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}O.prototype.update=function(y){if(this.finalized)throw new Error(t);var S=T(y);y=S[0];for(var x=S[1],E,F=0,N,M=y.length,_=this.blocks,B=this.buffer8;F<M;){if(this.hashed&&(this.hashed=!1,_[0]=_[16],_[16]=_[1]=_[2]=_[3]=_[4]=_[5]=_[6]=_[7]=_[8]=_[9]=_[10]=_[11]=_[12]=_[13]=_[14]=_[15]=0),x)if(l)for(N=this.start;F<M&&N<64;++F)E=y.charCodeAt(F),E<128?B[N++]=E:E<2048?(B[N++]=192|E>>>6,B[N++]=128|E&63):E<55296||E>=57344?(B[N++]=224|E>>>12,B[N++]=128|E>>>6&63,B[N++]=128|E&63):(E=65536+((E&1023)<<10|y.charCodeAt(++F)&1023),B[N++]=240|E>>>18,B[N++]=128|E>>>12&63,B[N++]=128|E>>>6&63,B[N++]=128|E&63);else for(N=this.start;F<M&&N<64;++F)E=y.charCodeAt(F),E<128?_[N>>>2]|=E<<h[N++&3]:E<2048?(_[N>>>2]|=(192|E>>>6)<<h[N++&3],_[N>>>2]|=(128|E&63)<<h[N++&3]):E<55296||E>=57344?(_[N>>>2]|=(224|E>>>12)<<h[N++&3],_[N>>>2]|=(128|E>>>6&63)<<h[N++&3],_[N>>>2]|=(128|E&63)<<h[N++&3]):(E=65536+((E&1023)<<10|y.charCodeAt(++F)&1023),_[N>>>2]|=(240|E>>>18)<<h[N++&3],_[N>>>2]|=(128|E>>>12&63)<<h[N++&3],_[N>>>2]|=(128|E>>>6&63)<<h[N++&3],_[N>>>2]|=(128|E&63)<<h[N++&3]);else if(l)for(N=this.start;F<M&&N<64;++F)B[N++]=y[F];else for(N=this.start;F<M&&N<64;++F)_[N>>>2]|=y[F]<<h[N++&3];this.lastByteIndex=N,this.bytes+=N-this.start,N>=64?(this.start=N-64,this.hash(),this.hashed=!0):this.start=N}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this},O.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var y=this.blocks,S=this.lastByteIndex;y[S>>>2]|=c[S&3],S>=56&&(this.hashed||this.hash(),y[0]=y[16],y[16]=y[1]=y[2]=y[3]=y[4]=y[5]=y[6]=y[7]=y[8]=y[9]=y[10]=y[11]=y[12]=y[13]=y[14]=y[15]=0),y[14]=this.bytes<<3,y[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},O.prototype.hash=function(){var y,S,x,E,F,N,M=this.blocks;this.first?(y=M[0]-680876937,y=(y<<7|y>>>25)-271733879<<0,E=(-1732584194^y&2004318071)+M[1]-117830708,E=(E<<12|E>>>20)+y<<0,x=(-271733879^E&(y^-271733879))+M[2]-1126478375,x=(x<<17|x>>>15)+E<<0,S=(y^x&(E^y))+M[3]-1316259209,S=(S<<22|S>>>10)+x<<0):(y=this.h0,S=this.h1,x=this.h2,E=this.h3,y+=(E^S&(x^E))+M[0]-680876936,y=(y<<7|y>>>25)+S<<0,E+=(x^y&(S^x))+M[1]-389564586,E=(E<<12|E>>>20)+y<<0,x+=(S^E&(y^S))+M[2]+606105819,x=(x<<17|x>>>15)+E<<0,S+=(y^x&(E^y))+M[3]-1044525330,S=(S<<22|S>>>10)+x<<0),y+=(E^S&(x^E))+M[4]-176418897,y=(y<<7|y>>>25)+S<<0,E+=(x^y&(S^x))+M[5]+1200080426,E=(E<<12|E>>>20)+y<<0,x+=(S^E&(y^S))+M[6]-1473231341,x=(x<<17|x>>>15)+E<<0,S+=(y^x&(E^y))+M[7]-45705983,S=(S<<22|S>>>10)+x<<0,y+=(E^S&(x^E))+M[8]+1770035416,y=(y<<7|y>>>25)+S<<0,E+=(x^y&(S^x))+M[9]-1958414417,E=(E<<12|E>>>20)+y<<0,x+=(S^E&(y^S))+M[10]-42063,x=(x<<17|x>>>15)+E<<0,S+=(y^x&(E^y))+M[11]-1990404162,S=(S<<22|S>>>10)+x<<0,y+=(E^S&(x^E))+M[12]+1804603682,y=(y<<7|y>>>25)+S<<0,E+=(x^y&(S^x))+M[13]-40341101,E=(E<<12|E>>>20)+y<<0,x+=(S^E&(y^S))+M[14]-1502002290,x=(x<<17|x>>>15)+E<<0,S+=(y^x&(E^y))+M[15]+1236535329,S=(S<<22|S>>>10)+x<<0,y+=(x^E&(S^x))+M[1]-165796510,y=(y<<5|y>>>27)+S<<0,E+=(S^x&(y^S))+M[6]-1069501632,E=(E<<9|E>>>23)+y<<0,x+=(y^S&(E^y))+M[11]+643717713,x=(x<<14|x>>>18)+E<<0,S+=(E^y&(x^E))+M[0]-373897302,S=(S<<20|S>>>12)+x<<0,y+=(x^E&(S^x))+M[5]-701558691,y=(y<<5|y>>>27)+S<<0,E+=(S^x&(y^S))+M[10]+38016083,E=(E<<9|E>>>23)+y<<0,x+=(y^S&(E^y))+M[15]-660478335,x=(x<<14|x>>>18)+E<<0,S+=(E^y&(x^E))+M[4]-405537848,S=(S<<20|S>>>12)+x<<0,y+=(x^E&(S^x))+M[9]+568446438,y=(y<<5|y>>>27)+S<<0,E+=(S^x&(y^S))+M[14]-1019803690,E=(E<<9|E>>>23)+y<<0,x+=(y^S&(E^y))+M[3]-187363961,x=(x<<14|x>>>18)+E<<0,S+=(E^y&(x^E))+M[8]+1163531501,S=(S<<20|S>>>12)+x<<0,y+=(x^E&(S^x))+M[13]-1444681467,y=(y<<5|y>>>27)+S<<0,E+=(S^x&(y^S))+M[2]-51403784,E=(E<<9|E>>>23)+y<<0,x+=(y^S&(E^y))+M[7]+1735328473,x=(x<<14|x>>>18)+E<<0,S+=(E^y&(x^E))+M[12]-1926607734,S=(S<<20|S>>>12)+x<<0,F=S^x,y+=(F^E)+M[5]-378558,y=(y<<4|y>>>28)+S<<0,E+=(F^y)+M[8]-2022574463,E=(E<<11|E>>>21)+y<<0,N=E^y,x+=(N^S)+M[11]+1839030562,x=(x<<16|x>>>16)+E<<0,S+=(N^x)+M[14]-35309556,S=(S<<23|S>>>9)+x<<0,F=S^x,y+=(F^E)+M[1]-1530992060,y=(y<<4|y>>>28)+S<<0,E+=(F^y)+M[4]+1272893353,E=(E<<11|E>>>21)+y<<0,N=E^y,x+=(N^S)+M[7]-155497632,x=(x<<16|x>>>16)+E<<0,S+=(N^x)+M[10]-1094730640,S=(S<<23|S>>>9)+x<<0,F=S^x,y+=(F^E)+M[13]+681279174,y=(y<<4|y>>>28)+S<<0,E+=(F^y)+M[0]-358537222,E=(E<<11|E>>>21)+y<<0,N=E^y,x+=(N^S)+M[3]-722521979,x=(x<<16|x>>>16)+E<<0,S+=(N^x)+M[6]+76029189,S=(S<<23|S>>>9)+x<<0,F=S^x,y+=(F^E)+M[9]-640364487,y=(y<<4|y>>>28)+S<<0,E+=(F^y)+M[12]-421815835,E=(E<<11|E>>>21)+y<<0,N=E^y,x+=(N^S)+M[15]+530742520,x=(x<<16|x>>>16)+E<<0,S+=(N^x)+M[2]-995338651,S=(S<<23|S>>>9)+x<<0,y+=(x^(S|~E))+M[0]-198630844,y=(y<<6|y>>>26)+S<<0,E+=(S^(y|~x))+M[7]+1126891415,E=(E<<10|E>>>22)+y<<0,x+=(y^(E|~S))+M[14]-1416354905,x=(x<<15|x>>>17)+E<<0,S+=(E^(x|~y))+M[5]-57434055,S=(S<<21|S>>>11)+x<<0,y+=(x^(S|~E))+M[12]+1700485571,y=(y<<6|y>>>26)+S<<0,E+=(S^(y|~x))+M[3]-1894986606,E=(E<<10|E>>>22)+y<<0,x+=(y^(E|~S))+M[10]-1051523,x=(x<<15|x>>>17)+E<<0,S+=(E^(x|~y))+M[1]-2054922799,S=(S<<21|S>>>11)+x<<0,y+=(x^(S|~E))+M[8]+1873313359,y=(y<<6|y>>>26)+S<<0,E+=(S^(y|~x))+M[15]-30611744,E=(E<<10|E>>>22)+y<<0,x+=(y^(E|~S))+M[6]-1560198380,x=(x<<15|x>>>17)+E<<0,S+=(E^(x|~y))+M[13]+1309151649,S=(S<<21|S>>>11)+x<<0,y+=(x^(S|~E))+M[4]-145523070,y=(y<<6|y>>>26)+S<<0,E+=(S^(y|~x))+M[11]-1120210379,E=(E<<10|E>>>22)+y<<0,x+=(y^(E|~S))+M[2]+718787259,x=(x<<15|x>>>17)+E<<0,S+=(E^(x|~y))+M[9]-343485551,S=(S<<21|S>>>11)+x<<0,this.first?(this.h0=y+1732584193<<0,this.h1=S-271733879<<0,this.h2=x-1732584194<<0,this.h3=E+271733878<<0,this.first=!1):(this.h0=this.h0+y<<0,this.h1=this.h1+S<<0,this.h2=this.h2+x<<0,this.h3=this.h3+E<<0)},O.prototype.hex=function(){this.finalize();var y=this.h0,S=this.h1,x=this.h2,E=this.h3;return u[y>>>4&15]+u[y&15]+u[y>>>12&15]+u[y>>>8&15]+u[y>>>20&15]+u[y>>>16&15]+u[y>>>28&15]+u[y>>>24&15]+u[S>>>4&15]+u[S&15]+u[S>>>12&15]+u[S>>>8&15]+u[S>>>20&15]+u[S>>>16&15]+u[S>>>28&15]+u[S>>>24&15]+u[x>>>4&15]+u[x&15]+u[x>>>12&15]+u[x>>>8&15]+u[x>>>20&15]+u[x>>>16&15]+u[x>>>28&15]+u[x>>>24&15]+u[E>>>4&15]+u[E&15]+u[E>>>12&15]+u[E>>>8&15]+u[E>>>20&15]+u[E>>>16&15]+u[E>>>28&15]+u[E>>>24&15]},O.prototype.toString=O.prototype.hex,O.prototype.digest=function(){this.finalize();var y=this.h0,S=this.h1,x=this.h2,E=this.h3;return[y&255,y>>>8&255,y>>>16&255,y>>>24&255,S&255,S>>>8&255,S>>>16&255,S>>>24&255,x&255,x>>>8&255,x>>>16&255,x>>>24&255,E&255,E>>>8&255,E>>>16&255,E>>>24&255]},O.prototype.array=O.prototype.digest,O.prototype.arrayBuffer=function(){this.finalize();var y=new ArrayBuffer(16),S=new Uint32Array(y);return S[0]=this.h0,S[1]=this.h1,S[2]=this.h2,S[3]=this.h3,y},O.prototype.buffer=O.prototype.arrayBuffer,O.prototype.base64=function(){for(var y,S,x,E="",F=this.array(),N=0;N<15;)y=F[N++],S=F[N++],x=F[N++],E+=A[y>>>2]+A[(y<<4|S>>>4)&63]+A[(S<<2|x>>>6)&63]+A[x&63];return y=F[N],E+=A[y>>>2]+A[y<<4&63]+"==",E};function P(y,S){var x,E=T(y);if(y=E[0],E[1]){var F=[],N=y.length,M=0,_;for(x=0;x<N;++x)_=y.charCodeAt(x),_<128?F[M++]=_:_<2048?(F[M++]=192|_>>>6,F[M++]=128|_&63):_<55296||_>=57344?(F[M++]=224|_>>>12,F[M++]=128|_>>>6&63,F[M++]=128|_&63):(_=65536+((_&1023)<<10|y.charCodeAt(++x)&1023),F[M++]=240|_>>>18,F[M++]=128|_>>>12&63,F[M++]=128|_>>>6&63,F[M++]=128|_&63);y=F}y.length>64&&(y=new O(!0).update(y).array());var B=[],X=[];for(x=0;x<64;++x){var H=y[x]||0;B[x]=92^H,X[x]=54^H}O.call(this,S),this.update(X),this.oKeyPad=B,this.inner=!0,this.sharedMemory=S}P.prototype=new O,P.prototype.finalize=function(){if(O.prototype.finalize.call(this),this.inner){this.inner=!1;var y=this.array();O.call(this,this.sharedMemory),this.update(this.oKeyPad),this.update(y),O.prototype.finalize.call(this)}};var V=I();V.md5=V,V.md5.hmac=D(),a?Us.exports=V:(i.md5=V,o&&define(function(){return V}))})()});var z=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},Ru=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=Pu},Pu=Number.MAX_SAFE_INTEGER||9007199254740991,G=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),w=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",n.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",n.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.ASSET_LIST_LOAD_ERROR="assetListLoadError",n.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",n.ASSET_LIST_PARSING_ERROR="assetListParsingError",n.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.ATTACH_MEDIA_ERROR="attachMediaError",n.UNKNOWN="unknown",n}({}),g=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.MEDIA_ENDED="hlsMediaEnded",n.STALL_RESOLVED="hlsStallResolved",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFERED_TO_END="hlsBufferedToEnd",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n.ASSET_LIST_LOADING="hlsAssetListLoading",n.ASSET_LIST_LOADED="hlsAssetListLoaded",n.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",n.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",n.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",n.INTERSTITIAL_STARTED="hlsInterstitialStarted",n.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",n.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",n.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",n.INTERSTITIAL_ENDED="hlsInterstitialEnded",n.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",n.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",n.EVENT_CUE_ENTER="hlsEventCueEnter",n}({}),tt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},W={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},pe=class{constructor(t,e=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}sample(t,e){let i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){let t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}},mr=class{constructor(t,e,i,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new pe(t),this.fast_=new pe(e),this.defaultTTFB_=s,this.ttfb_=new pe(t)}update(t,e){let{slow_:i,fast_:s,ttfb_:r}=this;i.halfLife!==t&&(this.slow_=new pe(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.fast_=new pe(e,s.getEstimate(),s.getTotalWeight())),r.halfLife!==t&&(this.ttfb_=new pe(t,r.getEstimate(),r.getTotalWeight()))}sample(t,e){t=Math.max(t,this.minDelayMs_);let i=8*e,s=t/1e3,r=i/s;this.fast_.sample(s,r),this.slow_.sample(s,r)}sampleTTFB(t){let e=t/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(i,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}};function Cu(n,t,e){return(t=wu(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function ct(){return ct=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)({}).hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},ct.apply(null,arguments)}function Ta(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);t&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,i)}return e}function at(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Ta(Object(e),!0).forEach(function(i){Cu(n,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Ta(Object(e)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(e,i))})}return n}function Du(n,t){if(typeof n!="object"||!n)return n;var e=n[Symbol.toPrimitive];if(e!==void 0){var i=e.call(n,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function wu(n){var t=Du(n,"string");return typeof t=="symbol"?t:t+""}var Qt=class{constructor(t,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;let i=`[${t}]:`;this.trace=me,this.debug=e.debug.bind(null,i),this.log=e.log.bind(null,i),this.warn=e.warn.bind(null,i),this.info=e.info.bind(null,i),this.error=e.error.bind(null,i)}},me=function(){},Ou={trace:me,debug:me,log:me,warn:me,info:me,error:me};function vr(){return ct({},Ou)}function ku(n,t){let e=self.console[n];return e?e.bind(self.console,`${t?"["+t+"] ":""}[${n}] >`):me}function ba(n,t,e){return t[n]?t[n].bind(t):ku(n,e)}var yr=vr();function Mu(n,t,e){let i=vr();if(typeof console=="object"&&n===!0||typeof n=="object"){let s=["debug","log","info","warn","error"];s.forEach(r=>{i[r]=ba(r,n,e)});try{i.log(`Debug logs enabled for "${t}" in hls.js version ${void 0}`)}catch(r){return vr()}s.forEach(r=>{yr[r]=ba(r,n)})}else ct(yr,i);return i}var it=yr;function ye(n=!0){return typeof self=="undefined"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function _u(n){return typeof self!="undefined"&&n===self.ManagedMediaSource}function Po(n,t){let e=Object.keys(n),i=Object.keys(t),s=e.length,r=i.length;return!s||!r||s===r&&!e.some(a=>i.indexOf(a)===-1)}function Ut(n,t=!1){if(typeof TextDecoder!="undefined"){let u=new TextDecoder("utf-8").decode(n);if(t){let c=u.indexOf("\0");return c!==-1?u.substring(0,c):u}return u.replace(/\0/g,"")}let e=n.length,i,s,r,a="",o=0;for(;o<e;){if(i=n[o++],i===0&&t)return a;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:s=n[o++],a+=String.fromCharCode((i&31)<<6|s&63);break;case 14:s=n[o++],r=n[o++],a+=String.fromCharCode((i&15)<<12|(s&63)<<6|(r&63)<<0);break}}return a}var ie={hexDump:function(n){let t="";for(let e=0;e<n.length;e++){let i=n[e].toString(16);i.length<2&&(i="0"+i),t+=i}return t}};function Nu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Zs={exports:{}},Ea;function Fu(){return Ea||(Ea=1,function(n,t){(function(e){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,u,c){if(c=c||{},l=l.trim(),u=u.trim(),!u){if(!c.alwaysNormalize)return l;var h=o.parseURL(l);if(!h)throw new Error("Error trying to parse base URL.");return h.path=o.normalizePath(h.path),o.buildURLFromParts(h)}var d=o.parseURL(u);if(!d)throw new Error("Error trying to parse relative URL.");if(d.scheme)return c.alwaysNormalize?(d.path=o.normalizePath(d.path),o.buildURLFromParts(d)):u;var A=o.parseURL(l);if(!A)throw new Error("Error trying to parse base URL.");if(!A.netLoc&&A.path&&A.path[0]!=="/"){var f=s.exec(A.path);A.netLoc=f[1],A.path=f[2]}A.netLoc&&!A.path&&(A.path="/");var p={scheme:A.scheme,netLoc:d.netLoc,path:null,params:d.params,query:d.query,fragment:d.fragment};if(!d.netLoc&&(p.netLoc=A.netLoc,d.path[0]!=="/"))if(!d.path)p.path=A.path,d.params||(p.params=A.params,d.query||(p.query=A.query));else{var m=A.path,v=m.substring(0,m.lastIndexOf("/")+1)+d.path;p.path=o.normalizePath(v)}return p.path===null&&(p.path=c.alwaysNormalize?o.normalizePath(d.path):d.path),o.buildURLFromParts(p)},parseURL:function(l){var u=i.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(r,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};n.exports=o})()}(Zs)),Zs.exports}var On=Fu(),li=class{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},ut={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"},Yi=class{constructor(t){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof t=="string"&&(t={url:t}),this.base=t,Uu(this,"stats")}setByteRange(t,e){let i=t.split("@",2),s;i.length===1?s=(e==null?void 0:e.byteRangeEndOffset)||0:s=parseInt(i[1]),this._byteRange=[s,parseInt(i[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[ut.AUDIO]:null,[ut.VIDEO]:null,[ut.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(t){this._streams=t}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new li),this._stats}set stats(t){this._stats=t}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=On.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}clearElementaryStreamInfo(){let{elementaryStreams:t}=this;t[ut.AUDIO]=null,t[ut.VIDEO]=null,t[ut.AUDIOVIDEO]=null}};function xt(n){return n.sn!=="initSegment"}var ri=class extends Yi{constructor(t,e){super(e),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get byteLength(){if(this.hasStats){let t=this.stats.total;if(t)return t}if(this.byteRange){let t=this.byteRange[0],e=this.byteRange[1];if(z(t)&&z(e))return e-t}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(t){this._bitrate=t}get decryptdata(){let{levelkeys:t}=this;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){let e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{let i=Object.keys(this.levelkeys);if(i.length===1)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;let t=z(this.duration)?this.duration:0;return this.programDateTime+t*1e3}get encrypted(){var t;if((t=this._decryptdata)!=null&&t.encrypted)return!0;if(this.levelkeys){let e=Object.keys(this.levelkeys),i=e.length;if(i>1||i===1&&this.levelkeys[e[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(t){if(!z(t)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=t}get ref(){return xt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(t){this.setStart(this.start+t)}setStart(t){this.start=t,this._ref&&(this._ref.start=t)}setDuration(t){this.duration=t,this._ref&&(this._ref.duration=t)}setKeyFormat(t){if(this.levelkeys){let e=this.levelkeys[t];e&&!this._decryptdata&&(this._decryptdata=e.getDecryptData(this.sn))}}abortRequests(){var t,e;(t=this.loader)==null||t.abort(),(e=this.keyLoader)==null||e.abort()}setElementaryStreamInfo(t,e,i,s,r,a=!1){let{elementaryStreams:o}=this,l=o[t];if(!l){o[t]={startPTS:e,endPTS:i,startDTS:s,endDTS:r,partial:a};return}l.startPTS=Math.min(l.startPTS,e),l.endPTS=Math.max(l.endPTS,i),l.startDTS=Math.min(l.startDTS,s),l.endDTS=Math.max(l.endDTS,r)}},Tr=class extends Yi{constructor(t,e,i,s,r){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=s;let a=t.enumeratedString("BYTERANGE");a&&this.setByteRange(a,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){let{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}};function Co(n,t){let e=Object.getPrototypeOf(n);if(e){let i=Object.getOwnPropertyDescriptor(e,t);return i||Co(e,t)}}function Uu(n,t){let e=Co(n,t);e&&(e.enumerable=!0,Object.defineProperty(n,t,e))}var Qi=Math.pow(2,32)-1,Bu=[].push,Do={video:1,audio:2,id3:3,text:4};function vt(n){return String.fromCharCode.apply(null,n)}function wo(n,t){let e=n[t]<<8|n[t+1];return e<0?65536+e:e}function q(n,t){let e=Oo(n,t);return e<0?4294967296+e:e}function xa(n,t){let e=q(n,t);return e*=Math.pow(2,32),e+=q(n,t+4),e}function Oo(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]}function Ys(n,t,e){n[t]=e>>24,n[t+1]=e>>16&255,n[t+2]=e>>8&255,n[t+3]=e&255}function Vu(n){let t=n.byteLength;for(let e=0;e<t;){let i=q(n,e);if(i>8&&n[e+4]===109&&n[e+5]===111&&n[e+6]===111&&n[e+7]===102)return!0;e=i>1?e+i:t}return!1}function Z(n,t){let e=[];if(!t.length)return e;let i=n.byteLength;for(let s=0;s<i;){let r=q(n,s),a=vt(n.subarray(s+4,s+8)),o=r>1?s+r:i;if(a===t[0])if(t.length===1)e.push(n.subarray(s+8,o));else{let l=Z(n.subarray(s+8,o),t.slice(1));l.length&&Bu.apply(e,l)}s=o}return e}function zu(n){let t=[],e=n[0],i=8,s=q(n,i);i+=4;let r=0,a=0;e===0?(r=q(n,i),a=q(n,i+4),i+=8):(r=xa(n,i),a=xa(n,i+8),i+=16),i+=2;let o=n.length+a,l=wo(n,i);i+=2;for(let u=0;u<l;u++){let c=i,h=q(n,c);c+=4;let d=h&2147483647;if((h&2147483648)>>>31===1)return it.warn("SIDX has hierarchical references (not supported)"),null;let f=q(n,c);c+=4,t.push({referenceSize:d,subsegmentDuration:f,info:{duration:f/s,start:o,end:o+d-1}}),o+=d,c+=4,i=c}return{earliestPresentationTime:r,timescale:s,version:e,referencesCount:l,references:t}}function ko(n){let t=[],e=Z(n,["moov","trak"]);for(let s=0;s<e.length;s++){let r=e[s],a=Z(r,["tkhd"])[0];if(a){let o=a[0],l=q(a,o===0?12:20),u=Z(r,["mdia","mdhd"])[0];if(u){o=u[0];let c=q(u,o===0?12:20),h=Z(r,["mdia","hdlr"])[0];if(h){let d=vt(h.subarray(8,12)),A={soun:ut.AUDIO,vide:ut.VIDEO}[d],f=Z(r,["mdia","minf","stbl","stsd"])[0],p=Wu(f);A?(t[l]={timescale:c,type:A,stsd:p},t[A]=at({timescale:c,id:l},p)):t[l]={timescale:c,type:d,stsd:p}}}}}return Z(n,["moov","mvex","trex"]).forEach(s=>{let r=q(s,4),a=t[r];a&&(a.default={duration:q(s,12),flags:q(s,20)})}),t}function Wu(n){let t=n.subarray(8),e=t.subarray(8+78),i=vt(t.subarray(4,8)),s=i,r,a=i==="enca"||i==="encv";if(a){let u=Z(t,[i])[0].subarray(i==="enca"?28:78);Z(u,["sinf"]).forEach(h=>{let d=Z(h,["schm"])[0];if(d){let A=vt(d.subarray(4,8));if(A==="cbcs"||A==="cenc"){let f=Z(h,["frma"])[0];f&&(s=vt(f))}}})}let o=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{let l=Z(e,["avcC"])[0];l&&l.length>3&&(s+="."+Oi(l[1])+Oi(l[2])+Oi(l[3]),r=wi(o==="avc1"?"dva1":"dvav",e));break}case"mp4a":{let l=Z(t,[i])[0],u=Z(l.subarray(28),["esds"])[0];if(u&&u.length>7){let c=4;if(u[c++]!==3)break;c=Qs(u,c),c+=2;let h=u[c++];if(h&128&&(c+=2),h&64&&(c+=u[c++]),u[c++]!==4)break;c=Qs(u,c);let d=u[c++];if(d===64)s+="."+Oi(d);else break;if(c+=12,u[c++]!==5)break;c=Qs(u,c);let A=u[c++],f=(A&248)>>3;f===31&&(f+=1+((A&7)<<3)+((u[c]&224)>>5)),s+="."+f}break}case"hvc1":case"hev1":{let l=Z(e,["hvcC"])[0];if(l&&l.length>12){let u=l[1],c=["","A","B","C"][u>>6],h=u&31,d=q(l,2),A=(u&32)>>5?"H":"L",f=l[12],p=l.subarray(6,12);s+="."+c+h,s+="."+d.toString(16).toUpperCase(),s+="."+A+f;let m="";for(let v=p.length;v--;){let b=p[v];(b||m)&&(m="."+b.toString(16).toUpperCase()+m)}s+=m}r=wi(o=="hev1"?"dvhe":"dvh1",e);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=wi(s,e)||s;break}case"vp09":{let l=Z(e,["vpcC"])[0];if(l&&l.length>6){let u=l[4],c=l[5],h=l[6]>>4&15;s+="."+ee(u)+"."+ee(c)+"."+ee(h)}break}case"av01":{let l=Z(e,["av1C"])[0];if(l&&l.length>2){let u=l[1]>>>5,c=l[1]&31,h=l[2]>>>7?"H":"M",d=(l[2]&64)>>6,A=(l[2]&32)>>5,f=u===2&&d?A?12:10:d?10:8,p=(l[2]&16)>>4,m=(l[2]&8)>>3,v=(l[2]&4)>>2,b=l[2]&3,T=1,L=1,I=1,k=0;s+="."+u+"."+ee(c)+h+"."+ee(f)+"."+p+"."+m+v+b+"."+ee(T)+"."+ee(L)+"."+ee(I)+"."+k,r=wi("dav1",e)}break}}return{codec:s,encrypted:a,supplemental:r}}function wi(n,t){let e=Z(t,["dvvC"]),i=e.length?e[0]:Z(t,["dvcC"])[0];if(i){let s=i[2]>>1&127,r=i[2]<<5&32|i[3]>>3&31;return n+"."+ee(s)+"."+ee(r)}}function Qs(n,t){let e=t+5;for(;n[t++]&128&&t<e;);return t}function Oi(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function ee(n){return(n<10?"0":"")+n}function Gu(n,t){if(!n||!t)return n;let e=t.keyId;return e&&t.isCommonEncryption&&Z(n,["moov","trak"]).forEach(s=>{let a=Z(s,["mdia","minf","stbl","stsd"])[0].subarray(8),o=Z(a,["enca"]),l=o.length>0;l||(o=Z(a,["encv"])),o.forEach(u=>{let c=l?u.subarray(28):u.subarray(78);Z(c,["sinf"]).forEach(d=>{let A=Mo(d);if(A){let f=A.subarray(8,24);f.some(p=>p!==0)||(it.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${ie.hexDump(f)} -> ${ie.hexDump(e)}`),A.set(e,8))}})})}),n}function Mo(n){let t=Z(n,["schm"])[0];if(t){let e=vt(t.subarray(4,8));if(e==="cbcs"||e==="cenc")return Z(n,["schi","tenc"])[0]}return null}function Hu(n,t){return Z(t,["moof","traf"]).reduce((e,i)=>{let s=Z(i,["tfdt"])[0],r=s[0],a=Z(i,["tfhd"]).reduce((o,l)=>{let u=q(l,4),c=n[u];if(c){let h=q(s,4);if(r===1){if(h===Qi)return it.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),o;h*=Qi+1,h+=q(s,8)}let d=c.timescale||9e4,A=h/d;if(z(A)&&(o===null||A<o))return A}return o},null);return a!==null&&z(a)&&(e===null||a<e)?a:e},null)}function Xu(n,t){let e=0,i=0,s=0,r=Z(n,["moof","traf"]);for(let a=0;a<r.length;a++){let o=r[a],l=Z(o,["tfhd"])[0],u=q(l,4),c=t[u];if(!c)continue;let h=c.default,d=q(l,0)|(h==null?void 0:h.flags),A=h==null?void 0:h.duration;d&8&&(d&2?A=q(l,12):A=q(l,8));let f=c.timescale||9e4,p=Z(o,["trun"]);for(let m=0;m<p.length;m++){if(e=qu(p[m]),!e&&A){let v=q(p[m],4);e=A*v}c.type===ut.VIDEO?i+=e/f:c.type===ut.AUDIO&&(s+=e/f)}}if(i===0&&s===0){let a=1/0,o=0,l=0,u=Z(n,["sidx"]);for(let c=0;c<u.length;c++){let h=zu(u[c]);if(h!=null&&h.references){a=Math.min(a,h.earliestPresentationTime/h.timescale);let d=h.references.reduce((A,f)=>A+f.info.duration||0,0);o=Math.max(o,d+h.earliestPresentationTime/h.timescale),l=o-a}}if(l&&z(l))return l}return i||s}function qu(n){let t=q(n,0),e=8;t&1&&(e+=4),t&4&&(e+=4);let i=0,s=q(n,4);for(let r=0;r<s;r++){if(t&256){let a=q(n,e);i+=a,e+=4}t&512&&(e+=4),t&1024&&(e+=4),t&2048&&(e+=4)}return i}function ju(n,t,e){Z(t,["moof","traf"]).forEach(i=>{Z(i,["tfhd"]).forEach(s=>{let r=q(s,4),a=n[r];if(!a)return;let o=a.timescale||9e4;Z(i,["tfdt"]).forEach(l=>{let u=l[0],c=e*o;if(c){let h=q(l,4);if(u===0)h-=c,h=Math.max(h,0),Ys(l,4,h);else{h*=Math.pow(2,32),h+=q(l,8),h-=c,h=Math.max(h,0);let d=Math.floor(h/(Qi+1)),A=Math.floor(h%(Qi+1));Ys(l,4,d),Ys(l,8,A)}}})})})}function Ku(n){let t={valid:null,remainder:null},e=Z(n,["moof"]);if(e.length<2)return t.remainder=n,t;let i=e[e.length-1];return t.valid=n.slice(0,i.byteOffset-8),t.remainder=n.slice(i.byteOffset-8),t}function Ht(n,t){let e=new Uint8Array(n.length+t.length);return e.set(n),e.set(t,n.length),e}function Sa(n,t){let e=[],i=t.samples,s=t.timescale,r=t.id,a=!1;return Z(i,["moof"]).map(l=>{let u=l.byteOffset-8;Z(l,["traf"]).map(h=>{let d=Z(h,["tfdt"]).map(A=>{let f=A[0],p=q(A,4);return f===1&&(p*=Math.pow(2,32),p+=q(A,8)),p/s})[0];return d!==void 0&&(n=d),Z(h,["tfhd"]).map(A=>{let f=q(A,4),p=q(A,0)&16777215,m=(p&1)!==0,v=(p&2)!==0,b=(p&8)!==0,T=0,L=(p&16)!==0,I=0,k=(p&32)!==0,R=8;f===r&&(m&&(R+=8),v&&(R+=4),b&&(T=q(A,R),R+=4),L&&(I=q(A,R),R+=4),k&&(R+=4),t.type==="video"&&(a=xs(t.codec)),Z(h,["trun"]).map(D=>{let O=D[0],P=q(D,0)&16777215,V=(P&1)!==0,y=0,S=(P&4)!==0,x=(P&256)!==0,E=0,F=(P&512)!==0,N=0,M=(P&1024)!==0,_=(P&2048)!==0,B=0,X=q(D,4),H=8;V&&(y=q(D,H),H+=4),S&&(H+=4);let J=y+u;for(let et=0;et<X;et++){if(x?(E=q(D,H),H+=4):E=T,F?(N=q(D,H),H+=4):N=I,M&&(H+=4),_&&(O===0?B=q(D,H):B=Oo(D,H),H+=4),t.type===ut.VIDEO){let st=0;for(;st<N;){let nt=q(i,J);if(J+=4,Zu(a,i[J])){let Tt=i.subarray(J,J+nt);kn(Tt,a?2:1,n+B/s,e)}J+=nt,st+=nt+4}}n+=E/s}}))})})}),e}function xs(n){if(!n)return!1;let t=n.substring(0,4);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function Zu(n,t){if(n){let e=t>>1&63;return e===39||e===40}else return(t&31)===6}function kn(n,t,e,i){let s=_o(n),r=0;r+=t;let a=0,o=0,l=0;for(;r<s.length;){a=0;do{if(r>=s.length)break;l=s[r++],a+=l}while(l===255);o=0;do{if(r>=s.length)break;l=s[r++],o+=l}while(l===255);let u=s.length-r,c=r;if(o<u)r+=o;else if(o>u){it.error(`Malformed SEI payload. ${o} is too small, only ${u} bytes left to parse.`);break}if(a===4){if(s[c++]===181){let d=wo(s,c);if(c+=2,d===49){let A=q(s,c);if(c+=4,A===1195456820){let f=s[c++];if(f===3){let p=s[c++],m=31&p,v=64&p,b=v?2+m*3:0,T=new Uint8Array(b);if(v){T[0]=p;for(let L=1;L<b;L++)T[L]=s[c++]}i.push({type:f,payloadType:a,pts:e,bytes:T})}}}}}else if(a===5&&o>16){let h=[];for(let f=0;f<16;f++){let p=s[c++].toString(16);h.push(p.length==1?"0"+p:p),(f===3||f===5||f===7||f===9)&&h.push("-")}let d=o-16,A=new Uint8Array(d);for(let f=0;f<d;f++)A[f]=s[c++];i.push({payloadType:a,pts:e,uuid:h.join(""),userData:Ut(A),userDataBytes:A})}}}function _o(n){let t=n.byteLength,e=[],i=1;for(;i<t-2;)n[i]===0&&n[i+1]===0&&n[i+2]===3?(e.push(i+2),i+=2):i++;if(e.length===0)return n;let s=t-e.length,r=new Uint8Array(s),a=0;for(i=0;i<s;a++,i++)a===e[0]&&(a++,e.shift()),r[i]=n[a];return r}function Yu(n){let t=n[0],e="",i="",s=0,r=0,a=0,o=0,l=0,u=0;if(t===0){for(;vt(n.subarray(u,u+1))!=="\0";)e+=vt(n.subarray(u,u+1)),u+=1;for(e+=vt(n.subarray(u,u+1)),u+=1;vt(n.subarray(u,u+1))!=="\0";)i+=vt(n.subarray(u,u+1)),u+=1;i+=vt(n.subarray(u,u+1)),u+=1,s=q(n,12),r=q(n,16),o=q(n,20),l=q(n,24),u=28}else if(t===1){u+=4,s=q(n,u),u+=4;let h=q(n,u);u+=4;let d=q(n,u);for(u+=4,a=va(2,32)*h+d,Ru(a)||(a=Number.MAX_SAFE_INTEGER,it.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=q(n,u),u+=4,l=q(n,u),u+=4;vt(n.subarray(u,u+1))!=="\0";)e+=vt(n.subarray(u,u+1)),u+=1;for(e+=vt(n.subarray(u,u+1)),u+=1;vt(n.subarray(u,u+1))!=="\0";)i+=vt(n.subarray(u,u+1)),u+=1;i+=vt(n.subarray(u,u+1)),u+=1}let c=n.subarray(u,n.byteLength);return{schemeIdUri:e,value:i,timeScale:s,presentationTime:a,presentationTimeDelta:r,eventDuration:o,id:l,payload:c}}function Qu(n,...t){let e=t.length,i=8,s=e;for(;s--;)i+=t[s].byteLength;let r=new Uint8Array(i);for(r[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=i&255,r.set(n,4),s=0,i=8;s<e;s++)r.set(t[s],i),i+=t[s].byteLength;return r}function Ju(n,t,e){if(n.byteLength!==16)throw new RangeError("Invalid system id");let i,s;i=0,s=new Uint8Array;let r;i>0?(r=new Uint8Array(4),t.length>0&&new DataView(r.buffer).setUint32(0,t.length,!1)):r=new Uint8Array;let a=new Uint8Array(4);return e&&e.byteLength>0&&new DataView(a.buffer).setUint32(0,e.byteLength,!1),Qu([112,115,115,104],new Uint8Array([i,0,0,0]),n,r,s,a,e||new Uint8Array)}function $u(n){let t=[];if(n instanceof ArrayBuffer){let e=n.byteLength,i=0;for(;i+32<e;){let s=new DataView(n,i),r=tc(s);t.push(r),i+=r.size}}return t}function tc(n){let t=n.getUint32(0),e=n.byteOffset,i=n.byteLength;if(i<t)return{offset:e,size:i};if(n.getUint32(4)!==1886614376)return{offset:e,size:t};let r=n.getUint32(8)>>>24;if(r!==0&&r!==1)return{offset:e,size:t};let a=n.buffer,o=ie.hexDump(new Uint8Array(a,e+12,16)),l=n.getUint32(28),u=null,c=null;if(r===0){if(t-32<l||l<14)return{offset:e,size:t};c=new Uint8Array(a,e+32,l)}else if(r===1){if(!l||i<e+32+l*16+16)return{offset:e,size:t};u=[];for(let h=0;h<l;h++)u.push(new Uint8Array(a,e+32+h*16,16))}return{version:r,systemId:o,kids:u,data:c,offset:e,size:t}}var No=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),qe={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Fo(n,t){let e=qe[t];return!!e&&!!e[n.slice(0,4)]}function br(n,t,e=!0){return!n.split(",").some(i=>!Uo(i,t,e))}function Uo(n,t,e=!0){var i;let s=ye(e);return(i=s==null?void 0:s.isTypeSupported(ui(n,t)))!=null?i:!1}function ui(n,t){return`${t}/mp4;codecs=${n}`}function La(n){if(n){let t=n.substring(0,4);return qe.video[t]}return 2}function Ji(n){let t=No();return n.split(",").reduce((e,i)=>{let r=t&&xs(i)?9:qe.video[i];return r?(r*2+e)/(e?3:2):(qe.audio[i]+e)/(e?2:1)},0)}var Js={};function ec(n,t=!0){if(Js[n])return Js[n];let e={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[n];for(let s=0;s<e.length;s++){var i;if(Uo(e[s],"audio",t))return Js[n]=e[s],e[s];if(e[s]==="mp3"&&(i=ye(t))!=null&&i.isTypeSupported("audio/mpeg"))return""}return n}var ic=/flac|opus|mp4a\.40\.34/i;function $i(n,t=!0){return n.replace(ic,e=>ec(e.toLowerCase(),t))}function sc(n,t){let e=[];if(n){let i=n.split(",");for(let s=0;s<i.length;s++)Fo(i[s],"video")||e.push(i[s])}return t&&e.push(t),e.join(",")}function Hi(n,t){if(n&&(n.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(n)!==-1))return n;if(t){let e=t.split(",");if(e.length>1){if(n){for(let i=e.length;i--;)if(e[i].substring(0,4)===n.substring(0,4))return e[i]}return e[0]}}return t||n}function rc(n){let t=n.split(",");for(let e=0;e<t.length;e++){let i=t[e].split(".");if(i.length>2){let s=i.shift()+".";s+=parseInt(i.shift()).toString(16),s+=("000"+parseInt(i.shift()).toString(16)).slice(-4),t[e]=s}}return t.join(",")}function nc(n){if(n.startsWith("av01.")){let t=n.split("."),e=["0","111","01","01","01","0"];for(let i=t.length;i>4&&i<10;i++)t[i]=e[i-4];return t.join(".")}return n}function Ia(n){let t=ye(n)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Bo(n){return n.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}var Vo={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function zo(n,t){return{supported:!1,configurations:t,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:n}}var Ra={};function ac(n,t,e,i,s,r){let a=n.audioCodec?n.audioGroups:null,o=r==null?void 0:r.audioCodec,l=r==null?void 0:r.channels,u=l?parseInt(l):o?1/0:2,c=null;if(a!=null&&a.length)try{a.length===1&&a[0]?c=t.groups[a[0]].channels:c=a.reduce((h,d)=>{if(d){let A=t.groups[d];if(!A)throw new Error(`Audio track group ${d} not found`);Object.keys(A.channels).forEach(f=>{h[f]=(h[f]||0)+A.channels[f]})}return h},{2:0})}catch(h){return!0}return n.videoCodec!==void 0&&(n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(i,30)||n.videoRange!=="SDR"&&n.videoRange!==e||n.bitrate>Math.max(s,8e6))||!!c&&z(u)&&Object.keys(c).some(h=>parseInt(h)>u)}function Wo(n,t,e){let i=n.videoCodec,s=n.audioCodec;if(!i&&!s||!e)return Promise.resolve(Vo);let r=[];if(i){let a={width:n.width,height:n.height,bitrate:Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)),framerate:n.frameRate||30},o=n.videoRange;o!=="SDR"&&(a.transferFunction=o.toLowerCase());let l=i.split(","),u=navigator.userAgent;if(l.some(c=>xs(c))&&No())return Promise.resolve(zo(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${u})`),r));r.push.apply(r,l.map(c=>({type:"media-source",video:at(at({},a),{},{contentType:ui(nc(c),"video")})})))}return s&&n.audioGroups&&n.audioGroups.forEach(a=>{var o;!a||(o=t.groups[a])==null||o.tracks.forEach(l=>{if(l.groupId===a){let u=l.channels||"",c=parseFloat(u);z(c)&&c>2&&r.push.apply(r,s.split(",").map(h=>({type:"media-source",audio:{contentType:ui(h,"audio"),channels:""+c}})))}})}),Promise.all(r.map(a=>{let o=oc(a);return Ra[o]||(Ra[o]=e.decodingInfo(a))})).then(a=>({supported:!a.some(o=>!o.supported),configurations:r,decodingInfoResults:a})).catch(a=>({supported:!1,configurations:r,decodingInfoResults:[],error:a}))}function oc(n){let{audio:t,video:e}=n,i=e||t;if(i){let s=Bo(i.contentType);if(e)return`r${e.height}x${e.width}f${Math.ceil(e.framerate)}${e.transferFunction||"sd"}_${s}_${Math.ceil(e.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${s}`}return""}var Er=["NONE","TYPE-0","TYPE-1",null];function lc(n){return Er.indexOf(n)>-1}var ts=["SDR","PQ","HLG"];function uc(n){return!!n&&ts.indexOf(n)>-1}var Xi={No:"",Yes:"YES",v2:"v2"};function Pa(n){let{canSkipUntil:t,canSkipDateRanges:e,age:i}=n,s=i<t/2;return t&&s?e?Xi.v2:Xi.Yes:Xi.No}var es=class{constructor(t,e,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=i}addDirectives(t){let e=new self.URL(t);return this.msn!==void 0&&e.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}},De=class{constructor(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;let i=(e=t.supplemental)==null?void 0:e.videoCodec;i&&i!==t.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return Ca(this._audioGroups,t)}hasSubtitleGroup(t){return Ca(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(!!e){if(t==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(e)===-1&&i.push(e)}else if(t==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(e)===-1&&i.push(e)}}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return(t=this.audioGroups)==null?void 0:t[0]}get textGroupId(){var t;return(t=this.subtitleGroups)==null?void 0:t[0]}addFallback(){}};function Ca(n,t){return!t||!n?!1:n.indexOf(t)!==-1}function cc(){if(typeof matchMedia=="function"){let n=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(n.media!==t.media)return n.matches===!0}return!1}function hc(n,t){let e=!1,i=[];if(n&&(e=n!=="SDR",i=[n]),t){i=t.allowedVideoRanges||ts.slice(0);let s=i.join("")!=="SDR"&&!t.videoCodec;e=t.preferHDR!==void 0?t.preferHDR:s&&cc(),e||(i=["SDR"])}return{preferHDR:e,allowedVideoRanges:i}}var dc=n=>{let t=new WeakSet;return(e,i)=>{if(n&&(i=n(e,i)),typeof i=="object"&&i!==null){if(t.has(i))return;t.add(i)}return i}},ft=(n,t)=>JSON.stringify(n,dc(t));function Ac(n,t,e,i,s){let r=Object.keys(n),a=i==null?void 0:i.channels,o=i==null?void 0:i.audioCodec,l=s==null?void 0:s.videoCodec,u=a&&parseInt(a)===2,c=!1,h=!1,d=1/0,A=1/0,f=1/0,p=1/0,m=0,v=[],{preferHDR:b,allowedVideoRanges:T}=hc(t,s);for(let D=r.length;D--;){let O=n[r[D]];c||(c=O.channels[2]>0),d=Math.min(d,O.minHeight),A=Math.min(A,O.minFramerate),f=Math.min(f,O.minBitrate),T.filter(V=>O.videoRanges[V]>0).length>0&&(h=!0)}d=z(d)?d:0,A=z(A)?A:0;let L=Math.max(1080,d),I=Math.max(30,A);f=z(f)?f:e,e=Math.max(f,e),h||(t=void 0);let k=r.length>1;return{codecSet:r.reduce((D,O)=>{let P=n[O];if(O===D)return D;if(v=h?T.filter(V=>P.videoRanges[V]>0):[],k){if(P.minBitrate>e)return te(O,`min bitrate of ${P.minBitrate} > current estimate of ${e}`),D;if(!P.hasDefaultAudio)return te(O,"no renditions with default or auto-select sound found"),D;if(o&&O.indexOf(o.substring(0,4))%5!==0)return te(O,`audio codec preference "${o}" not found`),D;if(a&&!u){if(!P.channels[a])return te(O,`no renditions with ${a} channel sound found (channels options: ${Object.keys(P.channels)})`),D}else if((!o||u)&&c&&P.channels[2]===0)return te(O,"no renditions with stereo sound found"),D;if(P.minHeight>L)return te(O,`min resolution of ${P.minHeight} > maximum of ${L}`),D;if(P.minFramerate>I)return te(O,`min framerate of ${P.minFramerate} > maximum of ${I}`),D;if(!v.some(V=>P.videoRanges[V]>0))return te(O,`no variants with VIDEO-RANGE of ${ft(v)} found`),D;if(l&&O.indexOf(l.substring(0,4))%5!==0)return te(O,`video codec preference "${l}" not found`),D;if(P.maxScore<m)return te(O,`max score of ${P.maxScore} < selected max of ${m}`),D}return D&&(Ji(O)>=Ji(D)||P.fragmentError>n[D].fragmentError)?D:(p=P.minIndex,m=P.maxScore,O)},void 0),videoRanges:v,preferHDR:b,minFramerate:A,minBitrate:f,minIndex:p}}function te(n,t){it.log(`[abr] start candidates with "${n}" ignored because ${t}`)}function Go(n){return n.reduce((t,e)=>{let i=t.groups[e.groupId];i||(i=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(e);let s=e.channels||"2";return i.channels[s]=(i.channels[s]||0)+1,i.hasDefault=i.hasDefault||e.default,i.hasAutoSelect=i.hasAutoSelect||e.autoselect,i.hasDefault&&(t.hasDefaultAudio=!0),i.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function fc(n,t,e,i){return n.slice(e,i+1).reduce((s,r,a)=>{if(!r.codecSet)return s;let o=r.audioGroups,l=s[r.codecSet];l||(s[r.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,r.bitrate);let u=Math.min(r.height,r.width);return l.minHeight=Math.min(l.minHeight,u),l.minFramerate=Math.min(l.minFramerate,r.frameRate),l.minIndex=Math.min(l.minIndex,a),l.maxScore=Math.max(l.maxScore,r.score),l.fragmentError+=r.fragmentError,l.videoRanges[r.videoRange]=(l.videoRanges[r.videoRange]||0)+1,o&&o.forEach(c=>{if(!c)return;let h=t.groups[c];!h||(l.hasDefaultAudio=l.hasDefaultAudio||t.hasDefaultAudio?h.hasDefault:h.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(h.channels).forEach(d=>{l.channels[d]=(l.channels[d]||0)+h.channels[d]}))}),s},{})}function Da(n){if(!n)return n;let{lang:t,assocLang:e,characteristics:i,channels:s,audioCodec:r}=n;return{lang:t,assocLang:e,characteristics:i,channels:s,audioCodec:r}}function ne(n,t,e){if("attrs"in n){let i=t.indexOf(n);if(i!==-1)return i}for(let i=0;i<t.length;i++){let s=t[i];if(Pe(n,s,e))return i}return-1}function Pe(n,t,e){let{groupId:i,name:s,lang:r,assocLang:a,default:o}=n,l=n.forced;return(i===void 0||t.groupId===i)&&(s===void 0||t.name===s)&&(r===void 0||gc(r,t.lang))&&(r===void 0||t.assocLang===a)&&(o===void 0||t.default===o)&&(l===void 0||t.forced===l)&&(!("characteristics"in n)||pc(n.characteristics||"",t.characteristics))&&(e===void 0||e(n,t))}function gc(n,t="--"){return n.length===t.length?n===t:n.startsWith(t)||t.startsWith(n)}function pc(n,t=""){let e=n.split(","),i=t.split(",");return e.length===i.length&&!e.some(s=>i.indexOf(s)===-1)}function Re(n,t){let{audioCodec:e,channels:i}=n;return(e===void 0||(t.audioCodec||"").substring(0,4)===e.substring(0,4))&&(i===void 0||i===(t.channels||"2"))}function mc(n,t,e,i,s){let r=t[i],o=t.reduce((d,A,f)=>{let p=A.uri;return(d[p]||(d[p]=[])).push(f),d},{})[r.uri];o.length>1&&(i=Math.max.apply(Math,o));let l=r.videoRange,u=r.frameRate,c=r.codecSet.substring(0,4),h=wa(t,i,d=>{if(d.videoRange!==l||d.frameRate!==u||d.codecSet.substring(0,4)!==c)return!1;let A=d.audioGroups,f=e.filter(p=>!A||A.indexOf(p.groupId)!==-1);return ne(n,f,s)>-1});return h>-1?h:wa(t,i,d=>{let A=d.audioGroups,f=e.filter(p=>!A||A.indexOf(p.groupId)!==-1);return ne(n,f,s)>-1})}function wa(n,t,e){for(let i=t;i>-1;i--)if(e(n[i]))return i;for(let i=t+1;i<n.length;i++)if(e(n[i]))return i;return-1}function is(n,t){var e;return!!n&&n!==((e=t.loadLevelObj)==null?void 0:e.uri)}var xr=class extends Qt{constructor(t){super("abr",t.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var i;let{fragCurrent:s,partCurrent:r,hls:a}=this,{autoLevelEnabled:o,media:l}=a;if(!s||!l)return;let u=performance.now(),c=r?r.stats:s.stats,h=r?r.duration:s.duration,d=u-c.loading.start,A=a.minAutoLevel,f=s.level,p=this._nextAutoLevel;if(c.aborted||c.loaded&&c.loaded===c.total||f<=A){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o)return;let m=p>-1&&p!==f,v=!!e||m;if(!v&&(l.paused||!l.playbackRate||!l.readyState))return;let b=a.mainForwardBufferInfo;if(!v&&b===null)return;let T=this.bwEstimator.getEstimateTTFB(),L=Math.abs(l.playbackRate);if(d<=Math.max(T,1e3*(h/(L*2))))return;let I=b?b.len/L:0,k=c.loading.first?c.loading.first-c.loading.start:-1,R=c.loaded&&k>-1,D=this.getBwEstimate(),O=a.levels,P=O[f],V=Math.max(c.loaded,Math.round(h*(s.bitrate||P.averageBitrate)/8)),y=R?d-k:d;y<1&&R&&(y=Math.min(d,c.loaded*8/D));let S=R?c.loaded*1e3/y:0,x=T/1e3,E=S?(V-c.loaded)/S:V*8/D+x;if(E<=I)return;let F=S?S*8:D,N=((i=(e==null?void 0:e.details)||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,M=this.hls.config.abrBandWidthUpFactor,_=Number.POSITIVE_INFINITY,B;for(B=f-1;B>A;B--){let et=O[B].maxBitrate,st=!O[B].details||N;if(_=this.getTimeToLoadFrag(x,F,h*et,st),_<Math.min(I,h+x))break}if(_>=E||_>h*10)return;R?this.bwEstimator.sample(d-Math.min(T,k),c.loaded):this.bwEstimator.sampleTTFB(d);let X=O[B].maxBitrate;this.getBwEstimate()*M>X&&this.resetEstimator(X);let H=this.findBestLevel(X,A,B,0,I,1,1);H>-1&&(B=H),this.warn(`Fragment ${s.sn}${r?" part "+r.index:""} of level ${f} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${I.toFixed(3)} s
      Estimated load time for current fragment: ${E.toFixed(3)} s
      Estimated load time for down switch fragment: ${_.toFixed(3)} s
      TTFB estimate: ${k|0} ms
      Current BW estimate: ${z(D)?D|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${B} @ ${X|0} bps`),a.nextLoadLevel=a.nextAutoLevel=B,this.clearTimer();let J=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===B&&B>0){let et=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${B>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${et.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,B>A){let st=this.findBestLevel(this.hls.levels[A].bitrate,A,B,0,et,1,1);st===-1&&(st=A),this.hls.nextLoadLevel=this.hls.nextAutoLevel=st,this.resetEstimator(this.hls.levels[st].bitrate)}}};m||E>_*2?J():this.timer=self.setInterval(J,_*1e3),a.trigger(g.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:r,stats:c})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(this.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){let t=this.hls.config;return new mr(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){let{hls:t}=this;t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.FRAG_LOADING,this.onFragLoading,this),t.on(g.FRAG_LOADED,this.onFragLoaded,this),t.on(g.FRAG_BUFFERED,this.onFragBuffered,this),t.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(g.LEVEL_LOADED,this.onLevelLoaded,this),t.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(g.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(g.ERROR,this.onError,this)}unregisterListeners(){let{hls:t}=this;!t||(t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.FRAG_LOADING,this.onFragLoading,this),t.off(g.FRAG_LOADED,this.onFragLoaded,this),t.off(g.FRAG_BUFFERED,this.onFragBuffered,this),t.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(g.LEVEL_LOADED,this.onLevelLoaded,this),t.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(g.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(g.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){let i=e.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var s;this.fragCurrent=i,this.partCurrent=(s=e.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case w.BUFFER_ADD_CODEC_ERROR:case w.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case w.FRAG_LOAD_TIMEOUT:{let i=e.frag,{fragCurrent:s,partCurrent:r}=this;if(i&&s&&i.sn===s.sn&&i.level===s.level){let a=performance.now(),o=r?r.stats:i.stats,l=a-o.loading.start,u=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&u>-1){let h=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(h,u),o.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(t,e,i,s){let r=t+i/e,a=s?t+this.lastLevelLoadSec:0;return r+a}onLevelLoaded(t,e){let i=this.hls.config,{loading:s}=e.stats,r=s.end-s.first;z(r)&&(this.lastLevelLoadSec=r/1e3),e.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(e.levelInfo)}onFragLoaded(t,{frag:e,part:i}){let s=i?i.stats:e.stats;if(e.type===W.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(e)){if(this.clearTimer(),e.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){let r=i?i.duration:e.duration,a=this.hls.levels[e.level],o=(a.loaded?a.loaded.bytes:0)+s.loaded,l=(a.loaded?a.loaded.duration:0)+r;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(e.bitrateTest){let r={stats:s,frag:e,part:i,id:e.type};this.onFragBuffered(g.FRAG_BUFFERED,r),e.bitrateTest=!1}else this.lastLoadedFragLevel=e.level}}onFragBuffered(t,e){let{frag:i,part:s}=e,r=s!=null&&s.stats.loaded?s.stats:i.stats;if(r.aborted||this.ignoreFragment(i))return;let a=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,r.loaded),r.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==W.MAIN||t.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){let{maxAutoLevel:t,minAutoLevel:e}=this.hls,i=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,r=this.findBestLevel(i,e,t,0,s,1,1);if(r>-1)return r;let a=this.hls.firstLevel,o=Math.min(Math.max(a,e),t);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){let t=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(t!==-1&&(!i||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;let r=i&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(t!==-1){let a=this.hls.levels;if(a.length>Math.max(t,r)&&a[t].loadError<=a[r].loadError)return t}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){let{fragCurrent:t,partCurrent:e,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;let{maxAutoLevel:s,config:r,minAutoLevel:a}=i,o=e?e.duration:t?t.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay(),c=r.abrBandWidthFactor,h=r.abrBandWidthUpFactor;if(u){let m=this.findBestLevel(l,a,s,u,0,c,h);if(m>=0)return this.rebufferNotice=-1,m}let d=o?Math.min(o,r.maxStarvationDelay):r.maxStarvationDelay;if(!u){let m=this.bitrateTestDelay;m&&(d=(o?Math.min(o,r.maxLoadingDelay):r.maxLoadingDelay)-m,this.info(`bitrate test took ${Math.round(1e3*m)}ms, set first fragment max fetchDuration to ${Math.round(1e3*d)} ms`),c=h=1)}let A=this.findBestLevel(l,a,s,u,d,c,h);if(this.rebufferNotice!==A&&(this.rebufferNotice=A,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${A}`)),A>-1)return A;let f=i.levels[a],p=i.loadLevelObj;return p&&(f==null?void 0:f.bitrate)<p.bitrate?a:i.loadLevel}getStarvationDelay(){let t=this.hls,e=t.media;if(!e)return 1/0;let i=e&&e.playbackRate!==0?Math.abs(e.playbackRate):1,s=t.mainForwardBufferInfo;return(s?s.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,i,s,r,a,o){var l;let u=s+r,c=this.lastLoadedFragLevel,h=c===-1?this.hls.firstLevel:c,{fragCurrent:d,partCurrent:A}=this,{levels:f,allAudioTracks:p,loadLevel:m,config:v}=this.hls;if(f.length===1)return 0;let b=f[h],T=!!((l=this.hls.latestLevelDetails)!=null&&l.live),L=m===-1||c===-1,I,k="SDR",R=(b==null?void 0:b.frameRate)||0,{audioPreference:D,videoPreference:O}=v,P=this.audioTracksByGroup||(this.audioTracksByGroup=Go(p)),V=-1;if(L){if(this.firstSelection!==-1)return this.firstSelection;let F=this.codecTiers||(this.codecTiers=fc(f,P,e,i)),N=Ac(F,k,t,D,O),{codecSet:M,videoRanges:_,minFramerate:B,minBitrate:X,minIndex:H,preferHDR:J}=N;V=H,I=M,k=J?_[_.length-1]:_[0],R=B,t=Math.max(t,X),this.log(`picked start tier ${ft(N)}`)}else I=b==null?void 0:b.codecSet,k=b==null?void 0:b.videoRange;let y=A?A.duration:d?d.duration:0,S=this.bwEstimator.getEstimateTTFB()/1e3,x=[];for(let F=i;F>=e;F--){var E;let N=f[F],M=F>h;if(!N)continue;if(v.useMediaCapabilities&&!N.supportedResult&&!N.supportedPromise){let st=navigator.mediaCapabilities;typeof(st==null?void 0:st.decodingInfo)=="function"&&(ac(N,P,k,R,t,D)||xs(N.videoCodec))?(N.supportedPromise=Wo(N,P,st),N.supportedPromise.then(nt=>{if(!this.hls)return;N.supportedResult=nt;let Tt=this.hls.levels,Lt=Tt.indexOf(N);nt.error?this.warn(`MediaCapabilities decodingInfo error: "${nt.error}" for level ${Lt} ${ft(nt)}`):nt.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Lt} ${ft(nt)}`),Lt>-1&&Tt.length>1&&(this.log(`Removing unsupported level ${Lt}`),this.hls.removeLevel(Lt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):N.supportedResult=Vo}if((I&&N.codecSet!==I||k&&N.videoRange!==k||M&&R>N.frameRate||!M&&R>0&&R<N.frameRate||N.supportedResult&&!((E=N.supportedResult.decodingInfoResults)!=null&&E[0].smooth))&&(!L||F!==V)){x.push(F);continue}let _=N.details,B=(A?_==null?void 0:_.partTarget:_==null?void 0:_.averagetargetduration)||y,X;M?X=o*t:X=a*t;let H=y&&s>=y*2&&r===0?N.averageBitrate:N.maxBitrate,J=this.getTimeToLoadFrag(S,X,H*B,_===void 0);if(X>=H&&(F===c||N.loadError===0&&N.fragmentError===0)&&(J<=S||!z(J)||T&&!this.bitrateTestDelay||J<u)){let st=this.forcedAutoLevel;return F!==m&&(st===-1||st!==m)&&(x.length&&this.trace(`Skipped level(s) ${x.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${f[x[0]].codecs}" ${f[x[0]].videoRange}; not compatible with "${I}" ${k}`),this.info(`switch candidate:${h}->${F} adjustedbw(${Math.round(X)})-bitrate=${Math.round(X-H)} ttfb:${S.toFixed(1)} avgDuration:${B.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${J.toFixed(1)} firstSelection:${L} codecSet:${N.codecSet} videoRange:${N.videoRange} hls.loadLevel:${m}`)),L&&(this.firstSelection=F),F}}return-1}set nextAutoLevel(t){let e=this.deriveNextAutoLevel(t);this._nextAutoLevel!==e&&(this.nextAutoLevelKey="",this._nextAutoLevel=e)}deriveNextAutoLevel(t){let{maxAutoLevel:e,minAutoLevel:i}=this.hls;return Math.min(Math.max(t,i),e)}},Mn={search:function(n,t){let e=0,i=n.length-1,s=null,r=null;for(;e<=i;){s=(e+i)/2|0,r=n[s];let a=t(r);if(a>0)e=s+1;else if(a<0)i=s-1;else return r}return null}};function vc(n,t,e){if(t===null||!Array.isArray(n)||!n.length||!z(t))return null;let i=n[0].programDateTime;if(t<(i||0))return null;let s=n[n.length-1].endProgramDateTime;if(t>=(s||0))return null;e=e||0;for(let r=0;r<n.length;++r){let a=n[r];if(Tc(t,e,a))return a}return null}function we(n,t,e=0,i=0,s=.005){let r=null;if(n){r=t[1+n.sn-t[0].sn]||null;let o=n.endDTS-e;o>0&&o<15e-7&&(e+=15e-7),r&&n.level!==r.level&&r.end<=n.end&&(r=t[2+n.sn-t[0].sn]||null)}else e===0&&t[0].start===0&&(r=t[0]);if(r&&((!n||n.level===r.level)&&Oa(e,i,r)===0||yc(r,n,Math.min(s,i))))return r;let a=Mn.search(t,Oa.bind(null,e,i));return a&&(a!==n||!r)?a:r}function yc(n,t,e){if(t&&t.start===0&&t.level<n.level&&(t.endPTS||0)>0){let i=t.tagList.reduce((s,r)=>(r[0]==="INF"&&(s+=parseFloat(r[1])),s),e);return n.start<=i}return!1}function Oa(n=0,t=0,e){if(e.start<=n&&e.start+e.duration>n)return 0;let i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0));return e.start+e.duration-i<=n?1:e.start-i>n&&e.start?-1:0}function Tc(n,t,e){let i=Math.min(t,e.duration+(e.deltaPTS?e.deltaPTS:0))*1e3;return(e.endProgramDateTime||0)-i>n}function Ho(n,t){return Mn.search(n,e=>e.cc<t?1:e.cc>t?-1:0)}function bc(n,t,e){if(n&&n.startCC<=t&&n.endCC>=t){let i=e.start,s=e.end,r=n.fragments;if(!e.relurl){let{fragmentHint:a}=n;a&&(r=r.concat(a))}return Mn.search(r,a=>a.cc<t||a.end<=i?1:a.cc>t||a.start>=s?-1:0)}return null}function ss(n){switch(n.details){case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_TIMEOUT:case w.LEVEL_LOAD_TIMEOUT:case w.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ka(n,t){let e=ss(t);return n.default[`${e?"timeout":"error"}Retry`]}function _n(n,t){let e=n.backoff==="linear"?1:Math.pow(2,t);return Math.min(e*n.retryDelayMs,n.maxRetryDelayMs)}function Ma(n){return at(at({},n),{errorRetry:null,timeoutRetry:null})}function rs(n,t,e,i){if(!n)return!1;let s=i==null?void 0:i.code,r=t<n.maxNumRetry&&(Ec(s)||!!e);return n.shouldRetry?n.shouldRetry(n,t,e,i,r):r}function Ec(n){return n===0&&navigator.onLine===!1||!!n&&(n<400||n>499)}var Rt={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Zt={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4},Sr=class extends Qt{constructor(t){super("error-controller",t.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=t,this.registerListeners()}registerListeners(){let t=this.hls;t.on(g.ERROR,this.onError,this),t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){let t=this.hls;!t||(t.off(g.ERROR,this.onError,this),t.off(g.ERROR,this.onErrorOut,this),t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return(t==null?void 0:t.type)===W.MAIN?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,e){var i;if(e.fatal)return;let s=this.hls,r=e.context;switch(e.details){case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:e.errorAction=this.getFragRetryOrSwitchAction(e);return;case w.FRAG_PARSING_ERROR:if((i=e.frag)!=null&&i.gap){e.errorAction=ci();return}case w.FRAG_GAP:case w.FRAG_DECRYPT_ERROR:{e.errorAction=this.getFragRetryOrSwitchAction(e),e.errorAction.action=Rt.SendAlternateToPenaltyBox;return}case w.LEVEL_EMPTY_ERROR:case w.LEVEL_PARSING_ERROR:{var a,o;let u=e.parent===W.MAIN?e.level:s.loadLevel;e.details===w.LEVEL_EMPTY_ERROR&&!!((a=e.context)!=null&&(o=a.levelDetails)!=null&&o.live)?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,u):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,u))}return;case w.LEVEL_LOAD_ERROR:case w.LEVEL_LOAD_TIMEOUT:typeof(r==null?void 0:r.level)=="number"&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,r.level));return;case w.AUDIO_TRACK_LOAD_ERROR:case w.AUDIO_TRACK_LOAD_TIMEOUT:case w.SUBTITLE_LOAD_ERROR:case w.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){let u=s.loadLevelObj;if(u&&(r.type===tt.AUDIO_TRACK&&u.hasAudioGroup(r.groupId)||r.type===tt.SUBTITLE_TRACK&&u.hasSubtitleGroup(r.groupId))){e.errorAction=this.getPlaylistRetryOrSwitchAction(e,s.loadLevel),e.errorAction.action=Rt.SendAlternateToPenaltyBox,e.errorAction.flags=Zt.MoveAllAlternatesMatchingHost;return}}return;case w.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{let u=s.loadLevelObj,c=u==null?void 0:u.attrs["HDCP-LEVEL"];c?e.errorAction={action:Rt.SendAlternateToPenaltyBox,flags:Zt.MoveAllAlternatesMatchingHDCP,hdcpLevel:c}:this.keySystemError(e)}return;case w.BUFFER_ADD_CODEC_ERROR:case w.REMUX_ALLOC_ERROR:case w.BUFFER_APPEND_ERROR:if(!e.errorAction){var l;e.errorAction=this.getLevelSwitchAction(e,(l=e.level)!=null?l:s.loadLevel)}return;case w.INTERNAL_EXCEPTION:case w.BUFFER_APPENDING_ERROR:case w.BUFFER_FULL_ERROR:case w.LEVEL_SWITCH_ERROR:case w.BUFFER_STALLED_ERROR:case w.BUFFER_SEEK_OVER_HOLE:case w.BUFFER_NUDGE_ON_STALL:e.errorAction=ci();return}e.type===G.KEY_SYSTEM_ERROR&&this.keySystemError(e)}keySystemError(t){let e=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e)}getPlaylistRetryOrSwitchAction(t,e){let i=this.hls,s=ka(i.config.playlistLoadPolicy,t),r=this.playlistError++;if(rs(s,r,ss(t),t.response))return{action:Rt.RetryRequest,flags:Zt.None,retryConfig:s,retryCount:r};let o=this.getLevelSwitchAction(t,e);return s&&(o.retryConfig=s,o.retryCount=r),o}getFragRetryOrSwitchAction(t){let e=this.hls,i=this.getVariantLevelIndex(t.frag),s=e.levels[i],{fragLoadPolicy:r,keyLoadPolicy:a}=e.config,o=ka(t.details.startsWith("key")?a:r,t),l=e.levels.reduce((c,h)=>c+h.fragmentError,0);if(s&&(t.details!==w.FRAG_GAP&&s.fragmentError++,rs(o,l,ss(t),t.response)))return{action:Rt.RetryRequest,flags:Zt.None,retryConfig:o,retryCount:l};let u=this.getLevelSwitchAction(t,i);return o&&(u.retryConfig=o,u.retryCount=l),u}getLevelSwitchAction(t,e){let i=this.hls;e==null&&(e=i.loadLevel);let s=this.hls.levels[e];if(s){var r,a;let u=t.details;s.loadError++,u===w.BUFFER_APPEND_ERROR&&s.fragmentError++;let c=-1,{levels:h,loadLevel:d,minAutoLevel:A,maxAutoLevel:f}=i;i.autoLevelEnabled||(i.loadLevel=-1);let p=(r=t.frag)==null?void 0:r.type,v=(p===W.AUDIO&&u===w.FRAG_PARSING_ERROR||t.sourceBufferName==="audio"&&(u===w.BUFFER_ADD_CODEC_ERROR||u===w.BUFFER_APPEND_ERROR))&&h.some(({audioCodec:k})=>s.audioCodec!==k),T=t.sourceBufferName==="video"&&(u===w.BUFFER_ADD_CODEC_ERROR||u===w.BUFFER_APPEND_ERROR)&&h.some(({codecSet:k,audioCodec:R})=>s.codecSet!==k&&s.audioCodec===R),{type:L,groupId:I}=(a=t.context)!=null?a:{};for(let k=h.length;k--;){let R=(k+d)%h.length;if(R!==d&&R>=A&&R<=f&&h[R].loadError===0){var o,l;let D=h[R];if(u===w.FRAG_GAP&&p===W.MAIN&&t.frag){let O=h[R].details;if(O){let P=we(t.frag,O.fragments,t.frag.start);if(P!=null&&P.gap)continue}}else{if(L===tt.AUDIO_TRACK&&D.hasAudioGroup(I)||L===tt.SUBTITLE_TRACK&&D.hasSubtitleGroup(I))continue;if(p===W.AUDIO&&(o=s.audioGroups)!=null&&o.some(O=>D.hasAudioGroup(O))||p===W.SUBTITLE&&(l=s.subtitleGroups)!=null&&l.some(O=>D.hasSubtitleGroup(O))||v&&s.audioCodec===D.audioCodec||!v&&s.audioCodec!==D.audioCodec||T&&s.codecSet===D.codecSet)continue}c=R;break}}if(c>-1&&i.loadLevel!==c)return t.levelRetry=!0,this.playlistError=0,{action:Rt.SendAlternateToPenaltyBox,flags:Zt.None,nextAutoLevel:c}}return{action:Rt.SendAlternateToPenaltyBox,flags:Zt.MoveAllAlternatesMatchingHost}}onErrorOut(t,e){var i;switch((i=e.errorAction)==null?void 0:i.action){case Rt.DoNothing:break;case Rt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(e),!e.errorAction.resolved&&e.details!==w.FRAG_GAP?e.fatal=!0:/MediaSource readyState: ended/.test(e.error.message)&&(this.warn(`MediaSource ended after "${e.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break;case Rt.RetryRequest:break}if(e.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(t){let e=this.hls,i=t.errorAction;if(!i)return;let{flags:s,hdcpLevel:r,nextAutoLevel:a}=i;switch(s){case Zt.None:this.switchLevel(t,a);break;case Zt.MoveAllAlternatesMatchingHDCP:r&&(e.maxHdcpLevel=Er[Er.indexOf(r)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`);break}i.resolved||this.switchLevel(t,a)}switchLevel(t,e){if(e!==void 0&&t.errorAction&&(this.warn(`switching to level ${e} after ${t.details}`),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,t.details===w.BUFFER_ADD_CODEC_ERROR&&t.mimeType&&t.sourceBufferName!=="audiovideo")){let i=Bo(t.mimeType),s=this.hls.levels;for(let r=s.length;r--;)s[r][`${t.sourceBufferName}Codec`]===i&&this.hls.removeLevel(r)}}};function ci(n){let t={action:Rt.DoNothing,flags:Zt.None};return n&&(t.resolved=!0),t}var yt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},Lr=class{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){let{hls:t}=this;t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.BUFFER_APPENDED,this.onBufferAppended,this),t.on(g.FRAG_BUFFERED,this.onFragBuffered,this),t.on(g.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){let{hls:t}=this;t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.BUFFER_APPENDED,this.onBufferAppended,this),t.off(g.FRAG_BUFFERED,this.onFragBuffered,this),t.off(g.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){let i=this.activePartLists[e];if(i)for(let s=i.length;s--;){let r=i[s];if(!r)break;let a=r.end;if(r.start<=t&&a!==null&&t<=a)return r}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){return this.getFragAtPos(t,e,!0)}getFragAtPos(t,e,i){let{fragments:s}=this,r=Object.keys(s);for(let a=r.length;a--;){let o=s[r[a]];if((o==null?void 0:o.body.type)===e&&(!i||o.buffered)){let l=o.body;if(l.start<=t&&t<=l.end)return l}}return null}detectEvictedFragments(t,e,i,s,r){this.timeRanges&&(this.timeRanges[t]=e);let a=(s==null?void 0:s.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{let l=this.fragments[o];if(!l||a>=l.body.sn)return;if(!l.buffered&&(!l.loaded||r)){l.body.type===i&&this.removeFragment(l.body);return}let u=l.range[t];if(!!u){if(u.time.length===0){this.removeFragment(l.body);return}u.time.some(c=>{let h=!this.isTimeBuffered(c.startPTS,c.endPTS,e);return h&&this.removeFragment(l.body),h})}})}detectPartialFragments(t){let e=this.timeRanges;if(!e||t.frag.sn==="initSegment")return;let i=t.frag,s=Ue(i),r=this.fragments[s];if(!r||r.buffered&&i.gap)return;let a=!i.relurl;Object.keys(e).forEach(o=>{let l=i.elementaryStreams[o];if(!l)return;let u=e[o],c=a||l.partial===!0;r.range[o]=this.getBufferedTimes(i,t.part,c,u)}),r.loaded=null,Object.keys(r.range).length?(r.buffered=!0,(r.body.endList=i.endList||r.body.endList)&&(this.endListFragments[r.body.type]=r),ki(r)||this.removeParts(i.sn-1,i.type)):this.removeFragment(r.body)}removeParts(t,e){let i=this.activePartLists[e];!i||(this.activePartLists[e]=_a(i,s=>s.fragment.sn>=t))}fragBuffered(t,e){let i=Ue(t),s=this.fragments[i];!s&&e&&(s=this.fragments[i]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(t,e,i,s){let r={time:[],partial:i},a=t.start,o=t.end,l=t.minEndPTS||o,u=t.maxStartPTS||a;for(let c=0;c<s.length;c++){let h=s.start(c)-this.bufferPadding,d=s.end(c)+this.bufferPadding;if(u>=h&&l<=d){r.time.push({startPTS:Math.max(a,s.start(c)),endPTS:Math.min(o,s.end(c))});break}else if(a<d&&o>h){let A=Math.max(a,s.start(c)),f=Math.min(o,s.end(c));f>A&&(r.partial=!0,r.time.push({startPTS:A,endPTS:f}))}else if(o<=h)break}return r}getPartialFragment(t){let e=null,i,s,r,a=0,{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(u=>{let c=l[u];!c||ki(c)&&(s=c.body.start-o,r=c.body.end+o,t>=s&&t<=r&&(i=Math.min(t-s,r-t),a<=i&&(e=c.body,a=i)))}),e}isEndListAppended(t){let e=this.endListFragments[t];return e!==void 0&&(e.buffered||ki(e))}getState(t){let e=Ue(t),i=this.fragments[e];return i?i.buffered?ki(i)?yt.PARTIAL:yt.OK:yt.APPENDING:yt.NOT_LOADED}isTimeBuffered(t,e,i){let s,r;for(let a=0;a<i.length;a++){if(s=i.start(a)-this.bufferPadding,r=i.end(a)+this.bufferPadding,t>=s&&e<=r)return!0;if(e<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(t,e){if(e.frag.sn==="initSegment"||e.frag.bitrateTest)return;let i=e.frag,s=e.part?null:e,r=Ue(i);this.fragments[r]={body:i,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){let{frag:i,part:s,timeRanges:r,type:a}=e;if(i.sn==="initSegment")return;let o=i.type;if(s){let u=this.activePartLists[o];u||(this.activePartLists[o]=u=[]),u.push(s)}this.timeRanges=r;let l=r[a];this.detectEvictedFragments(a,l,o,s)}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){let e=Ue(t);return!!this.fragments[e]}hasFragments(t){let{fragments:e}=this,i=Object.keys(e);if(!t)return i.length>0;for(let s=i.length;s--;){let r=e[i[s]];if((r==null?void 0:r.body.type)===t)return!0}return!1}hasParts(t){var e;return!!((e=this.activePartLists[t])!=null&&e.length)}removeFragmentsInRange(t,e,i,s,r){s&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{let o=this.fragments[a];if(!o)return;let l=o.body;l.type!==i||s&&!l.gap||l.start<e&&l.end>t&&(o.buffered||r)&&this.removeFragment(l)})}removeFragment(t){let e=Ue(t);t.clearElementaryStreamInfo();let i=this.activePartLists[t.type];if(i){let s=t.sn;this.activePartLists[t.type]=_a(i,r=>r.fragment.sn!==s)}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){var t,e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;let i=(t=this.hls)==null||(e=t.latestLevelDetails)==null?void 0:e.partList;i&&i.forEach(s=>s.clearElementaryStreamInfo())}};function ki(n){var t,e,i;return n.buffered&&(n.body.gap||((t=n.range.video)==null?void 0:t.partial)||((e=n.range.audio)==null?void 0:e.partial)||((i=n.range.audiovideo)==null?void 0:i.partial))}function Ue(n){return`${n.type}_${n.level}_${n.sn}`}function _a(n,t){return n.filter(e=>{let i=t(e);return i||e.clearElementaryStreamInfo(),i})}var Te={cbc:0,ctr:1},Ir=class{constructor(t,e,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=e,this.aesMode=i}decrypt(t,e){switch(this.aesMode){case Te.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t);case Te.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},e,t);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}};function xc(n){let t=n.byteLength,e=t&&new DataView(n.buffer).getUint8(t-1);return e?n.slice(0,t-e):n}var Rr=class{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){let e=new DataView(t),i=new Uint32Array(4);for(let s=0;s<4;s++)i[s]=e.getUint32(s*4);return i}initTable(){let t=this.sBox,e=this.invSBox,i=this.subMix,s=i[0],r=i[1],a=i[2],o=i[3],l=this.invSubMix,u=l[0],c=l[1],h=l[2],d=l[3],A=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)m<128?A[m]=m<<1:A[m]=m<<1^283;for(m=0;m<256;m++){let v=p^p<<1^p<<2^p<<3^p<<4;v=v>>>8^v&255^99,t[f]=v,e[v]=f;let b=A[f],T=A[b],L=A[T],I=A[v]*257^v*16843008;s[f]=I<<24|I>>>8,r[f]=I<<16|I>>>16,a[f]=I<<8|I>>>24,o[f]=I,I=L*16843009^T*65537^b*257^f*16843008,u[v]=I<<24|I>>>8,c[v]=I<<16|I>>>16,h[v]=I<<8|I>>>24,d[v]=I,f?(f=b^A[A[A[L^b]]],p^=A[A[p]]):f=p=1}}expandKey(t){let e=this.uint8ArrayToUint32Array_(t),i=!0,s=0;for(;s<e.length&&i;)i=e[s]===this.key[s],s++;if(i)return;this.key=e;let r=this.keySize=e.length;if(r!==4&&r!==6&&r!==8)throw new Error("Invalid aes key size="+r);let a=this.ksRows=(r+6+1)*4,o,l,u=this.keySchedule=new Uint32Array(a),c=this.invKeySchedule=new Uint32Array(a),h=this.sBox,d=this.rcon,A=this.invSubMix,f=A[0],p=A[1],m=A[2],v=A[3],b,T;for(o=0;o<a;o++){if(o<r){b=u[o]=e[o];continue}T=b,o%r===0?(T=T<<8|T>>>24,T=h[T>>>24]<<24|h[T>>>16&255]<<16|h[T>>>8&255]<<8|h[T&255],T^=d[o/r|0]<<24):r>6&&o%r===4&&(T=h[T>>>24]<<24|h[T>>>16&255]<<16|h[T>>>8&255]<<8|h[T&255]),u[o]=b=(u[o-r]^T)>>>0}for(l=0;l<a;l++)o=a-l,l&3?T=u[o]:T=u[o-4],l<4||o<=4?c[l]=T:c[l]=f[h[T>>>24]]^p[h[T>>>16&255]]^m[h[T>>>8&255]]^v[h[T&255]],c[l]=c[l]>>>0}networkToHostOrderSwap(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24}decrypt(t,e,i){let s=this.keySize+6,r=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],u=o[1],c=o[2],h=o[3],d=this.uint8ArrayToUint32Array_(i),A=d[0],f=d[1],p=d[2],m=d[3],v=new Int32Array(t),b=new Int32Array(v.length),T,L,I,k,R,D,O,P,V,y,S,x,E,F,N=this.networkToHostOrderSwap;for(;e<v.length;){for(V=N(v[e]),y=N(v[e+1]),S=N(v[e+2]),x=N(v[e+3]),R=V^r[0],D=x^r[1],O=S^r[2],P=y^r[3],E=4,F=1;F<s;F++)T=l[R>>>24]^u[D>>16&255]^c[O>>8&255]^h[P&255]^r[E],L=l[D>>>24]^u[O>>16&255]^c[P>>8&255]^h[R&255]^r[E+1],I=l[O>>>24]^u[P>>16&255]^c[R>>8&255]^h[D&255]^r[E+2],k=l[P>>>24]^u[R>>16&255]^c[D>>8&255]^h[O&255]^r[E+3],R=T,D=L,O=I,P=k,E=E+4;T=a[R>>>24]<<24^a[D>>16&255]<<16^a[O>>8&255]<<8^a[P&255]^r[E],L=a[D>>>24]<<24^a[O>>16&255]<<16^a[P>>8&255]<<8^a[R&255]^r[E+1],I=a[O>>>24]<<24^a[P>>16&255]<<16^a[R>>8&255]<<8^a[D&255]^r[E+2],k=a[P>>>24]<<24^a[R>>16&255]<<16^a[D>>8&255]<<8^a[O&255]^r[E+3],b[e]=N(T^A),b[e+1]=N(k^f),b[e+2]=N(I^p),b[e+3]=N(L^m),A=V,f=y,p=S,m=x,e=e+4}return b.buffer}},Pr=class{constructor(t,e,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=e,this.aesMode=i}expandKey(){let t=Sc(this.aesMode);return this.subtle.importKey("raw",this.key,{name:t},!1,["encrypt","decrypt"])}};function Sc(n){switch(n){case Te.cbc:return"AES-CBC";case Te.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${n}`)}}var Lc=16,hi=class{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{let i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch(i){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){let{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;let i=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?xc(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,i,s){return this.useSoftware?new Promise((r,a)=>{let o=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.softwareDecrypt(o,e,i,s);let l=this.flush();l?r(l.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),e,i,s)}softwareDecrypt(t,e,i,s){let{currentIV:r,currentResult:a,remainderData:o}=this;if(s!==Te.cbc||e.byteLength!==16)return it.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(t=Ht(o,t),this.remainderData=null);let l=this.getValidChunk(t);if(!l.length)return null;r&&(i=r);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new Rr),u.expandKey(e);let c=a;return this.currentResult=u.decrypt(l.buffer,0,i),this.currentIV=l.slice(-16).buffer,c||null}webCryptoDecrypt(t,e,i,s){if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,i,s));this.key=e,this.fastAesKey=new Pr(this.subtle,e,s)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new Ir(this.subtle,new Uint8Array(i),s).decrypt(t.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(it.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(t,e,i,s)))}onWebCryptoError(t,e,i,s){let r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,i,s);let a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(t){let e=t,i=t.length-t.length%Lc;return i!==t.length&&(e=t.slice(0,i),this.remainderData=t.slice(i)),e}logOnce(t){!this.logEnabled||(it.log(`[decrypter]: ${t}`),this.logEnabled=!1)}},Na=Math.pow(2,17),Cr=class{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){let i=t.url;if(!i)return Promise.reject(new Yt({type:G.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();let s=this.config,r=s.fLoader,a=s.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),t.gap)if(t.tagList.some(f=>f[0]==="GAP")){l(Ua(t));return}else t.gap=!1;let u=this.loader=r?new r(s):new a(s),c=Fa(t);t.loader=u;let h=Ma(s.fragLoadPolicy.default),d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?1/0:Na};t.stats=u.stats;let A={onSuccess:(f,p,m,v)=>{this.resetLoader(t,u);let b=f.data;m.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(b.slice(0,16)),b=b.slice(16)),o({frag:t,part:null,payload:b,networkDetails:v})},onError:(f,p,m,v)=>{this.resetLoader(t,u),l(new Yt({type:G.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:at({url:i,data:void 0},f),error:new Error(`HTTP Error ${f.code} ${f.text}`),networkDetails:m,stats:v}))},onAbort:(f,p,m)=>{this.resetLoader(t,u),l(new Yt({type:G.NETWORK_ERROR,details:w.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:m,stats:f}))},onTimeout:(f,p,m)=>{this.resetLoader(t,u),l(new Yt({type:G.NETWORK_ERROR,details:w.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:m,stats:f}))}};e&&(A.onProgress=(f,p,m,v)=>e({frag:t,part:null,payload:m,networkDetails:v})),u.load(c,d,A)})}loadPart(t,e,i){this.abort();let s=this.config,r=s.fLoader,a=s.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap){l(Ua(t,e));return}let u=this.loader=r?new r(s):new a(s),c=Fa(t,e);t.loader=u;let h=Ma(s.fragLoadPolicy.default),d={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Na};e.stats=u.stats,u.load(c,d,{onSuccess:(A,f,p,m)=>{this.resetLoader(t,u),this.updateStatsFromPart(t,e);let v={frag:t,part:e,payload:A.data,networkDetails:m};i(v),o(v)},onError:(A,f,p,m)=>{this.resetLoader(t,u),l(new Yt({type:G.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:at({url:c.url,data:void 0},A),error:new Error(`HTTP Error ${A.code} ${A.text}`),networkDetails:p,stats:m}))},onAbort:(A,f,p)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,u),l(new Yt({type:G.NETWORK_ERROR,details:w.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:p,stats:A}))},onTimeout:(A,f,p)=>{this.resetLoader(t,u),l(new Yt({type:G.NETWORK_ERROR,details:w.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:p,stats:A}))}})})}updateStatsFromPart(t,e){let i=t.stats,s=e.stats,r=s.total;if(i.loaded+=s.loaded,r){let l=Math.round(t.duration/e.duration),u=Math.min(Math.round(i.loaded/r),l),h=(l-u)*Math.round(i.loaded/u);i.total=i.loaded+h}else i.total=Math.max(i.loaded,i.total);let a=i.loading,o=s.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}};function Fa(n,t=null){let e=t||n,i={frag:n,part:t,responseType:"arraybuffer",url:e.url,headers:{},rangeStart:0,rangeEnd:0},s=e.byteRangeStartOffset,r=e.byteRangeEndOffset;if(z(s)&&z(r)){var a;let o=s,l=r;if(n.sn==="initSegment"&&Ic((a=n.decryptdata)==null?void 0:a.method)){let u=r-s;u%16&&(l=r+(16-u%16)),s!==0&&(i.resetIV=!0,o=s-16)}i.rangeStart=o,i.rangeEnd=l}return i}function Ua(n,t){let e=new Error(`GAP ${n.gap?"tag":"attribute"} found`),i={type:G.MEDIA_ERROR,details:w.FRAG_GAP,fatal:!1,frag:n,error:e,networkDetails:null};return t&&(i.part=t),(t||n).stats.aborted=!0,new Yt(i)}function Ic(n){return n==="AES-128"||n==="AES-256"}var Yt=class extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}},ns=class extends Qt{constructor(t,e){super(t,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}},di=class{constructor(t,e,i,s=0,r=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Mi(),this.buffering={audio:Mi(),video:Mi(),audiovideo:Mi()},this.level=t,this.sn=e,this.id=i,this.size=s,this.part=r,this.partial=a}};function Mi(){return{start:0,executeStart:0,executeEnd:0,end:0}}var Ba={length:0,start:()=>0,end:()=>0},Q=class{static isBuffered(t,e){if(t){let i=Q.getBuffered(t);for(let s=i.length;s--;)if(e>=i.start(s)&&e<=i.end(s))return!0}return!1}static bufferedRanges(t){if(t){let e=Q.getBuffered(t);return Q.timeRangesToArray(e)}return[]}static timeRangesToArray(t){let e=[];for(let i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e}static bufferInfo(t,e,i){if(t){let s=Q.bufferedRanges(t);if(s.length)return Q.bufferedInfo(s,e,i)}return{len:0,start:e,end:e,bufferedIndex:-1}}static bufferedInfo(t,e,i){e=Math.max(0,e),t.length>1&&t.sort((c,h)=>c.start-h.start||h.end-c.end);let s=-1,r=[];if(i)for(let c=0;c<t.length;c++){e>=t[c].start&&e<=t[c].end&&(s=c);let h=r.length;if(h){let d=r[h-1].end;t[c].start-d<i?t[c].end>d&&(r[h-1].end=t[c].end):r.push(t[c])}else r.push(t[c])}else r=t;let a=0,o,l=e,u=e;for(let c=0;c<r.length;c++){let h=r[c].start,d=r[c].end;if(s===-1&&e>=h&&e<=d&&(s=c),e+i>=h&&e<d)l=h,u=d,a=u-e;else if(e+i<h){o=h;break}}return{len:a,start:l||0,end:u||0,nextStart:o,buffered:t,bufferedIndex:s}}static getBuffered(t){try{return t.buffered||Ba}catch(e){return it.log("failed to get media.buffered",e),Ba}}},Xo=/\{\$([a-zA-Z0-9-_]+)\}/g;function Va(n){return Xo.test(n)}function Dr(n,t){if(n.variableList!==null||n.hasVariableRefs){let e=n.variableList;return t.replace(Xo,i=>{let s=i.substring(2,i.length-1),r=e==null?void 0:e[s];return r===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),i):r})}return t}function za(n,t,e){let i=n.variableList;i||(n.variableList=i={});let s,r;if("QUERYPARAM"in t){s=t.QUERYPARAM;try{let a=new self.URL(e).searchParams;if(a.has(s))r=a.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${e}"`)}catch(a){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else s=t.NAME,r=t.VALUE;s in i?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):i[s]=r||""}function Rc(n,t,e){let i=t.IMPORT;if(e&&i in e){let s=n.variableList;s||(n.variableList=s={}),s[i]=e[i]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}var Pc=/^(\d+)x(\d+)$/,Wa=/(.+?)=(".*?"|.*?)(?:,|$)/g,dt=class{constructor(t,e){typeof t=="string"&&(t=dt.parseAttrList(t,e)),ct(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>t.substring(0,2)==="X-")}decimalInteger(t){let e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(e.length&1?"0":"")+e;let i=new Uint8Array(e.length/2);for(let s=0;s<e.length/2;s++)i[s]=parseInt(e.slice(s*2,s*2+2),16);return i}return null}hexadecimalIntegerAsNumber(t){let e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){let i=this[t];return i?parseFloat(i):e}enumeratedString(t){return this[t]}enumeratedStringList(t,e){let i=this[t];return(i?i.split(/[ ,]+/):[]).reduce((s,r)=>(s[r.toLowerCase()]=!0,s),e)}bool(t){return this[t]==="YES"}decimalResolution(t){let e=Pc.exec(this[t]);if(e!==null)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t,e){let i,s={},r='"';for(Wa.lastIndex=0;(i=Wa.exec(t))!==null;){let a=i[1].trim(),o=i[2],l=o.indexOf(r)===0&&o.lastIndexOf(r)===o.length-1,u=!1;if(l)o=o.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(e&&(l||u))o=Dr(e,o);else if(!u&&!l)switch(a){case"CLOSED-CAPTIONS":if(o==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":it.warn(`${t}: attribute ${a} is missing quotes`)}s[a]=o}return s}},Cc="com.apple.hls.interstitial";function Dc(n){return n!=="ID"&&n!=="CLASS"&&n!=="CUE"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function wc(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"||n==="SCTE35-CMD"}var as=class{constructor(t,e,i=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(e==null?void 0:e.tagAnchor)||null,this.tagOrder=(s=e==null?void 0:e.tagOrder)!=null?s:i,e){let r=e.attr;for(let a in r)if(Object.prototype.hasOwnProperty.call(t,a)&&t[a]!==r[a]){it.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=a;break}t=ct(new dt({}),r,t)}if(this.attr=t,e?(this._startDate=e._startDate,this._cue=e._cue,this._endDate=e._endDate,this._dateAtEnd=e._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){let r=(e==null?void 0:e.endDate)||new Date(this.attr["END-DATE"]);z(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){let t=this._cue;return t===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):t}get startTime(){let{tagAnchor:t}=this;return t===null||t.programDateTime===null?(it.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${t}`),NaN):t.start+(this.startDate.getTime()-t.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){let t=this._endDate||this._dateAtEnd;if(t)return t;let e=this.duration;return e!==null?this._dateAtEnd=new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){let t=this.attr.decimalFloatingPoint("DURATION");if(z(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===Cc}get isValid(){return!!this.id&&!this._badValueForSameId&&z(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}},Oc=10,wr=class{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t){this.advanced=!0,this.updated=!0;return}let e=this.lastPartSn-t.lastPartSn,i=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!i||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||e===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(t.misses*.6):this.misses=t.misses+1}get hasProgramDateTime(){return this.fragments.length?z(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||Oc}get drift(){let t=this.driftEndTime-this.driftStartTime;return t>0?(this.driftEnd-this.driftStart)*1e3/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return(t=this.fragments)!=null&&t.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var t;return(t=this.fragments)!=null&&t.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){let t=this.partList;if(t){let e=this.lastPartIndex;if(e!==-1){for(let i=t.length;i--;)if(t[i].index>e)return t[i].index;return e}}return 0}get lastPartSn(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){let t=this.partEnd-this.fragmentStart;return this.age>Math.max(t,this.totalduration)+this.levelTargetDuration}return!1}};function Ge(n){return n==="AES-128"||n==="AES-256"||n==="AES-256-CTR"}function Nn(n){switch(n){case"AES-128":case"AES-256":return Te.cbc;case"AES-256-CTR":return Te.ctr;default:throw new Error(`invalid full segment method ${n}`)}}function Fn(n){return Uint8Array.from(atob(n),t=>t.charCodeAt(0))}function Or(n){return Uint8Array.from(unescape(encodeURIComponent(n)),t=>t.charCodeAt(0))}function kc(n){let t=Or(n).subarray(0,16),e=new Uint8Array(16);return e.set(t,16-t.length),e}function Mc(n){let t=function(i,s,r){let a=i[s];i[s]=i[r],i[r]=a};t(n,0,3),t(n,1,2),t(n,4,5),t(n,6,7)}function _c(n){let t=n.split(":"),e=null;if(t[0]==="data"&&t.length===2){let i=t[1].split(";"),s=i[i.length-1].split(",");if(s.length===2){let r=s[0]==="base64",a=s[1];r?(i.splice(-1,1),e=Fn(a)):e=kc(a)}}return e}var os=typeof self!="undefined"?self:void 0,ot={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},_t={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function $s(n){switch(n){case _t.FAIRPLAY:return ot.FAIRPLAY;case _t.PLAYREADY:return ot.PLAYREADY;case _t.WIDEVINE:return ot.WIDEVINE;case _t.CLEARKEY:return ot.CLEARKEY}}var _i={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function tr(n){if(n===_i.WIDEVINE)return ot.WIDEVINE;if(n===_i.PLAYREADY)return ot.PLAYREADY;if(n===_i.CENC||n===_i.CLEARKEY)return ot.CLEARKEY}function er(n){switch(n){case ot.FAIRPLAY:return _t.FAIRPLAY;case ot.PLAYREADY:return _t.PLAYREADY;case ot.WIDEVINE:return _t.WIDEVINE;case ot.CLEARKEY:return _t.CLEARKEY}}function Ni(n){let{drmSystems:t,widevineLicenseUrl:e}=n,i=t?[ot.FAIRPLAY,ot.WIDEVINE,ot.PLAYREADY,ot.CLEARKEY].filter(s=>!!t[s]):[];return!i[ot.WIDEVINE]&&e&&i.push(ot.WIDEVINE),i}var qo=function(n){return os!=null&&(n=os.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Nc(n,t,e,i){let s;switch(n){case ot.FAIRPLAY:s=["cenc","sinf"];break;case ot.WIDEVINE:case ot.PLAYREADY:s=["cenc"];break;case ot.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return Fc(s,t,e,i)}function Fc(n,t,e,i){return[{initDataTypes:n,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map(r=>({contentType:`audio/mp4; codecs=${r}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:e.map(r=>({contentType:`video/mp4; codecs=${r}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function Uc(n){var t;return n.sessionType==="persistent-license"||!!((t=n.sessionTypes)!=null&&t.some(e=>e==="persistent-license"))}function jo(n){let t=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),e=String.fromCharCode.apply(null,Array.from(t)),i=e.substring(e.indexOf("<"),e.length),a=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(a){let o=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(o){let l=Fn(o).subarray(0,16);return Mc(l),l}}return null}var Fi={},Oe=class{static clearKeyUriToKeyIdMap(){Fi={}}constructor(t,e,i,s=[1],r=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=i,this.keyFormatVersions=s,this.iv=r,this.encrypted=t?t!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Ge(t)}isSupported(){if(this.method){if(Ge(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case _t.FAIRPLAY:case _t.WIDEVINE:case _t.PLAYREADY:case _t.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if(Ge(this.method)&&this.uri&&!this.iv){typeof t!="number"&&(it.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);let i=Bc(t);return new Oe(this.method,this.uri,"identity",this.keyFormatVersions,i)}let e=_c(this.uri);if(e)switch(this.keyFormat){case _t.WIDEVINE:this.pssh=e,e.length>=22&&(this.keyId=e.subarray(e.length-22,e.length-6));break;case _t.PLAYREADY:{let i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Ju(i,null,e),this.keyId=jo(e);break}default:{let i=e.subarray(0,16);if(i.length!==16){let s=new Uint8Array(16);s.set(i,16-i.length),i=s}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i=Fi[this.uri];if(!i){let s=Object.keys(Fi).length%Number.MAX_SAFE_INTEGER;i=new Uint8Array(16),new DataView(i.buffer,12,4).setUint32(0,s),Fi[this.uri]=i}this.keyId=i}return this}};function Bc(n){let t=new Uint8Array(16);for(let e=12;e<16;e++)t[e]=n>>8*(15-e)&255;return t}var Ga=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ha=/#EXT-X-MEDIA:(.*)/g,Vc=/^#EXT(?:INF|-X-TARGETDURATION):/m,ir=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),zc=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),Gt=class{static findGroup(t,e){for(let i=0;i<t.length;i++){let s=t[i];if(s.id===e)return s}}static resolve(t,e){return On.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return Vc.test(t)}static parseMasterPlaylist(t,e){let i=Va(t),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},r=[];Ga.lastIndex=0;let a;for(;(a=Ga.exec(t))!=null;)if(a[1]){var o;let u=new dt(a[1],s),c=Dr(s,a[2]),h={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:Gt.resolve(c,e)},d=u.decimalResolution("RESOLUTION");d&&(h.width=d.width,h.height=d.height),ja(u.CODECS,h);let A=u["SUPPLEMENTAL-CODECS"];A&&(h.supplemental={},ja(A,h.supplemental)),(o=h.unknownCodecs)!=null&&o.length||r.push(h),s.levels.push(h)}else if(a[3]){let u=a[3],c=a[4];switch(u){case"SESSION-DATA":{let h=new dt(c,s),d=h["DATA-ID"];d&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[d]=h);break}case"SESSION-KEY":{let h=Xa(c,e,s);h.encrypted&&h.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(h)):it.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);break}case"DEFINE":{{let h=new dt(c,s);za(s,h,e)}break}case"CONTENT-STEERING":{let h=new dt(c,s);s.contentSteering={uri:Gt.resolve(h["SERVER-URI"],e),pathwayId:h["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=qa(c);break}}}let l=r.length>0&&r.length<s.levels.length;return s.levels=l?r:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(t,e,i){let s,r={},a=i.levels,o={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]},l=0;for(Ha.lastIndex=0;(s=Ha.exec(t))!==null;){let u=new dt(s[1],i),c=u.TYPE;if(c){let h=o[c],d=r[c]||[];r[c]=d;let A=u.LANGUAGE,f=u["ASSOC-LANGUAGE"],p=u.CHANNELS,m=u.CHARACTERISTICS,v=u["INSTREAM-ID"],b={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||A||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:A,url:u.URI?Gt.resolve(u.URI,e):""};if(f&&(b.assocLang=f),p&&(b.channels=p),m&&(b.characteristics=m),v&&(b.instreamId=v),h!=null&&h.length){let T=Gt.findGroup(h,b.groupId)||h[0];Ka(b,T,"audioCodec"),Ka(b,T,"textCodec")}d.push(b)}}return r}static parseLevelPlaylist(t,e,i,s,r,a){var o;let l={url:e},u=new wr(e),c=u.fragments,h=[],d=null,A=0,f=0,p=0,m=0,v=0,b=null,T=new ri(s,l),L,I,k,R=-1,D=!1,O=null,P;if(ir.lastIndex=0,u.m3u8=t,u.hasVariableRefs=Va(t),((o=ir.exec(t))==null?void 0:o[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(L=ir.exec(t))!==null;){D&&(D=!1,T=new ri(s,l),T.playlistOffset=p,T.start=p,T.sn=A,T.cc=m,v&&(T.bitrate=v),T.level=i,d&&(T.initSegment=d,d.rawProgramDateTime&&(T.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null),O&&(T.setByteRange(O),O=null)));let x=L[1];if(x){T.duration=parseFloat(x);let E=(" "+L[2]).slice(1);T.title=E||null,T.tagList.push(E?["INF",x,E]:["INF",x])}else if(L[3]){if(z(T.duration)){T.playlistOffset=p,T.start=p,k&&Ya(T,k,u),T.sn=A,T.level=i,T.cc=m,c.push(T);let E=(" "+L[3]).slice(1);T.relurl=Dr(u,E),kr(T,b,h),b=T,p+=T.duration,A++,f=0,D=!0}}else{if(L=L[0].match(zc),!L){it.warn("No matches on slow regex match for level playlist!");continue}for(I=1;I<L.length&&L[I]===void 0;I++);let E=(" "+L[I]).slice(1),F=(" "+L[I+1]).slice(1),N=L[I+2]?(" "+L[I+2]).slice(1):null;switch(E){case"BYTERANGE":b?T.setByteRange(F,b):T.setByteRange(F);break;case"PROGRAM-DATE-TIME":T.rawProgramDateTime=F,T.tagList.push(["PROGRAM-DATE-TIME",F]),R===-1&&(R=c.length);break;case"PLAYLIST-TYPE":u.type&&ue(u,E,L),u.type=F.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?ue(u,E,L):c.length>0&&Qa(u,E,L),A=u.startSN=parseInt(F);break;case"SKIP":{u.skippedSegments&&ue(u,E,L);let M=new dt(F,u),_=M.decimalInteger("SKIPPED-SEGMENTS");if(z(_)){u.skippedSegments+=_;for(let X=_;X--;)c.push(null);A+=_}let B=M.enumeratedString("RECENTLY-REMOVED-DATERANGES");B&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(B.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&ue(u,E,L),u.targetduration=Math.max(parseInt(F),1);break;case"VERSION":u.version!==null&&ue(u,E,L),u.version=parseInt(F);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||ue(u,E,L),u.live=!1;break;case"#":(F||N)&&T.tagList.push(N?[F,N]:[F]);break;case"DISCONTINUITY":m++,T.tagList.push(["DIS"]);break;case"GAP":T.gap=!0,T.tagList.push([E]);break;case"BITRATE":T.tagList.push([E,F]),v=parseInt(F)*1e3,z(v)?T.bitrate=v:v=0;break;case"DATERANGE":{let M=new dt(F,u),_=new as(M,u.dateRanges[M.ID],u.dateRangeTagCount);u.dateRangeTagCount++,_.isValid||u.skippedSegments?u.dateRanges[_.id]=_:it.warn(`Ignoring invalid DATERANGE tag: "${F}"`),T.tagList.push(["EXT-X-DATERANGE",F]);break}case"DEFINE":{{let M=new dt(F,u);"IMPORT"in M?Rc(u,M,a):za(u,M,e)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?ue(u,E,L):c.length>0&&Qa(u,E,L),u.startCC=m=parseInt(F);break;case"KEY":{let M=Xa(F,e,u);if(M.isSupported()){if(M.method==="NONE"){k=void 0;break}k||(k={}),k[M.keyFormat]&&(k=ct({},k)),k[M.keyFormat]=M}else it.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${F}"`);break}case"START":u.startTimeOffset=qa(F);break;case"MAP":{let M=new dt(F,u);if(T.duration){let _=new ri(s,l);Za(_,M,i,k),d=_,T.initSegment=d,d.rawProgramDateTime&&!T.rawProgramDateTime&&(T.rawProgramDateTime=d.rawProgramDateTime)}else{let _=T.byteRangeEndOffset;if(_){let B=T.byteRangeStartOffset;O=`${_-B}@${B}`}else O=null;Za(T,M,i,k),d=T,D=!0}d.cc=m;break}case"SERVER-CONTROL":{P&&ue(u,E,L),P=new dt(F),u.canBlockReload=P.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=P.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&P.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=P.optionalFloat("PART-HOLD-BACK",0),u.holdBack=P.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&ue(u,E,L);let M=new dt(F);u.partTarget=M.decimalFloatingPoint("PART-TARGET");break}case"PART":{let M=u.partList;M||(M=u.partList=[]);let _=f>0?M[M.length-1]:void 0,B=f++,X=new dt(F,u),H=new Tr(X,T,l,B,_);M.push(H),T.duration+=H.duration;break}case"PRELOAD-HINT":{let M=new dt(F,u);u.preloadHint=M;break}case"RENDITION-REPORT":{let M=new dt(F,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(M);break}default:it.warn(`line parsed but not handled: ${L}`);break}}}b&&!b.relurl?(c.pop(),p-=b.duration,u.partList&&(u.fragmentHint=b)):u.partList&&(kr(T,b,h),T.cc=m,u.fragmentHint=T,k&&Ya(T,k,u)),u.targetduration||(u.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));let V=c.length,y=c[0],S=c[V-1];if(p+=u.skippedSegments*u.targetduration,p>0&&V&&S){u.averagetargetduration=p/V;let x=S.sn;u.endSN=x!=="initSegment"?x:0,u.live||(S.endList=!0),y&&u.startCC===void 0&&(u.startCC=y.cc),R>0&&(Gc(c,R),y&&h.unshift(y))}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(p+=u.fragmentHint.duration),u.totalduration=p,h.length&&u.dateRangeTagCount&&y&&Ko(h,u),u.endCC=m,u}};function Ko(n,t){let e=n.length,i=n[e-1],s=t.live?1/0:t.totalduration,r=Object.keys(t.dateRanges);for(let a=r.length;a--;){let o=t.dateRanges[r[a]],l=o.startDate.getTime();o.tagAnchor=i.ref;for(let u=e;u--;){let c=Wc(t,l,n,u,s);if(c!==-1){o.tagAnchor=t.fragments[c].ref;break}}}}function Wc(n,t,e,i,s){let r=e[i];if(r){let o=r.programDateTime;if(t>=o||i===0){var a;let l=(((a=e[i+1])==null?void 0:a.start)||s)-r.start;if(t<=o+l*1e3){let u=e[i].sn-n.startSN,c=n.fragments;if(c.length>e.length){let d=(e[i+1]||c[c.length-1]).sn-n.startSN;for(let A=d;A>u;A--){let f=c[A].programDateTime;if(t>=f&&t<f+c[A].duration*1e3)return A}}return u}}}return-1}function Xa(n,t,e){var i,s;let r=new dt(n,e),a=(i=r.METHOD)!=null?i:"",o=r.URI,l=r.hexadecimalInteger("IV"),u=r.KEYFORMATVERSIONS,c=(s=r.KEYFORMAT)!=null?s:"identity";o&&r.IV&&!l&&it.error(`Invalid IV: ${r.IV}`);let h=o?Gt.resolve(o,t):"",d=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Oe(a,h,c,d,l)}function qa(n){let e=new dt(n).decimalFloatingPoint("TIME-OFFSET");return z(e)?e:null}function ja(n,t){let e=(n||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{let s=e.filter(r=>Fo(r,i));s.length&&(t[`${i}Codec`]=s.map(r=>r.split("/")[0]).join(","),e=e.filter(r=>s.indexOf(r)===-1))}),t.unknownCodecs=e}function Ka(n,t,e){let i=t[e];i&&(n[e]=i)}function Gc(n,t){let e=n[t];for(let i=t;i--;){let s=n[i];if(!s)return;s.programDateTime=e.programDateTime-s.duration*1e3,e=s}}function kr(n,t,e){n.rawProgramDateTime?e.push(n):t!=null&&t.programDateTime&&(n.programDateTime=t.endProgramDateTime)}function Za(n,t,e,i){n.relurl=t.URI,t.BYTERANGE&&n.setByteRange(t.BYTERANGE),n.level=e,n.sn="initSegment",i&&(n.levelkeys=i),n.initSegment=null}function Ya(n,t,e){n.levelkeys=t;let{encryptedFragments:i}=e;(!i.length||i[i.length-1].levelkeys!==t)&&Object.keys(t).some(s=>t[s].isCommonEncryption)&&i.push(n)}function ue(n,t,e){n.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${e[0]})`)}function Qa(n,t,e){n.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${e[0]})`)}function sr(n,t){let e=t.startPTS;if(z(e)){let i=0,s;t.sn>n.sn?(i=e-n.start,s=n):(i=n.start-e,s=t),s.duration!==i&&s.setDuration(i)}else t.sn>n.sn?n.cc===t.cc&&n.minEndPTS?t.setStart(n.start+(n.minEndPTS-n.start)):t.setStart(n.start+n.duration):t.setStart(Math.max(n.start-t.duration,0))}function Zo(n,t,e,i,s,r){i-e<=0&&(it.warn("Fragment should have a positive duration",t),i=e+t.duration,r=s+t.duration);let o=e,l=i,u=t.startPTS,c=t.endPTS;if(z(u)){let m=Math.abs(u-e);z(t.deltaPTS)?t.deltaPTS=Math.max(m,t.deltaPTS):t.deltaPTS=m,o=Math.max(e,u),e=Math.min(e,u),s=Math.min(s,t.startDTS),l=Math.min(i,c),i=Math.max(i,c),r=Math.max(r,t.endDTS)}let h=e-t.start;t.start!==0&&t.setStart(e),t.setDuration(i-t.start),t.startPTS=e,t.maxStartPTS=o,t.startDTS=s,t.endPTS=i,t.minEndPTS=l,t.endDTS=r;let d=t.sn;if(!n||d<n.startSN||d>n.endSN)return 0;let A,f=d-n.startSN,p=n.fragments;for(p[f]=t,A=f;A>0;A--)sr(p[A],p[A-1]);for(A=f;A<p.length-1;A++)sr(p[A],p[A+1]);return n.fragmentHint&&sr(p[p.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,h}function Hc(n,t){if(n===t)return;let e=null,i=n.fragments;for(let l=i.length-1;l>=0;l--){let u=i[l].initSegment;if(u){e=u;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let s;jc(n,t,(l,u,c,h)=>{if(!t.startCC&&u.cc!==l.cc){var d,A;let f=l.cc-u.cc;for(let p=c;p<h.length;p++)h[p].cc+=f;t.startCC=(d=(A=Jo(n,t.startSN-1))==null?void 0:A.cc)!=null?d:h[0].cc,t.endCC=h[h.length-1].cc}z(l.startPTS)&&z(l.endPTS)&&(u.setStart(u.startPTS=l.startPTS),u.startDTS=l.startDTS,u.maxStartPTS=l.maxStartPTS,u.endPTS=l.endPTS,u.endDTS=l.endDTS,u.minEndPTS=l.minEndPTS,u.setDuration(l.endPTS-l.startPTS),u.duration&&(s=u),t.PTSKnown=t.alignedSliding=!0),l.hasStreams&&(u.elementaryStreams=l.elementaryStreams),u.loader=l.loader,l.hasStats&&(u.stats=l.stats),l.initSegment&&(u.initSegment=l.initSegment,e=l.initSegment)});let r=t.fragments,a=t.fragmentHint?r.concat(t.fragmentHint):r;if(e&&a.forEach(l=>{var u;l&&(!l.initSegment||l.initSegment.relurl===((u=e)==null?void 0:u.relurl))&&(l.initSegment=e)}),t.skippedSegments)if(t.deltaUpdateFailed=r.some(l=>!l),t.deltaUpdateFailed){it.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=t.skippedSegments;l--;)r.shift();t.startSN=r[0].sn}else{t.endCC=r[r.length-1].cc,t.canSkipDateRanges&&(t.dateRanges=Xc(n.dateRanges,t));let l=n.fragments.filter(u=>u.rawProgramDateTime);if(n.hasProgramDateTime&&!t.hasProgramDateTime)for(let u=1;u<a.length;u++)a[u].programDateTime===null&&kr(a[u],a[u-1],l);Ko(l,t)}qc(n.partList,t.partList,(l,u)=>{u.elementaryStreams=l.elementaryStreams,u.stats=l.stats}),s?Zo(t,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):Yo(n,t),r.length&&(t.totalduration=t.edge-r[0].start),t.driftStartTime=n.driftStartTime,t.driftStart=n.driftStart;let o=t.advancedDateTime;if(t.advanced&&o){let l=t.edge;t.driftStart||(t.driftStartTime=o,t.driftStart=l),t.driftEndTime=o,t.driftEnd=l}else t.driftEndTime=n.driftEndTime,t.driftEnd=n.driftEnd,t.advancedDateTime=n.advancedDateTime;t.requestScheduled===-1&&(t.requestScheduled=n.requestScheduled)}function Xc(n,t){let{dateRanges:e,recentlyRemovedDateranges:i}=t,s=ct({},n);i&&i.forEach(o=>{delete s[o]});let a=Object.keys(s).length;return a&&Object.keys(e).forEach(o=>{let l=s[o],u=new as(e[o].attr,l);u.isValid?(s[o]=u,l||(u.tagOrder+=a)):it.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${ft(e[o].attr)}"`)}),s}function qc(n,t,e){if(n&&t){let i=0;for(let s=0,r=n.length;s<=r;s++){let a=n[s],o=t[s+i];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?e(a,o):i--}}}function jc(n,t,e){let i=t.skippedSegments,s=Math.max(n.startSN,t.startSN)-t.startSN,r=(n.fragmentHint?1:0)+(i?t.endSN:Math.min(n.endSN,t.endSN))-t.startSN,a=t.startSN-n.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let u=s;u<=r;u++){let c=l[a+u],h=o[u];if(i&&!h&&c&&(h=t.fragments[u]=c),c&&h){if(e(c,h,u,o),c.url&&c.url!==h.url){t.playlistParsingError=Ja(`media sequence mismatch ${h.sn}:`,n,t,c,h);return}else if(c.cc!==h.cc){t.playlistParsingError=Ja(`discontinuity sequence mismatch (${c.cc}!=${h.cc})`,n,t,c,h);return}}}}function Ja(n,t,e,i,s){return new Error(`${n} ${s.url}
Playlist starting @${t.startSN}
${t.m3u8}

Playlist starting @${e.startSN}
${e.m3u8}`)}function Yo(n,t,e=!0){let i=t.startSN+t.skippedSegments-n.startSN,s=n.fragments,r=i>=0,a=0;if(r&&i<s.length)a=s[i].start;else if(r&&t.startSN===n.endSN+1)a=n.fragmentEnd;else if(r&&e)a=n.fragmentStart+i*t.levelTargetDuration;else if(!t.skippedSegments&&t.fragmentStart===0)a=n.fragmentStart;else return;Mr(t,a)}function Mr(n,t){if(t){let e=n.fragments;for(let i=n.skippedSegments;i<e.length;i++)e[i].addStart(t);n.fragmentHint&&n.fragmentHint.addStart(t)}}function Qo(n,t=1/0){let e=1e3*n.targetduration;if(n.updated){let i=n.fragments,s=4;if(i.length&&e*s>t){let r=i[i.length-1].duration*1e3;r<e&&(e=r)}}else e/=2;return Math.round(e)}function Jo(n,t,e){if(!n)return null;let i=n.fragments[t-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===t)?i:t<n.startSN&&e&&e.sn===t?e:null}function $a(n,t,e){return n?$o(n.partList,t,e):null}function $o(n,t,e){if(n)for(let i=n.length;i--;){let s=n[i];if(s.index===e&&s.fragment.sn===t)return s}return null}function tl(n){n.forEach((t,e)=>{var i;(i=t.details)==null||i.fragments.forEach(s=>{s.level=e,s.initSegment&&(s.initSegment.level=e)})})}function ni(n,t){for(let i=0,s=n.length;i<s;i++){var e;if(((e=n[i])==null?void 0:e.cc)===t)return n[i]}return null}function Kc(n,t){return!!(n&&t.startCC<n.endCC&&t.endCC>n.startCC)}function to(n,t){if(n){let e=n.start+t;n.start=n.startPTS=e,n.endPTS=e+n.duration}}function el(n,t){let e=t.fragments;for(let i=0,s=e.length;i<s;i++)to(e[i],n);t.fragmentHint&&to(t.fragmentHint,n),t.alignedSliding=!0}function Zc(n,t){!n||(il(t,n),!t.alignedSliding&&n&&ls(t,n),!t.alignedSliding&&n&&!t.skippedSegments&&Yo(n,t,!1))}function il(n,t){if(!Kc(t,n))return;let e=Math.min(t.endCC,n.endCC),i=ni(t.fragments,e),s=ni(n.fragments,e);if(!i||!s)return;it.log(`Aligning playlist at start of dicontinuity sequence ${e}`);let r=i.start-s.start;el(r,n)}function ls(n,t){if(!n.hasProgramDateTime||!t.hasProgramDateTime)return;let e=n.fragments,i=t.fragments;if(!e.length||!i.length)return;let s,r,a=Math.min(t.endCC,n.endCC);t.startCC<a&&n.startCC<a&&(s=ni(i,a),r=ni(e,a)),(!s||!r)&&(s=i[Math.floor(i.length/2)],r=ni(e,s.cc)||e[Math.floor(e.length/2)]);let o=s.programDateTime,l=r.programDateTime;if(!o||!l)return;let u=(l-o)/1e3-(r.start-s.start);el(u,n)}var Yc={toString:function(n){let t="",e=n.length;for(let i=0;i<e;i++)t+=`[${n.start(i).toFixed(3)}-${n.end(i).toFixed(3)}]`;return t}},U={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},Ai=class extends ns{constructor(t,e,i,s,r){super(s,t.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=U.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{let{config:a,fragCurrent:o,media:l,mediaBuffer:u,state:c}=this,h=l?l.currentTime:0,d=Q.bufferInfo(u||l,h,a.maxBufferHole);if(this.log(`media seeking to ${z(h)?h.toFixed(3):h}, state: ${c}`),this.state===U.ENDED)this.resetLoadingState();else if(o){let A=a.maxFragLookUpTolerance,f=o.start-A,p=o.start+o.duration+A;if(!d.len||p<d.start||f>d.end){let m=h>p;(h<f||m)&&(m&&o.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l){this.fragmentTracker.removeFragmentsInRange(h,1/0,this.playlistType,!0);let A=this.lastCurrentTime;if(h>A&&(this.lastCurrentTime=h),!this.loadingParts){let f=Math.max(d.end,h),p=this.shouldLoadParts(this.getLevelDetails(),f);p&&(this.log(`LL-Part loading ON after seeking to ${h.toFixed(2)} with buffer @${f.toFixed(2)}`),this.loadingParts=p)}}!this.hls.hasEnoughToStart&&!d.len&&(this.log(`setting startPosition to ${h} because of seek before start`),this.nextLoadPosition=this.startPosition=h),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=t,this.fragmentLoader=new Cr(t.config),this.keyLoader=i,this.fragmentTracker=e,this.config=t.config,this.decrypter=new hi(t.config)}registerListeners(){let{hls:t}=this;t.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(g.ERROR,this.onError,this)}unregisterListeners(){let{hls:t}=this;t.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(g.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){if(this.state===U.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);let t=this.fragCurrent;t!=null&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=U.STOPPED}get startPositionValue(){let{nextLoadPosition:t,startPosition:e}=this;return e===-1&&t?t:e}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(t,e){if(e.live||!this.media)return!1;let i=t.end||0,s=this.config.timelineOffset||0;if(i<=s)return!1;let r=t.nextStart;if(r&&r>s&&r<e.edge||this.media.currentTime<t.start)return!1;let o=e.partList;if(o!=null&&o.length){let u=o[o.length-1];return Q.isBuffered(this.media,u.start+u.duration/2)}let l=e.fragments[e.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var t;return(t=this.levelLastLoaded)==null?void 0:t.details}}get timelineOffset(){let t=this.config.timelineOffset;if(t){var e;return((e=this.getLevelDetails())==null?void 0:e.appliedTimelineOffset)||t}return 0}onMediaAttached(t,e){let i=this.media=this.mediaBuffer=e.media;i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),i.addEventListener("seeking",this.onMediaSeeking),i.addEventListener("ended",this.onMediaEnded);let s=this.config;this.levels&&s.autoStartLoad&&this.state===U.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(t,e){let i=!!e.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),s.removeEventListener("seeking",this.onMediaSeeking),s.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(t,e){}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=U.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,i){this.startFragRequested=!0,this._loadFragForPlayback(t,e,i)}_loadFragForPlayback(t,e,i){let s=r=>{let a=r.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${r.part?" part: "+r.part.index:""} of ${this.fragInfo(a,!1,r.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(r)};this._doFragLoad(t,e,i,s).then(r=>{if(!r)return;let a=this.state,o=r.frag;if(this.fragContextChanged(o)){(a===U.FRAG_LOADING||!this.fragCurrent&&a===U.PARSING)&&(this.fragmentTracker.removeFragment(o),this.state=U.IDLE);return}"payload"in r&&(this.log(`Loaded ${o.type} sn: ${o.sn} of ${this.playlistLabel()} ${o.level}`),this.hls.trigger(g.FRAG_LOADED,r)),this._handleFragmentLoadComplete(r)}).catch(r=>{this.state===U.STOPPED||this.state===U.ERROR||(this.warn(`Frag error: ${(r==null?void 0:r.message)||r}`),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var e;let{fragmentTracker:i}=this;if(i.getState(t)===yt.APPENDING){let r=t.type,a=this.getFwdBufferInfo(this.mediaBuffer,r),o=Math.max(t.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?t.sn-l.sn:0)===1||this.reduceMaxBufferLength(o,t.duration))&&i.removeFragment(t)}else((e=this.mediaBuffer)==null?void 0:e.buffered.length)===0?i.removeAllFragments():i.hasParts(t.type)&&(i.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),i.getState(t)===yt.PARTIAL&&i.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){let e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}waitForLive(t){let e=t.details;return(e==null?void 0:e.live)&&e.type!=="EVENT"&&(this.levelLastLoaded!==t||e.expired)}flushMainBuffer(t,e,i=null){if(!(t-e))return;let s={startOffset:t,endOffset:e,type:i};this.hls.trigger(g.BUFFER_FLUSHING,s)}_loadInitSegment(t,e){this._doFragLoad(t,e).then(i=>{let s=i==null?void 0:i.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{let{hls:s}=this,{frag:r,payload:a}=i,o=r.decryptdata;if(a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&Ge(o.method)){let l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer,Nn(o.method)).catch(u=>{throw s.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:r}),u}).then(u=>{let c=self.performance.now();return s.trigger(g.FRAG_DECRYPTED,{frag:r,payload:u,stats:{tstart:l,tdecrypt:c}}),i.payload=u,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===U.STOPPED||this.state===U.ERROR||(this.warn(i),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){let{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");let i=t.frag.stats;this.state!==U.STOPPED&&(this.state=U.IDLE),t.frag.data=new Uint8Array(t.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}fragContextChanged(t){let{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){let i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)} > buffer:${i?Yc.toString(Q.getBuffered(i)):"(detached)"})`),xt(t)){var s;if(t.type!==W.SUBTITLE){let a=t.elementaryStreams;if(!Object.keys(a).some(o=>!!a[o])){this.state=U.IDLE;return}}let r=(s=this.levels)==null?void 0:s[t.level];r!=null&&r.fragmentError&&(this.log(`Resetting level fragment error count of ${r.fragmentError} on frag buffered`),r.fragmentError=0)}this.state=U.IDLE}_handleFragmentLoadComplete(t){let{transmuxer:e}=this;if(!e)return;let{frag:i,part:s,partsLoaded:r}=t,a=!r||r.length===0||r.some(l=>!l),o=new di(i.level,i.sn,i.stats.chunkCount+1,0,s?s.index:-1,!a);e.flush(o)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e,i=null,s){var r;this.fragCurrent=t;let a=e==null?void 0:e.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;t.encrypted&&!((r=t.decryptdata)!=null&&r.key)?(this.log(`Loading key for ${t.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${t.level}`),this.state=U.KEY_LOADING,this.fragCurrent=t,o=this.keyLoader.load(t).then(h=>{if(!this.fragContextChanged(h.frag))return this.hls.trigger(g.KEY_LOADED,h),this.state===U.KEY_LOADING&&(this.state=U.IDLE),h}),this.hls.trigger(g.KEY_LOADING,{frag:t}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!t.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(t,a.encryptedFragments);let l=this.fragPrevious;if(xt(t)&&(!l||t.sn!==l.sn)){let h=this.shouldLoadParts(e.details,t.end);h!==this.loadingParts&&(this.log(`LL-Part loading ${h?"ON":"OFF"} loading sn ${l==null?void 0:l.sn}->${t.sn}`),this.loadingParts=h)}if(i=Math.max(t.start,i||0),this.loadingParts&&xt(t)){let h=a.partList;if(h&&s){i>t.end&&a.fragmentHint&&(t=a.fragmentHint);let d=this.getNextPart(h,t,i);if(d>-1){let A=h[d];t=this.fragCurrent=A.fragment,this.log(`Loading ${t.type} sn: ${t.sn} part: ${A.index} (${d}/${h.length-1}) of ${this.fragInfo(t,!1,A)}) cc: ${t.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=A.start+A.duration,this.state=U.FRAG_LOADING;let f;return o?f=o.then(p=>!p||this.fragContextChanged(p.frag)?null:this.doFragPartsLoad(t,A,e,s)).catch(p=>this.handleFragLoadError(p)):f=this.doFragPartsLoad(t,A,e,s).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(g.FRAG_LOADING,{frag:t,part:A,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):f}else if(!t.url||this.loadedEndOfParts(h,i))return Promise.resolve(null)}}if(xt(t)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)}`),this.loadingParts=!1;else if(!t.url)return Promise.resolve(null);this.log(`Loading ${t.type} sn: ${t.sn} of ${this.fragInfo(t,!1)}) cc: ${t.cc} ${a?"["+a.startSN+"-"+a.endSN+"]":""}, target: ${parseFloat(i.toFixed(3))}`),z(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=U.FRAG_LOADING;let u=this.config.progressive,c;return u&&o?c=o.then(h=>!h||this.fragContextChanged(h==null?void 0:h.frag)?null:this.fragmentLoader.load(t,s)).catch(h=>this.handleFragLoadError(h)):c=Promise.all([this.fragmentLoader.load(t,u?s:void 0),o]).then(([h])=>(!u&&h&&s&&s(h),h)).catch(h=>this.handleFragLoadError(h)),this.hls.trigger(g.FRAG_LOADING,{frag:t,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(t,e,i,s){return new Promise((r,a)=>{var o;let l=[],u=(o=i.details)==null?void 0:o.partList,c=h=>{this.fragmentLoader.loadPart(t,h,s).then(d=>{l[h.index]=d;let A=d.part;this.hls.trigger(g.FRAG_LOADED,d);let f=$a(i.details,t.sn,h.index+1)||$o(u,t.sn,h.index+1);if(f)c(f);else return r({frag:t,part:A,partsLoaded:l})}).catch(a)};c(e)})}handleFragLoadError(t){if("data"in t){let e=t.data;t.data&&e.details===w.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):this.hls.trigger(g.ERROR,e)}else this.hls.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){let e=this.getCurrentContext(t);if(!e||this.state!==U.PARSING){!this.fragCurrent&&this.state!==U.STOPPED&&this.state!==U.ERROR&&(this.state=U.IDLE);return}let{frag:i,part:s,level:r}=e,a=self.performance.now();i.stats.parsing.end=a,s&&(s.stats.parsing.end=a);let o=this.getLevelDetails(),u=o&&i.sn>o.endSN||this.shouldLoadParts(o,i.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(i,s,r,t.partial)}shouldLoadParts(t,e){if(this.config.lowLatencyMode){if(!t)return this.loadingParts;if(t!=null&&t.partList){var i;let r=t.partList[0],a=r.end+(((i=t.fragmentHint)==null?void 0:i.duration)||0);if(e>=a){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(t){let{levels:e,fragCurrent:i}=this,{level:s,sn:r,part:a}=t;if(!(e!=null&&e[s]))return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;let o=e[s],l=o.details,u=a>-1?$a(l,r,a):null,c=u?u.fragment:Jo(l,r,i);return c?(i&&i!==c&&(c.stats=i.stats),{frag:c,part:u,level:o}):null}bufferFragmentData(t,e,i,s,r){var a;if(!t||this.state!==U.PARSING)return;let{data1:o,data2:l}=t,u=o;if(o&&l&&(u=Ht(o,l)),!((a=u)!=null&&a.length))return;let c={type:t.type,frag:e,part:i,chunkMeta:s,parent:e.type,data:u};if(this.hls.trigger(g.BUFFER_APPENDING,c),t.dropped&&t.independent&&!i){if(r)return;this.flushBufferGap(e)}}flushBufferGap(t){let e=this.media;if(!e)return;if(!Q.isBuffered(e,e.currentTime)){this.flushMainBuffer(0,t.start);return}let i=e.currentTime,s=Q.bufferInfo(e,i,0),r=t.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,r*.25),o=Math.max(Math.min(t.start-a,s.end-a),i+a);t.start-o>a&&this.flushMainBuffer(o,t.start)}getFwdBufferInfo(t,e){var i;let s=this.getLoadPosition();if(!z(s))return null;let a=this.lastCurrentTime>s||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(t,s,e,a)}getFwdBufferInfoAtPos(t,e,i,s){let r=Q.bufferInfo(t,e,s);if(r.len===0&&r.nextStart!==void 0){let a=this.fragmentTracker.getBufferedFrag(e,i);if(a&&(r.nextStart<=a.end||a.gap)){let o=Math.max(Math.min(r.nextStart,a.end)-e,s);return Q.bufferInfo(t,e,o)}}return r}getMaxBufferLength(t){let{config:e}=this,i;return t?i=Math.max(8*e.maxBufferSize/t,e.maxBufferLength):i=e.maxBufferLength,Math.min(i,e.maxMaxBufferLength)}reduceMaxBufferLength(t,e){let i=this.config,s=Math.max(Math.min(t-e,i.maxBufferLength),e),r=Math.max(t-e*3,i.maxMaxBufferLength/2,s);return r>=s?(i.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0):!1}getAppendedFrag(t,e=W.MAIN){var i;let s=(i=this.fragmentTracker)==null?void 0:i.getAppendedFrag(t,e);return s&&"fragment"in s?s.fragment:s}getNextFragment(t,e){let i=e.fragments,s=i.length;if(!s)return null;let{config:r}=this,a=i[0].start,o=r.lowLatencyMode&&!!e.partList,l=null;if(e.live){let h=r.initialLiveManifestSize;if(s<h)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${h})`),null;if(!e.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||t<a){var u;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(e,i);let d=this.hls.startPosition,A=this.hls.liveSyncPosition,f=l?(d!==-1&&d>=a?d:A)||l.start:t;this.log(`Setting startPosition to ${f} to match start frag at live edge. mainStart: ${d} liveSyncPosition: ${A} frag.start: ${(u=l)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=f}}else t<=a&&(l=i[0]);if(!l){let h=this.loadingParts?e.partEnd:e.fragmentEnd;l=this.getFragmentAtPosition(t,h,e)}let c=this.filterReplacedPrimary(l,e);if(!c&&l){let h=l.sn-e.startSN;c=this.filterReplacedPrimary(i[h+1]||null,e)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(t,e){let i=this.fragmentTracker.getState(t);return(i===yt.OK||i===yt.PARTIAL&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,i,s,r){let a=null;if(t.gap&&(a=this.getNextFragment(this.nextLoadPosition,e),a&&!a.gap&&i.nextStart)){let o=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,s,0);if(o!==null&&i.len+o.len>=r){let l=a.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(eo(this.hls.config)){var t,e;if((t=this.hls.interstitialsManager)==null||(e=t.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(t,e){if(!t)return t;if(eo(this.hls.config)&&t.type!==W.SUBTITLE){let i=this.hls.interstitialsManager,s=i==null?void 0:i.bufferingItem;if(s){let a=s.event;if(a){if(a.appendInPlace||Math.abs(t.start-s.start)>1||s.start===0)return null}else if(t.end<=s.start&&(e==null?void 0:e.live)===!1||t.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||t.start-s.end>1))return null}let r=i==null?void 0:i.playerQueue;if(r)for(let a=r.length;a--;){let o=r[a].interstitial;if(o.appendInPlace&&t.start>=o.startTime&&t.end<=o.resumeTime)return null}}return t}mapToInitFragWhenRequired(t){return t!=null&&t.initSegment&&!(t!=null&&t.initSegment.data)&&!this.bitrateTest?t.initSegment:t}getNextPart(t,e,i){let s=-1,r=!1,a=!0;for(let o=0,l=t.length;o<l;o++){let u=t[o];if(a=a&&!u.independent,s>-1&&i<u.start)break;let c=u.loaded;c?s=-1:(r||u.independent||a)&&u.fragment===e&&(s=o),r=c}return s}loadedEndOfParts(t,e){let i=t[t.length-1];return i&&e>i.start&&i.loaded}getInitialLiveFragment(t,e){let i=this.fragPrevious,s=null;if(i){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),s=vc(e,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){let r=i.sn+1;if(r>=t.startSN&&r<=t.endSN){let a=e[r-t.startSN];i.cc===a.cc&&(s=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=Ho(e,i.cc),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{let r=this.hls.liveSyncPosition;r!==null&&(s=this.getFragmentAtPosition(r,this.bitrateTest?t.fragmentEnd:t.edge,t))}return s}getFragmentAtPosition(t,e,i){let{config:s}=this,{fragPrevious:r}=this,{fragments:a,endSN:o}=i,{fragmentHint:l}=i,{maxFragLookUpTolerance:u}=s,c=i.partList,h=!!(this.loadingParts&&c!=null&&c.length&&l);h&&l&&!this.bitrateTest&&c[c.length-1].fragment.sn===l.sn&&(a=a.concat(l),o=l.sn);let d;if(t<e){var A;let p=t<this.lastCurrentTime||t>e-u||(A=this.media)!=null&&A.paused||!this.startFragRequested?0:u;d=we(r,a,t,p)}else d=a[a.length-1];if(d){let f=d.sn-i.startSN,p=this.fragmentTracker.getState(d);if((p===yt.OK||p===yt.PARTIAL&&d.gap)&&(r=d),r&&d.sn===r.sn&&(!h||c[0].fragment.sn>d.sn||!i.live&&!h)&&r&&d.level===r.level){let v=a[f+1];d.sn<o&&this.fragmentTracker.getState(v)!==yt.OK?d=v:d=null}}return d}alignPlaylists(t,e,i){let s=t.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;let r=t.fragmentStart,a=!e,o=t.alignedSliding&&z(r);if(a||!o&&!r){Zc(i,t);let l=t.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} fragments: ${s}`),l}return r}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,t.partTarget*3)}setStartPosition(t,e){let i=this.startPosition;i<e&&(i=-1);let s=this.timelineOffset;if(i===-1){let r=this.startTimeOffset!==null,a=r?this.startTimeOffset:t.startTimeOffset;a!==null&&z(a)?(i=e+a,a<0&&(i+=t.edge),i=Math.min(Math.max(e,i),e+t.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${a} found in ${r?"multivariant":"media"} playlist`),this.startPosition=i):t.live?(i=this.hls.liveSyncPosition||e,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+s}this.nextLoadPosition=i+s}getLoadPosition(){var t;let{media:e}=this,i=0;return(t=this.hls)!=null&&t.hasEnoughToStart&&e?i=e.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(t,e){this.transmuxer&&t.type===this.playlistType&&xt(t)&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${e?" part "+e.index:""} of ${this.playlistLabel()} ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&this.state!==U.FRAG_LOADING_WAITING_RETRY)&&(this.state=U.IDLE)}onFragmentOrKeyLoadError(t,e){if(e.chunkMeta&&!e.frag){let f=this.getCurrentContext(e.chunkMeta);f&&(e.frag=f.frag)}let i=e.frag;if(!i||i.type!==t||!this.levels)return;if(this.fragContextChanged(i)){var s;this.warn(`Frag load error must match current frag to retry ${i.url} > ${(s=this.fragCurrent)==null?void 0:s.url}`);return}let r=e.details===w.FRAG_GAP;r&&this.fragmentTracker.fragBuffered(i,!0);let a=e.errorAction,{action:o,flags:l,retryCount:u=0,retryConfig:c}=a||{},h=!!a&&!!c,d=h&&o===Rt.RetryRequest,A=h&&!a.resolved&&l===Zt.MoveAllAlternatesMatchingHost;if(!d&&A&&xt(i)&&!i.endList)this.resetFragmentErrors(t),this.treatAsGap(i),a.resolved=!0;else if((d||A)&&u<c.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);let f=_n(c,u);this.warn(`Fragment ${i.sn} of ${t} ${i.level} errored with ${e.details}, retrying loading ${u+1}/${c.maxNumRetry} in ${f}ms`),a.resolved=!0,this.retryDate=self.performance.now()+f,this.state=U.FRAG_LOADING_WAITING_RETRY}else if(c&&a)if(this.resetFragmentErrors(t),u<c.maxNumRetry)!r&&o!==Rt.RemoveAlternatePermanently&&(a.resolved=!0);else{this.warn(`${e.details} reached or exceeded max retry (${u})`);return}else o===Rt.SendAlternateToPenaltyBox?this.state=U.WAITING_LEVEL:this.state=U.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(t){if(this.state===U.PARSING||this.state===U.PARSED){let e=t.frag,i=t.parent,s=this.getFwdBufferInfo(this.mediaBuffer,i),r=s&&s.len>.5;r&&this.reduceMaxBufferLength(s.len,(e==null?void 0:e.duration)||10);let a=!r;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${i} buffer`),e&&(this.fragmentTracker.removeFragment(e),this.nextLoadPosition=e.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(t){t===W.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==U.STOPPED&&(this.state=U.IDLE)}afterBufferFlushed(t,e,i){if(!t)return;let s=Q.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,s,i),this.state===U.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==U.STOPPED&&(this.state=U.IDLE)}resetStartWhenNotLoaded(t){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;let e=t?t.details:null;e!=null&&e.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(e,e.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.warn(`The loading context changed while buffering fragment ${t.sn} of ${this.playlistLabel()} ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,i,s){let r=i.details;if(!r){this.warn("level.details undefined");return}if(!Object.keys(t.elementaryStreams).reduce((l,u)=>{let c=t.elementaryStreams[u];if(c){let h=c.endPTS-c.startPTS;if(h<=0)return this.warn(`Could not parse fragment ${t.sn} ${u} duration reliably (${h})`),l||!1;let d=s?0:Zo(r,t,c.startPTS,c.endPTS,c.startDTS,c.endDTS);return this.hls.trigger(g.LEVEL_PTS_UPDATED,{details:r,level:i,drift:d,type:u,frag:t,start:c.startPTS,end:c.endPTS}),!0}return l},!1)){var o;if(i.fragmentError===0&&this.treatAsGap(t,i),((o=this.transmuxer)==null?void 0:o.error)===null){let l=new Error(`Found no media in fragment ${t.sn} of ${this.playlistLabel()} ${t.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:t,reason:`Found no media in msn ${t.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=U.PARSED,this.log(`Parsed ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)})`),this.hls.trigger(g.FRAG_PARSED,{frag:t,part:e})}playlistLabel(){return this.playlistType===W.MAIN?"level":"track"}fragInfo(t,e=!0,i){var s,r;return`${this.playlistLabel()} ${t.level} (${i?"part":"frag"}:[${((s=e&&!i?t.startPTS:(i||t).start)!=null?s:NaN).toFixed(3)}-${((r=e&&!i?t.endPTS:(i||t).end)!=null?r:NaN).toFixed(3)}]${i&&t.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(t,e){e&&e.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)}resetTransmuxer(){var t;(t=this.transmuxer)==null||t.reset()}recoverWorkerError(t){t.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(t){let e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}};function eo(n){return!!n.interstitialsController&&n.enableInterstitialPlayback!==!1}var us=class{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){let{chunks:t,dataLength:e}=this,i;if(t.length)t.length===1?i=t[0]:i=Qc(t,e);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}};function Qc(n,t){let e=new Uint8Array(t),i=0;for(let s=0;s<n.length;s++){let r=n[s];e.set(r,i),i+=r.length}return e}var rr={exports:{}},io;function Jc(){return io||(io=1,function(n){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function r(l,u,c,h,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var A=new s(c,h||l,d),f=e?e+u:u;return l._events[f]?l._events[f].fn?l._events[f]=[l._events[f],A]:l._events[f].push(A):(l._events[f]=A,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new i:delete l._events[u]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,h;if(this._eventsCount===0)return u;for(h in c=this._events)t.call(c,h)&&u.push(e?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=e?e+u:u,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,A=h.length,f=new Array(A);d<A;d++)f[d]=h[d].fn;return f},o.prototype.listenerCount=function(u){var c=e?e+u:u,h=this._events[c];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,c,h,d,A,f){var p=e?e+u:u;if(!this._events[p])return!1;var m=this._events[p],v=arguments.length,b,T;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,h),!0;case 4:return m.fn.call(m.context,c,h,d),!0;case 5:return m.fn.call(m.context,c,h,d,A),!0;case 6:return m.fn.call(m.context,c,h,d,A,f),!0}for(T=1,b=new Array(v-1);T<v;T++)b[T-1]=arguments[T];m.fn.apply(m.context,b)}else{var L=m.length,I;for(T=0;T<L;T++)switch(m[T].once&&this.removeListener(u,m[T].fn,void 0,!0),v){case 1:m[T].fn.call(m[T].context);break;case 2:m[T].fn.call(m[T].context,c);break;case 3:m[T].fn.call(m[T].context,c,h);break;case 4:m[T].fn.call(m[T].context,c,h,d);break;default:if(!b)for(I=1,b=new Array(v-1);I<v;I++)b[I-1]=arguments[I];m[T].fn.apply(m[T].context,b)}}return!0},o.prototype.on=function(u,c,h){return r(this,u,c,h,!1)},o.prototype.once=function(u,c,h){return r(this,u,c,h,!0)},o.prototype.removeListener=function(u,c,h,d){var A=e?e+u:u;if(!this._events[A])return this;if(!c)return a(this,A),this;var f=this._events[A];if(f.fn)f.fn===c&&(!d||f.once)&&(!h||f.context===h)&&a(this,A);else{for(var p=0,m=[],v=f.length;p<v;p++)(f[p].fn!==c||d&&!f[p].once||h&&f[p].context!==h)&&m.push(f[p]);m.length?this._events[A]=m.length===1?m[0]:m:a(this,A)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=e?e+u:u,this._events[c]&&a(this,c)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,n.exports=o}(rr)),rr.exports}var $c=Jc(),Un=Nu($c),fi=void 0,je={};function th(){return typeof __HLS_WORKER_BUNDLE__=="function"}function eh(){let n=je[fi];if(n)return n.clientCount++,n;let t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(t),s={worker:new self.Worker(e),objectURL:e,clientCount:1};return je[fi]=s,s}function ih(n){let t=je[n];if(t)return t.clientCount++,t;let e=new self.URL(n,self.location.href).href,s={worker:new self.Worker(e),scriptURL:e,clientCount:1};return je[n]=s,s}function sh(n){let t=je[n||fi];if(t&&t.clientCount--===1){let{worker:i,objectURL:s}=t;delete je[n||fi],s&&self.URL.revokeObjectURL(s),i.terminate()}}function sl(n,t){return t+10<=n.length&&n[t]===51&&n[t+1]===68&&n[t+2]===73&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128}function Bn(n,t){return t+10<=n.length&&n[t]===73&&n[t+1]===68&&n[t+2]===51&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128}function Ss(n,t){let e=0;return e=(n[t]&127)<<21,e|=(n[t+1]&127)<<14,e|=(n[t+2]&127)<<7,e|=n[t+3]&127,e}function gi(n,t){let e=t,i=0;for(;Bn(n,t);){i+=10;let s=Ss(n,t+6);i+=s,sl(n,t+10)&&(i+=10),t+=i}if(i>0)return n.subarray(e,e+i)}function rh(n,t,e,i){let s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=t[e+2],a=r>>2&15;if(a>12){let A=new Error(`invalid ADTS sampling index:${a}`);n.emit(g.ERROR,g.ERROR,{type:G.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!0,error:A,reason:A.message});return}let o=(r>>6&3)+1,l=t[e+3]>>6&3|(r&1)<<2,u="mp4a.40."+o,c=s[a],h=a;(o===5||o===29)&&(h-=3);let d=[o<<3|(h&14)>>1,(h&1)<<7|l<<3];return it.log(`manifest codec:${i}, parsed codec:${u}, channels:${l}, rate:${c} (ADTS object type:${o} sampling index:${a})`),{config:d,samplerate:c,channelCount:l,codec:u,parsedCodec:u,manifestCodec:i}}function rl(n,t){return n[t]===255&&(n[t+1]&246)===240}function nl(n,t){return n[t+1]&1?7:9}function Vn(n,t){return(n[t+3]&3)<<11|n[t+4]<<3|(n[t+5]&224)>>>5}function nh(n,t){return t+5<n.length}function cs(n,t){return t+1<n.length&&rl(n,t)}function ah(n,t){return nh(n,t)&&rl(n,t)&&Vn(n,t)<=n.length-t}function oh(n,t){if(cs(n,t)){let e=nl(n,t);if(t+e>=n.length)return!1;let i=Vn(n,t);if(i<=e)return!1;let s=t+i;return s===n.length||cs(n,s)}return!1}function al(n,t,e,i,s){if(!n.samplerate){let r=rh(t,e,i,s);if(!r)return;ct(n,r)}}function ol(n){return 1024*9e4/n}function lh(n,t){let e=nl(n,t);if(t+e<=n.length){let i=Vn(n,t)-e;if(i>0)return{headerLength:e,frameLength:i}}}function ll(n,t,e,i,s){let r=ol(n.samplerate),a=i+s*r,o=lh(t,e),l;if(o){let{frameLength:h,headerLength:d}=o,A=d+h,f=Math.max(0,e+A-t.length);f?(l=new Uint8Array(A-d),l.set(t.subarray(e+d,t.length),0)):l=t.subarray(e+d,e+A);let p={unit:l,pts:a};return f||n.samples.push(p),{sample:p,length:A,missing:f}}let u=t.length-e;return l=new Uint8Array(u),l.set(t.subarray(e,t.length),0),{sample:{unit:l,pts:a},length:u,missing:-1}}function uh(n,t){return Bn(n,t)&&Ss(n,t+6)+10<=n.length-t}function ch(n){if(n.size<2)return;let t=Ut(n.data,!0),e=new Uint8Array(n.data.subarray(t.length+1));return{key:n.type,info:t,data:e.buffer}}function hh(n){if(n.size<2)return;if(n.type==="TXXX"){let e=1,i=Ut(n.data.subarray(e),!0);e+=i.length+1;let s=Ut(n.data.subarray(e));return{key:n.type,info:i,data:s}}let t=Ut(n.data.subarray(1));return{key:n.type,info:"",data:t}}function dh(n){if(n.type==="WXXX"){if(n.size<2)return;let e=1,i=Ut(n.data.subarray(e),!0);e+=i.length+1;let s=Ut(n.data.subarray(e));return{key:n.type,info:i,data:s}}let t=Ut(n.data);return{key:n.type,info:"",data:t}}function Ah(n){return btoa(String.fromCharCode(...n))}function ul(n,t){if(n<0)return-ul(-n,t);let e=Math.pow(10,t);if(Math.abs(n*e%1-.5)<Number.EPSILON){let s=Math.floor(n*e);return(s%2===0?s:s+1)/e}else return Math.round(n*e)/e}function fh(n,t){let e=new URL(n),i=new URL(t);if(e.origin!==i.origin)return n;let s=e.pathname.split("/").slice(1),r=i.pathname.split("/").slice(1,-1);for(;s[0]===r[0];)s.shift(),r.shift();for(;r.length;)r.shift(),s.unshift("..");return s.join("/")}function gh(){try{return crypto.randomUUID()}catch(n){try{let t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch(t){let e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{let r=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(s=="x"?r:r&3|8).toString(16)})}}}function ph(n){return n instanceof ArrayBuffer?n:n.byteOffset==0&&n.byteLength==n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}function nr(n,t=0,e=1/0){return mh(n,t,e,Uint8Array)}function mh(n,t,e,i){let s=vh(n),r=1;"BYTES_PER_ELEMENT"in i&&(r=i.BYTES_PER_ELEMENT);let a=yh(n)?n.byteOffset:0,o=(a+n.byteLength)/r,l=(a+t)/r,u=Math.floor(Math.max(0,Math.min(l,o))),c=Math.floor(Math.min(u+Math.max(e,0),o));return new i(s,u,c-u)}function vh(n){return n instanceof ArrayBuffer?n:n.buffer}function yh(n){return n&&n.buffer instanceof ArrayBuffer&&n.byteLength!==void 0&&n.byteOffset!==void 0}function Th(n){let t={key:n.type,description:"",data:"",mimeType:null,pictureType:null},e=3;if(n.size<2)return;if(n.data[0]!==e){console.log("Ignore frame with unrecognized character encoding");return}let i=n.data.subarray(1).indexOf(0);if(i===-1)return;let s=Ut(nr(n.data,1,i)),r=n.data[2+i],a=n.data.subarray(3+i).indexOf(0);if(a===-1)return;let o=Ut(nr(n.data,3+i,a)),l;return s==="-->"?l=Ut(nr(n.data,4+i+a)):l=ph(n.data.subarray(4+i+a)),t.mimeType=s,t.pictureType=r,t.description=o,t.data=l,t}function bh(n){return n.type==="PRIV"?ch(n):n.type[0]==="W"?dh(n):n.type==="APIC"?Th(n):hh(n)}function Eh(n){let t=String.fromCharCode(n[0],n[1],n[2],n[3]),e=Ss(n,4),i=10;return{type:t,size:e,data:n.subarray(i,i+e)}}var Ui=10,xh=10;function cl(n){let t=0,e=[];for(;Bn(n,t);){let i=Ss(n,t+6);n[t+5]>>6&1&&(t+=Ui),t+=Ui;let s=t+i;for(;t+xh<s;){let r=Eh(n.subarray(t)),a=bh(r);a&&e.push(a),t+=r.size+Ui}sl(n,t)&&(t+=Ui)}return e}function hl(n){return n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp"}function Sh(n){if(n.data.byteLength===8){let t=new Uint8Array(n.data),e=t[3]&1,i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,e&&(i+=4772185884e-2),Math.round(i)}}function zn(n){let t=cl(n);for(let e=0;e<t.length;e++){let i=t[e];if(hl(i))return Sh(i)}}var Ft=function(n){return n.audioId3="org.id3",n.dateRange="com.apple.quicktime.HLS",n.emsg="https://aomedia.org/emsg/ID3",n.misbklv="urn:misb:KLV:bin:1910.1",n}({});function se(n="",t=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}var pi=class{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,i,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,i){}demux(t,e){this.cachedData&&(t=Ht(this.cachedData,t),this.cachedData=null);let i=gi(t,0),s=i?i.length:0,r,a=this._audioTrack,o=this._id3Track,l=i?zn(i):void 0,u=t.length;for((this.basePTS===null||this.frameIndex===0&&z(l))&&(this.basePTS=Lh(l,e,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Ft.audioId3,duration:Number.POSITIVE_INFINITY});s<u;){if(this.canParse(t,s)){let c=this.appendFrame(a,t,s);c?(this.frameIndex++,this.lastPTS=c.sample.pts,s+=c.length,r=s):s=u}else uh(t,s)?(i=gi(t,s),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Ft.audioId3,duration:Number.POSITIVE_INFINITY}),s+=i.length,r=s):s++;if(s===u&&r!==u){let c=t.slice(r);this.cachedData?this.cachedData=Ht(this.cachedData,c):this.cachedData=c}}return{audioTrack:a,videoTrack:se(),id3Track:o,textTrack:se()}}demuxSampleAes(t,e,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){let e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:se(),id3Track:this._id3Track,textTrack:se()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}},Lh=(n,t,e)=>{if(z(n))return n*90;let i=e?e.baseTime*9e4/e.timescale:0;return t*9e4+i},Bi=null,Ih=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Rh=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Ph=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Ch=[0,1,1,4];function dl(n,t,e,i,s){if(e+24>t.length)return;let r=Al(t,e);if(r&&e+r.frameLength<=t.length){let a=r.samplesPerFrame*9e4/r.sampleRate,o=i+s*a,l={unit:t.subarray(e,e+r.frameLength),pts:o,dts:o};return n.config=[],n.channelCount=r.channelCount,n.samplerate=r.sampleRate,n.samples.push(l),{sample:l,length:r.frameLength,missing:0}}}function Al(n,t){let e=n[t+1]>>3&3,i=n[t+1]>>1&3,s=n[t+2]>>4&15,r=n[t+2]>>2&3;if(e!==1&&s!==0&&s!==15&&r!==3){let a=n[t+2]>>1&1,o=n[t+3]>>6,l=e===3?3-i:i===3?3:4,u=Ih[l*14+s-1]*1e3,h=Rh[(e===3?0:e===2?1:2)*3+r],d=o===3?1:2,A=Ph[e][i],f=Ch[i],p=A*8*f,m=Math.floor(A*u/h+a)*f;if(Bi===null){let T=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Bi=T?parseInt(T[1]):0}return!!Bi&&Bi<=87&&i===2&&u>=224e3&&o===0&&(n[t+3]=n[t+3]|128),{sampleRate:h,channelCount:d,frameLength:m,samplesPerFrame:p}}}function Wn(n,t){return n[t]===255&&(n[t+1]&224)===224&&(n[t+1]&6)!==0}function fl(n,t){return t+1<n.length&&Wn(n,t)}function Dh(n,t){return Wn(n,t)&&4<=n.length-t}function gl(n,t){if(t+1<n.length&&Wn(n,t)){let i=Al(n,t),s=4;i!=null&&i.frameLength&&(s=i.frameLength);let r=t+s;return r===n.length||fl(n,r)}return!1}var _r=class extends pi{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}static probe(t,e){if(!t)return!1;let i=gi(t,0),s=(i==null?void 0:i.length)||0;if(gl(t,s))return!1;for(let r=t.length;s<r;s++)if(oh(t,s))return e.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return ah(t,e)}appendFrame(t,e,i){al(t,this.observer,e,i,t.manifestCodec);let s=ll(t,e,i,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}},pl=(n,t)=>{let e=0,i=5;t+=i;let s=new Uint32Array(1),r=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=n[t];let o=Math.min(i,8),l=8-o;r[0]=4278190080>>>24+l<<l,s[0]=(a[0]&r[0])>>l,e=e?e<<o|s[0]:s[0],t+=1,i-=o}return e},Nr=class extends pi{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,i){let s=ml(t,e,i,this.basePTS,this.frameIndex);if(s!==-1)return{sample:t.samples[t.samples.length-1],length:s,missing:0}}static probe(t){if(!t)return!1;let e=gi(t,0);if(!e)return!1;let i=e.length;return t[i]===11&&t[i+1]===119&&zn(e)!==void 0&&pl(t,i)<16}};function ml(n,t,e,i,s){if(e+8>t.length||t[e]!==11||t[e+1]!==119)return-1;let r=t[e+4]>>6;if(r>=3)return-1;let o=[48e3,44100,32e3][r],l=t[e+4]&63,c=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+r]*2;if(e+c>t.length)return-1;let h=t[e+6]>>5,d=0;h===2?d+=2:(h&1&&h!==1&&(d+=2),h&4&&(d+=2));let A=(t[e+6]<<8|t[e+7])>>12-d&1,p=[2,1,2,3,3,4,4,5][h]+A,m=t[e+5]>>3,v=t[e+5]&7,b=new Uint8Array([r<<6|m<<1|v>>2,(v&3)<<6|h<<3|A<<2|l>>4,l<<4&224]),T=1536/o*9e4,L=i+s*T,I=t.subarray(e,e+c);return n.config=b,n.channelCount=p,n.samplerate=o,n.samples.push({unit:I,pts:L}),c}var Fr=class extends pi{resetInitSegment(t,e,i,s){super.resetInitSegment(t,e,i,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:s,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;let e=gi(t,0),i=(e==null?void 0:e.length)||0;if(e&&t[i]===11&&t[i+1]===119&&zn(e)!==void 0&&pl(t,i)<=16)return!1;for(let s=t.length;i<s;i++)if(gl(t,i))return it.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return Dh(t,e)}appendFrame(t,e,i){if(this.basePTS!==null)return dl(t,e,i,this.basePTS,this.frameIndex)}},wh=/\/emsg[-/]ID3/i,Ur=class{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,i,s){let r=this.videoTrack=se("video",1),a=this.audioTrack=se("audio",1),o=this.txtTrack=se("text",1);if(this.id3Track=se("id3",1),this.timeOffset=0,!(t!=null&&t.byteLength))return;let l=ko(t);if(l.video){let{id:u,timescale:c,codec:h,supplemental:d}=l.video;r.id=u,r.timescale=o.timescale=c,r.codec=h,r.supplemental=d}if(l.audio){let{id:u,timescale:c,codec:h}=l.audio;a.id=u,a.timescale=c,a.codec=h}o.id=Do.text,r.sampleDuration=0,r.duration=a.duration=s}resetContiguity(){this.remainderData=null}static probe(t){return Vu(t)}demux(t,e){this.timeOffset=e;let i=t,s=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Ht(this.remainderData,t));let o=Ku(i);this.remainderData=o.remainder,s.samples=o.valid||new Uint8Array}else s.samples=i;let a=this.extractID3Track(s,e);return r.samples=Sa(e,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){let t=this.timeOffset,e=this.videoTrack,i=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;let s=this.extractID3Track(e,this.timeOffset);return i.samples=Sa(t,e),{videoTrack:e,audioTrack:se(),id3Track:s,textTrack:se()}}extractID3Track(t,e){let i=this.id3Track;if(t.samples.length){let s=Z(t.samples,["emsg"]);s&&s.forEach(r=>{let a=Yu(r);if(wh.test(a.schemeIdUri)){let o=so(a,e),l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);let u=a.payload;i.samples.push({data:u,len:u.byteLength,dts:o,pts:o,type:Ft.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){let o=so(a,e);i.samples.push({data:a.payload,len:a.payload.byteLength,dts:o,pts:o,type:Ft.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}};function so(n,t){return z(n.presentationTime)?n.presentationTime/n.timeScale:t+n.presentationTimeDelta/n.timeScale}var Br=class{constructor(t,e,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new hi(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,Te.cbc)}decryptAacSample(t,e,i){let s=t[e].unit;if(s.length<=16)return;let r=s.subarray(16,s.length-s.length%16),a=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(a).then(o=>{let l=new Uint8Array(o);s.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,i)})}decryptAacSamples(t,e,i){for(;;e++){if(e>=t.length){i();return}if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){let e=Math.floor((t.length-48)/160)*16+16,i=new Int8Array(e),s=0;for(let r=32;r<t.length-16;r+=160,s+=16)i.set(t.subarray(r,r+16),s);return i}getAvcDecryptedUnit(t,e){let i=new Uint8Array(e),s=0;for(let r=32;r<t.length-16;r+=160,s+=16)t.set(i.subarray(s,s+16),r);return t}decryptAvcSample(t,e,i,s,r){let a=_o(r.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{r.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(t,e,i+1,s)})}decryptAvcSamples(t,e,i,s){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length){s();return}let r=t[e].units;for(;!(i>=r.length);i++){let a=r[i];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(t,e,i,s,a),!this.decrypter.isSync()))return}}}},hs=class{constructor(){this.VideoSample=null}createVideoSample(t,e,i){return{key:t,frame:!1,pts:e,dts:i,units:[],length:0}}getLastNalUnit(t){var e;let i=this.VideoSample,s;if((!i||i.units.length===0)&&(i=t[t.length-1]),(e=i)!=null&&e.units){let r=i.units;s=r[r.length-1]}return s}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(t.pts===void 0){let i=e.samples,s=i.length;if(s){let r=i[s-1];t.pts=r.pts,t.dts=r.dts}else{e.dropped++;return}}e.samples.push(t)}}parseNALu(t,e,i){let s=e.byteLength,r=t.naluState||0,a=r,o=[],l=0,u,c,h,d=-1,A=0;for(r===-1&&(d=0,A=this.getNALuType(e,0),r=0,l=1);l<s;){if(u=e[l++],!r){r=u?0:1;continue}if(r===1){r=u?0:2;continue}if(!u)r=3;else if(u===1){if(c=l-r-1,d>=0){let f={data:e.subarray(d,c),type:A};o.push(f)}else{let f=this.getLastNalUnit(t.samples);f&&(a&&l<=4-a&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-a)),c>0&&(f.data=Ht(f.data,e.subarray(0,c)),f.state=0))}l<s?(h=this.getNALuType(e,l),d=l,A=h,r=0):r=-1}else r=0}if(d>=0&&r>=0){let f={data:e.subarray(d,s),type:A,state:r};o.push(f)}if(o.length===0){let f=this.getLastNalUnit(t.samples);f&&(f.data=Ht(f.data,e))}return t.naluState=r,o}},Ce=class{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){let t=this.data,e=this.bytesAvailable,i=t.byteLength-e,s=new Uint8Array(4),r=Math.min(4,e);if(r===0)throw new Error("no bytes available");s.set(t.subarray(i,i+r)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=r*8,this.bytesAvailable-=r}skipBits(t){let e;t=Math.min(t,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,e=t>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t),i=this.word>>>32-e;if(t>32&&it.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return e=t-e,e>0&&this.bitsAvailable?i<<e|this.readBits(e):i}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if((this.word&2147483648>>>t)!==0)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){let t=this.skipLZ();return this.readBits(t+1)-1}readEG(){let t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}},ds=class extends hs{parsePES(t,e,i,s){let r=this.parseNALu(t,i.data,s),a=this.VideoSample,o,l=!1;i.data=null,a&&r.length&&!t.audFound&&(this.pushAccessUnit(a,t),a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),r.forEach(u=>{var c,h;switch(u.type){case 1:{let p=!1;o=!0;let m=u.data;if(l&&m.length>4){let v=this.readSliceType(m);(v===2||v===4||v===7||v===9)&&(p=!0)}if(p){var d;(d=a)!=null&&d.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.frame=!0,a.key=p;break}case 5:o=!0,(c=a)!=null&&c.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 6:{o=!0,kn(u.data,1,i.pts,e.samples);break}case 7:{var A,f;o=!0,l=!0;let p=u.data,m=this.readSPS(p);if(!t.sps||t.width!==m.width||t.height!==m.height||((A=t.pixelRatio)==null?void 0:A[0])!==m.pixelRatio[0]||((f=t.pixelRatio)==null?void 0:f[1])!==m.pixelRatio[1]){t.width=m.width,t.height=m.height,t.pixelRatio=m.pixelRatio,t.sps=[p];let v=p.subarray(1,4),b="avc1.";for(let T=0;T<3;T++){let L=v[T].toString(16);L.length<2&&(L="0"+L),b+=L}t.codec=b}break}case 8:o=!0,t.pps=[u.data];break;case 9:o=!0,t.audFound=!0,(h=a)!=null&&h.frame&&(this.pushAccessUnit(a,t),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:o=!0;break;default:o=!1;break}a&&o&&a.units.push(u)}),s&&a&&(this.pushAccessUnit(a,t),this.VideoSample=null)}getNALuType(t,e){return t[e]&31}readSliceType(t){let e=new Ce(t);return e.readUByte(),e.readUEG(),e.readUEG()}skipScalingList(t,e){let i=8,s=8,r;for(let a=0;a<t;a++)s!==0&&(r=e.readEG(),s=(i+r+256)%256),i=s===0?i:s}readSPS(t){let e=new Ce(t),i=0,s=0,r=0,a=0,o,l,u,c=e.readUByte.bind(e),h=e.readBits.bind(e),d=e.readUEG.bind(e),A=e.readBoolean.bind(e),f=e.skipBits.bind(e),p=e.skipEG.bind(e),m=e.skipUEG.bind(e),v=this.skipScalingList.bind(this);c();let b=c();if(h(5),f(3),c(),m(),b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128){let D=d();if(D===3&&f(1),m(),m(),f(1),A())for(l=D!==3?8:12,u=0;u<l;u++)A()&&(u<6?v(16,e):v(64,e))}m();let T=d();if(T===0)d();else if(T===1)for(f(1),p(),p(),o=d(),u=0;u<o;u++)p();m(),f(1);let L=d(),I=d(),k=h(1);k===0&&f(1),f(1),A()&&(i=d(),s=d(),r=d(),a=d());let R=[1,1];if(A()&&A())switch(c()){case 1:R=[1,1];break;case 2:R=[12,11];break;case 3:R=[10,11];break;case 4:R=[16,11];break;case 5:R=[40,33];break;case 6:R=[24,11];break;case 7:R=[20,11];break;case 8:R=[32,11];break;case 9:R=[80,33];break;case 10:R=[18,11];break;case 11:R=[15,11];break;case 12:R=[64,33];break;case 13:R=[160,99];break;case 14:R=[4,3];break;case 15:R=[3,2];break;case 16:R=[2,1];break;case 255:{R=[c()<<8|c(),c()<<8|c()];break}}return{width:Math.ceil((L+1)*16-i*2-s*2),height:(2-k)*(I+1)*16-(k?2:4)*(r+a),pixelRatio:R}}},As=class extends hs{constructor(...t){super(...t),this.initVPS=null}parsePES(t,e,i,s){let r=this.parseNALu(t,i.data,s),a=this.VideoSample,o,l=!1;i.data=null,a&&r.length&&!t.audFound&&(this.pushAccessUnit(a,t),a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),r.forEach(u=>{var c,h;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.frame=!0,o=!0;break;case 16:case 17:case 18:case 21:if(o=!0,l){var d;(d=a)!=null&&d.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:o=!0,(c=a)!=null&&c.frame&&!a.key&&(this.pushAccessUnit(a,t),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 39:o=!0,kn(u.data,2,i.pts,e.samples);break;case 32:o=!0,t.vps||(typeof t.params!="object"&&(t.params={}),t.params=ct(t.params,this.readVPS(u.data)),this.initVPS=u.data),t.vps=[u.data];break;case 33:if(o=!0,l=!0,t.vps!==void 0&&t.vps[0]!==this.initVPS&&t.sps!==void 0&&!this.matchSPS(t.sps[0],u.data)&&(this.initVPS=t.vps[0],t.sps=t.pps=void 0),!t.sps){let A=this.readSPS(u.data);t.width=A.width,t.height=A.height,t.pixelRatio=A.pixelRatio,t.codec=A.codecString,t.sps=[],typeof t.params!="object"&&(t.params={});for(let f in A.params)t.params[f]=A.params[f]}this.pushParameterSet(t.sps,u.data,t.vps),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0;break;case 34:if(o=!0,typeof t.params=="object"){if(!t.pps){t.pps=[];let A=this.readPPS(u.data);for(let f in A)t.params[f]=A[f]}this.pushParameterSet(t.pps,u.data,t.vps)}break;case 35:o=!0,t.audFound=!0,(h=a)!=null&&h.frame&&(this.pushAccessUnit(a,t),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:o=!1;break}a&&o&&a.units.push(u)}),s&&a&&(this.pushAccessUnit(a,t),this.VideoSample=null)}pushParameterSet(t,e,i){(i&&i[0]===this.initVPS||!i&&!t.length)&&t.push(e)}getNALuType(t,e){return(t[e]&126)>>>1}ebsp2rbsp(t){let e=new Uint8Array(t.byteLength),i=0;for(let s=0;s<t.byteLength;s++)s>=2&&t[s]===3&&t[s-1]===0&&t[s-2]===0||(e[i]=t[s],i++);return new Uint8Array(e.buffer,0,i)}pushAccessUnit(t,e){super.pushAccessUnit(t,e),this.initVPS&&(this.initVPS=null)}readVPS(t){let e=new Ce(t);e.readUByte(),e.readUByte(),e.readBits(4),e.skipBits(2),e.readBits(6);let i=e.readBits(3),s=e.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:s}}readSPS(t){let e=new Ce(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.readBits(4);let i=e.readBits(3);e.readBoolean();let s=e.readBits(2),r=e.readBoolean(),a=e.readBits(5),o=e.readUByte(),l=e.readUByte(),u=e.readUByte(),c=e.readUByte(),h=e.readUByte(),d=e.readUByte(),A=e.readUByte(),f=e.readUByte(),p=e.readUByte(),m=e.readUByte(),v=e.readUByte(),b=[],T=[];for(let K=0;K<i;K++)b.push(e.readBoolean()),T.push(e.readBoolean());if(i>0)for(let K=i;K<8;K++)e.readBits(2);for(let K=0;K<i;K++)b[K]&&(e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte()),T[K]&&e.readUByte();e.readUEG();let L=e.readUEG();L==3&&e.skipBits(1);let I=e.readUEG(),k=e.readUEG(),R=e.readBoolean(),D=0,O=0,P=0,V=0;R&&(D+=e.readUEG(),O+=e.readUEG(),P+=e.readUEG(),V+=e.readUEG());let y=e.readUEG(),S=e.readUEG(),x=e.readUEG(),E=e.readBoolean();for(let K=E?0:i;K<=i;K++)e.skipUEG(),e.skipUEG(),e.skipUEG();if(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.readBoolean()&&e.readBoolean())for(let bt=0;bt<4;bt++)for(let zt=0;zt<(bt===3?2:6);zt++)if(!e.readBoolean())e.readUEG();else{let jt=Math.min(64,1<<4+(bt<<1));bt>1&&e.readEG();for(let Fe=0;Fe<jt;Fe++)e.readEG()}e.readBoolean(),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.skipUEG(),e.skipUEG(),e.readBoolean());let M=e.readUEG(),_=0;for(let K=0;K<M;K++){let bt=!1;if(K!==0&&(bt=e.readBoolean()),bt){K===M&&e.readUEG(),e.readBoolean(),e.readUEG();let zt=0;for(let Se=0;Se<=_;Se++){let jt=e.readBoolean(),Fe=!1;jt||(Fe=e.readBoolean()),(jt||Fe)&&zt++}_=zt}else{let zt=e.readUEG(),Se=e.readUEG();_=zt+Se;for(let jt=0;jt<zt;jt++)e.readUEG(),e.readBoolean();for(let jt=0;jt<Se;jt++)e.readUEG(),e.readBoolean()}}if(e.readBoolean()){let K=e.readUEG();for(let bt=0;bt<K;bt++){for(let zt=0;zt<x+4;zt++)e.readBits(1);e.readBits(1)}}let X=0,H=1,J=1,et=!0,st=1,nt=0;e.readBoolean(),e.readBoolean();let Tt=!1;if(e.readBoolean()){if(e.readBoolean()){let Le=e.readUByte(),ua=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Pi=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Le>0&&Le<16?(H=ua[Le-1],J=Pi[Le-1]):Le===255&&(H=e.readBits(16),J=e.readBits(16))}if(e.readBoolean()&&e.readBoolean(),e.readBoolean()&&(e.readBits(3),e.readBoolean(),e.readBoolean()&&(e.readUByte(),e.readUByte(),e.readUByte())),e.readBoolean()&&(e.readUEG(),e.readUEG()),e.readBoolean(),e.readBoolean(),e.readBoolean(),Tt=e.readBoolean(),Tt&&(D+=e.readUEG(),O+=e.readUEG(),P+=e.readUEG(),V+=e.readUEG()),e.readBoolean()&&(st=e.readBits(32),nt=e.readBits(32),e.readBoolean()&&e.readUEG(),e.readBoolean())){let Pi=e.readBoolean(),ca=e.readBoolean(),ti=!1;(Pi||ca)&&(ti=e.readBoolean(),ti&&(e.readUByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),ti&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let ha=0;ha<=i;ha++){et=e.readBoolean();let vu=et||e.readBoolean(),da=!1;vu?e.readEG():da=e.readBoolean();let Aa=da?1:e.readUEG()+1;if(Pi)for(let ei=0;ei<Aa;ei++)e.readUEG(),e.readUEG(),ti&&(e.readUEG(),e.readUEG()),e.skipBits(1);if(ca)for(let ei=0;ei<Aa;ei++)e.readUEG(),e.readUEG(),ti&&(e.readUEG(),e.readUEG()),e.skipBits(1)}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),X=e.readUEG())}let qt=I,$e=k;if(R||Tt){let K=1,bt=1;L===1?K=bt=2:L==2&&(K=2),qt=I-K*O-K*D,$e=k-bt*V-bt*P}let Ii=s?["A","B","C"][s]:"",Ri=o<<24|l<<16|u<<8|c,_e=0;for(let K=0;K<32;K++)_e=(_e|(Ri>>K&1)<<31-K)>>>0;let Ne=_e.toString(16);return a===1&&Ne==="2"&&(Ne="6"),{codecString:`hvc1.${Ii}${a}.${Ne}.${r?"H":"L"}${v}.B0`,params:{general_tier_flag:r,general_profile_idc:a,general_profile_space:s,general_profile_compatibility_flags:[o,l,u,c],general_constraint_indicator_flags:[h,d,A,f,p,m],general_level_idc:v,bit_depth:y+8,bit_depth_luma_minus8:y,bit_depth_chroma_minus8:S,min_spatial_segmentation_idc:X,chroma_format_idc:L,frame_rate:{fixed:et,fps:nt/st}},width:qt,height:$e,pixelRatio:[H,J]}}readPPS(t){let e=new Ce(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.skipUEG(),e.skipUEG(),e.skipBits(2),e.skipBits(3),e.skipBits(2),e.skipUEG(),e.skipUEG(),e.skipEG(),e.skipBits(2),e.readBoolean()&&e.skipUEG(),e.skipEG(),e.skipEG(),e.skipBits(4);let s=e.readBoolean(),r=e.readBoolean(),a=1;return r&&s?a=0:r?a=3:s&&(a=2),{parallelismType:a}}matchSPS(t,e){return String.fromCharCode.apply(null,t).substr(3)===String.fromCharCode.apply(null,e).substr(3)}},Et=188,re=class{constructor(t,e,i,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=s,this.videoParser=null}static probe(t,e){let i=re.syncOffset(t);return i>0&&e.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(t){let e=t.length,i=Math.min(Et*5,e-Et)+1,s=0;for(;s<i;){let r=!1,a=-1,o=0;for(let l=s;l<e;l+=Et)if(t[l]===71&&(e-l===Et||t[l+Et]===71)){if(o++,a===-1&&(a=l,a!==0&&(i=Math.min(a+Et*99,t.length-Et)+1)),r||(r=Vr(t,l)===0),r&&o>1&&(a===0&&o>2||l+Et>i))return a}else{if(o)return-1;break}s++}return-1}static createTrack(t,e){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:Do[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?e:void 0}}resetInitSegment(t,e,i,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=re.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=re.createTrack("audio",s),this._id3Track=re.createTrack("id3"),this._txtTrack=re.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){let{_audioTrack:t,_videoTrack:e,_id3Track:i}=this;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e,i=!1,s=!1){i||(this.sampleAes=null);let r,a=this._videoTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack,c=a.pid,h=a.pesData,d=o.pid,A=l.pid,f=o.pesData,p=l.pesData,m=null,v=this.pmtParsed,b=this._pmtId,T=t.length;if(this.remainderData&&(t=Ht(this.remainderData,t),T=t.length,this.remainderData=null),T<Et&&!s)return this.remainderData=t,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};let L=Math.max(0,re.syncOffset(t));T-=(T-L)%Et,T<t.byteLength&&!s&&(this.remainderData=new Uint8Array(t.buffer,T,t.buffer.byteLength-T));let I=0;for(let R=L;R<T;R+=Et)if(t[R]===71){let D=!!(t[R+1]&64),O=Vr(t,R),P=(t[R+3]&48)>>4,V;if(P>1){if(V=R+5+t[R+4],V===R+Et)continue}else V=R+4;switch(O){case c:if(D){if(h&&(r=Be(h,this.logger))){if(this.videoParser===null)switch(a.segmentCodec){case"avc":this.videoParser=new ds;break;case"hevc":this.videoParser=new As;break}this.videoParser!==null&&this.videoParser.parsePES(a,u,r,!1)}h={data:[],size:0}}h&&(h.data.push(t.subarray(V,R+Et)),h.size+=R+Et-V);break;case d:if(D){if(f&&(r=Be(f,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,r);break;case"mp3":this.parseMPEGPES(o,r);break;case"ac3":this.parseAC3PES(o,r);break}f={data:[],size:0}}f&&(f.data.push(t.subarray(V,R+Et)),f.size+=R+Et-V);break;case A:D&&(p&&(r=Be(p,this.logger))&&this.parseID3PES(l,r),p={data:[],size:0}),p&&(p.data.push(t.subarray(V,R+Et)),p.size+=R+Et-V);break;case 0:D&&(V+=t[V]+1),b=this._pmtId=Oh(t,V);break;case b:{D&&(V+=t[V]+1);let y=kh(t,V,this.typeSupported,i,this.observer,this.logger);c=y.videoPid,c>0&&(a.pid=c,a.segmentCodec=y.segmentVideoCodec),d=y.audioPid,d>0&&(o.pid=d,o.segmentCodec=y.segmentAudioCodec),A=y.id3Pid,A>0&&(l.pid=A),m!==null&&!v&&(this.logger.warn(`MPEG-TS PMT found at ${R} after unknown PID '${m}'. Backtracking to sync byte @${L} to parse all TS packets.`),m=null,R=L-188),v=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=O;break}}else I++;I>0&&zr(this.observer,new Error(`Found ${I} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=h,o.pesData=f,l.pesData=p;let k={audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};return s&&this.extractRemainingSamples(k),k}flush(){let{remainderData:t}=this;this.remainderData=null;let e;return t?e=this.demux(t,-1,!1,!0):e={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){let{audioTrack:e,videoTrack:i,id3Track:s,textTrack:r}=t,a=i.pesData,o=e.pesData,l=s.pesData,u;if(a&&(u=Be(a,this.logger))){if(this.videoParser===null)switch(i.segmentCodec){case"avc":this.videoParser=new ds;break;case"hevc":this.videoParser=new As;break}this.videoParser!==null&&(this.videoParser.parsePES(i,r,u,!0),i.pesData=null)}else i.pesData=a;if(o&&(u=Be(o,this.logger))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,u);break;case"mp3":this.parseMPEGPES(e,u);break;case"ac3":this.parseAC3PES(e,u);break}e.pesData=null}else o!=null&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=o;l&&(u=Be(l,this.logger))?(this.parseID3PES(s,u),s.pesData=null):s.pesData=l}demuxSampleAes(t,e,i){let s=this.demux(t,i,!0,!this.config.progressive),r=this.sampleAes=new Br(this.observer,this.config,e);return this.decrypt(s,r)}decrypt(t,e){return new Promise(i=>{let{audioTrack:s,videoTrack:r}=t;s.samples&&s.segmentCodec==="aac"?e.decryptAacSamples(s.samples,0,()=>{r.samples?e.decryptAvcSamples(r.samples,0,0,()=>{i(t)}):i(t)}):r.samples&&e.decryptAvcSamples(r.samples,0,0,()=>{i(t)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(t,e){let i=0,s=this.aacOverFlow,r=e.data;if(s){this.aacOverFlow=null;let h=s.missing,d=s.sample.unit.byteLength;if(h===-1)r=Ht(s.sample.unit,r);else{let A=d-h;s.sample.unit.set(r.subarray(0,h),A),t.samples.push(s.sample),i=s.missing}}let a,o;for(a=i,o=r.length;a<o-1&&!cs(r,a);a++);if(a!==i){let h,d=a<o-1;if(d?h=`AAC PES did not start with ADTS header,offset:${a}`:h="No ADTS header found in AAC PES",zr(this.observer,new Error(h),d,this.logger),!d)return}al(t,this.observer,r,a,this.audioCodec);let l;if(e.pts!==void 0)l=e.pts;else if(s){let h=ol(t.samplerate);l=s.sample.pts+h}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,c;for(;a<o;)if(c=ll(t,r,a,l,u),a+=c.length,c.missing){this.aacOverFlow=c;break}else for(u++;a<o-1&&!cs(r,a);a++);}parseMPEGPES(t,e){let i=e.data,s=i.length,r=0,a=0,o=e.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<s;)if(fl(i,a)){let l=dl(t,i,a,o,r);if(l)a+=l.length,r++;else break}else a++}parseAC3PES(t,e){{let i=e.data,s=e.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}let r=i.length,a=0,o=0,l;for(;o<r&&(l=ml(t,i,o,s,a++))>0;)o+=l}}parseID3PES(t,e){if(e.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}let i=ct({},e,{type:this._videoTrack?Ft.emsg:Ft.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(i)}};function Vr(n,t){return((n[t+1]&31)<<8)+n[t+2]}function Oh(n,t){return(n[t+10]&31)<<8|n[t+11]}function kh(n,t,e,i,s,r){let a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(n[t+1]&15)<<8|n[t+2],l=t+3+o-4,u=(n[t+10]&15)<<8|n[t+11];for(t+=12+u;t<l;){let c=Vr(n,t),h=(n[t+3]&15)<<8|n[t+4];switch(n[t]){case 207:if(!i){ar("ADTS AAC",r);break}case 15:a.audioPid===-1&&(a.audioPid=c);break;case 21:a.id3Pid===-1&&(a.id3Pid=c);break;case 219:if(!i){ar("H.264",r);break}case 27:a.videoPid===-1&&(a.videoPid=c);break;case 3:case 4:!e.mpeg&&!e.mp3?r.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=c,a.segmentAudioCodec="mp3");break;case 193:if(!i){ar("AC-3",r);break}case 129:e.ac3?a.audioPid===-1&&(a.audioPid=c,a.segmentAudioCodec="ac3"):r.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&h>0){let d=t+5,A=h;for(;A>2;){switch(n[d]){case 106:e.ac3!==!0?r.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=c,a.segmentAudioCodec="ac3");break}let p=n[d+1]+2;d+=p,A-=p}}break;case 194:case 135:return zr(s,new Error("Unsupported EC-3 in M2TS found"),void 0,r),a;case 36:a.videoPid===-1&&(a.videoPid=c,a.segmentVideoCodec="hevc",r.log("HEVC in M2TS found"));break}t+=h+5}return a}function zr(n,t,e,i){i.warn(`parsing error: ${t.message}`),n.emit(g.ERROR,g.ERROR,{type:G.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,levelRetry:e,error:t,reason:t.message})}function ar(n,t){t.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function Be(n,t){let e=0,i,s,r,a,o,l=n.data;if(!n||n.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=Ht(l[0],l[1]),l.splice(1,1);if(i=l[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(s=(i[4]<<8)+i[5],s&&s>n.size-6)return null;let c=i[7];c&192&&(a=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,c&64?(o=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,a-o>60*9e4&&(t.warn(`${Math.round((a-o)/9e4)}s delta between PTS and DTS, align them`),a=o)):o=a),r=i[8];let h=r+9;if(n.size<=h)return null;n.size-=h;let d=new Uint8Array(n.size);for(let A=0,f=l.length;A<f;A++){i=l[A];let p=i.byteLength;if(h)if(h>p){h-=p;continue}else i=i.subarray(h),p-=h,h=0;d.set(i,e),e+=p}return s&&(s-=r+3),{data:d,pts:a,dts:o,len:s}}return null}var Wr=class{static getSilentFrame(t,e){switch(t){case"mp4a.40.2":if(e===1)return new Uint8Array([0,200,0,128,35,128]);if(e===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(e===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(e===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(e===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(e===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(e===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(e===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}},fe=Math.pow(2,32)-1,C=class{static init(){C.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in C.types)C.types.hasOwnProperty(t)&&(C.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);let e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);C.HDLR_TYPES={video:e,audio:i};let s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);C.STTS=C.STSC=C.STCO=r,C.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),C.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),C.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),C.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);let a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);C.FTYP=C.box(C.types.ftyp,a,l,a,o),C.DINF=C.box(C.types.dinf,C.box(C.types.dref,s))}static box(t,...e){let i=8,s=e.length,r=s;for(;s--;)i+=e[s].byteLength;let a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(t,4),s=0,i=8;s<r;s++)a.set(e[s],i),i+=e[s].byteLength;return a}static hdlr(t){return C.box(C.types.hdlr,C.HDLR_TYPES[t])}static mdat(t){return C.box(C.types.mdat,t)}static mdhd(t,e){e*=t;let i=Math.floor(e/(fe+1)),s=Math.floor(e%(fe+1));return C.box(C.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(t){return C.box(C.types.mdia,C.mdhd(t.timescale||0,t.duration||0),C.hdlr(t.type),C.minf(t))}static mfhd(t){return C.box(C.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?C.box(C.types.minf,C.box(C.types.smhd,C.SMHD),C.DINF,C.stbl(t)):C.box(C.types.minf,C.box(C.types.vmhd,C.VMHD),C.DINF,C.stbl(t))}static moof(t,e,i){return C.box(C.types.moof,C.mfhd(t),C.traf(i,e))}static moov(t){let e=t.length,i=[];for(;e--;)i[e]=C.trak(t[e]);return C.box.apply(null,[C.types.moov,C.mvhd(t[0].timescale||0,t[0].duration||0)].concat(i).concat(C.mvex(t)))}static mvex(t){let e=t.length,i=[];for(;e--;)i[e]=C.trex(t[e]);return C.box.apply(null,[C.types.mvex,...i])}static mvhd(t,e){e*=t;let i=Math.floor(e/(fe+1)),s=Math.floor(e%(fe+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return C.box(C.types.mvhd,r)}static sdtp(t){let e=t.samples||[],i=new Uint8Array(4+e.length),s,r;for(s=0;s<e.length;s++)r=e[s].flags,i[s+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return C.box(C.types.sdtp,i)}static stbl(t){return C.box(C.types.stbl,C.stsd(t),C.box(C.types.stts,C.STTS),C.box(C.types.stsc,C.STSC),C.box(C.types.stsz,C.STSZ),C.box(C.types.stco,C.STCO))}static avc1(t){let e=[],i=[],s,r,a;for(s=0;s<t.sps.length;s++)r=t.sps[s],a=r.byteLength,e.push(a>>>8&255),e.push(a&255),e=e.concat(Array.prototype.slice.call(r));for(s=0;s<t.pps.length;s++)r=t.pps[s],a=r.byteLength,i.push(a>>>8&255),i.push(a&255),i=i.concat(Array.prototype.slice.call(r));let o=C.box(C.types.avcC,new Uint8Array([1,e[3],e[4],e[5],255,224|t.sps.length].concat(e).concat([t.pps.length]).concat(i))),l=t.width,u=t.height,c=t.pixelRatio[0],h=t.pixelRatio[1];return C.box(C.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,C.box(C.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),C.box(C.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,h>>24,h>>16&255,h>>8&255,h&255])))}static esds(t){let e=t.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e,6,1,2])}static audioStsd(t){let e=t.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount||0,0,16,0,0,0,0,e>>8&255,e&255,0,0])}static mp4a(t){return C.box(C.types.mp4a,C.audioStsd(t),C.box(C.types.esds,C.esds(t)))}static mp3(t){return C.box(C.types[".mp3"],C.audioStsd(t))}static ac3(t){return C.box(C.types["ac-3"],C.audioStsd(t),C.box(C.types.dac3,t.config))}static stsd(t){let{segmentCodec:e}=t;if(t.type==="audio"){if(e==="aac")return C.box(C.types.stsd,C.STSD,C.mp4a(t));if(e==="ac3"&&t.config)return C.box(C.types.stsd,C.STSD,C.ac3(t));if(e==="mp3"&&t.codec==="mp3")return C.box(C.types.stsd,C.STSD,C.mp3(t))}else if(t.pps&&t.sps){if(e==="avc")return C.box(C.types.stsd,C.STSD,C.avc1(t));if(e==="hevc"&&t.vps)return C.box(C.types.stsd,C.STSD,C.hvc1(t))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${t.type} segment codec (${e}/${t.codec})`)}static tkhd(t){let e=t.id,i=(t.duration||0)*(t.timescale||0),s=t.width||0,r=t.height||0,a=Math.floor(i/(fe+1)),o=Math.floor(i%(fe+1));return C.box(C.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,r>>8&255,r&255,0,0]))}static traf(t,e){let i=C.sdtp(t),s=t.id,r=Math.floor(e/(fe+1)),a=Math.floor(e%(fe+1));return C.box(C.types.traf,C.box(C.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),C.box(C.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,a>>24,a>>16&255,a>>8&255,a&255])),C.trun(t,i.length+16+20+8+16+8+8),i)}static trak(t){return t.duration=t.duration||4294967295,C.box(C.types.trak,C.tkhd(t),C.mdia(t))}static trex(t){let e=t.id;return C.box(C.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){let i=t.samples||[],s=i.length,r=12+16*s,a=new Uint8Array(r),o,l,u,c,h,d;for(e+=8+r,a.set([t.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255],0),o=0;o<s;o++)l=i[o],u=l.duration,c=l.size,h=l.flags,d=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,h.degradPrio&240<<8,h.degradPrio&15,d>>>24&255,d>>>16&255,d>>>8&255,d&255],12+16*o);return C.box(C.types.trun,a)}static initSegment(t){C.types||C.init();let e=C.moov(t);return Ht(C.FTYP,e)}static hvc1(t){let e=t.params,i=[t.vps,t.sps,t.pps],s=4,r=new Uint8Array([1,e.general_profile_space<<6|(e.general_tier_flag?32:0)|e.general_profile_idc,e.general_profile_compatibility_flags[0],e.general_profile_compatibility_flags[1],e.general_profile_compatibility_flags[2],e.general_profile_compatibility_flags[3],e.general_constraint_indicator_flags[0],e.general_constraint_indicator_flags[1],e.general_constraint_indicator_flags[2],e.general_constraint_indicator_flags[3],e.general_constraint_indicator_flags[4],e.general_constraint_indicator_flags[5],e.general_level_idc,240|e.min_spatial_segmentation_idc>>8,255&e.min_spatial_segmentation_idc,252|e.parallelismType,252|e.chroma_format_idc,248|e.bit_depth_luma_minus8,248|e.bit_depth_chroma_minus8,0,parseInt(e.frame_rate.fps),s-1|e.temporal_id_nested<<2|e.num_temporal_layers<<3|(e.frame_rate.fixed?64:0),i.length]),a=r.length;for(let f=0;f<i.length;f+=1){a+=3;for(let p=0;p<i[f].length;p+=1)a+=2+i[f][p].length}let o=new Uint8Array(a);o.set(r,0),a=r.length;let l=i.length-1;for(let f=0;f<i.length;f+=1){o.set(new Uint8Array([32+f|(f===l?128:0),0,i[f].length]),a),a+=3;for(let p=0;p<i[f].length;p+=1)o.set(new Uint8Array([i[f][p].length>>8,i[f][p].length&255]),a),a+=2,o.set(i[f][p],a),a+=i[f][p].length}let u=C.box(C.types.hvcC,o),c=t.width,h=t.height,d=t.pixelRatio[0],A=t.pixelRatio[1];return C.box(C.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,h>>8&255,h&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,C.box(C.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),C.box(C.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,A>>24,A>>16&255,A>>8&255,A&255])))}};C.types=void 0;C.HDLR_TYPES=void 0;C.STTS=void 0;C.STSC=void 0;C.STCO=void 0;C.STSZ=void 0;C.VMHD=void 0;C.SMHD=void 0;C.STSD=void 0;C.FTYP=void 0;C.DINF=void 0;var vl=9e4;function Gn(n,t,e=1,i=!1){let s=n*t*e;return i?Math.round(s):s}function Mh(n,t,e=1,i=!1){return Gn(n,t,1/e,i)}function ii(n,t=!1){return Gn(n,1e3,1/vl,t)}function _h(n,t=1){return Gn(n,vl,1/t)}var Nh=10*1e3,Fh=1024,Uh=1152,Bh=1536,Ve=null,or=null;function ro(n,t,e,i){return{duration:t,size:e,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:n?2:1,isNonSync:n?0:1}}}var He=class{constructor(t,e,i,s){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=s,this.ISGenerated=!1,Ve===null){let a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ve=a?parseInt(a[1]):0}if(or===null){let r=navigator.userAgent.match(/Safari\/(\d+)/i);or=r?parseInt(r[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1,i=t[0].pts,s=t.reduce((r,a)=>{let o=a.pts,l=o-r;return l<-4294967296&&(e=!0,o=Wt(o,i),l=o-r),l>0?r:o},i);return e&&this.logger.debug("PTS rollover detected"),s}remux(t,e,i,s,r,a,o,l){let u,c,h,d,A,f,p=r,m=r,v=t.pid>-1,b=e.pid>-1,T=e.samples.length,L=t.samples.length>0,I=o&&T>0||T>1;if((!v||L)&&(!b||I)||this.ISGenerated||o){if(this.ISGenerated){var R,D,O,P;let x=this.videoTrackConfig;(x&&(e.width!==x.width||e.height!==x.height||((R=e.pixelRatio)==null?void 0:R[0])!==((D=x.pixelRatio)==null?void 0:D[0])||((O=e.pixelRatio)==null?void 0:O[1])!==((P=x.pixelRatio)==null?void 0:P[1]))||!x&&I||this.nextAudioPts===null&&L)&&this.resetInitSegment()}this.ISGenerated||(h=this.generateIS(t,e,r,a));let V=this.isVideoContiguous,y=-1,S;if(I&&(y=Vh(e.samples),!V&&this.config.forceKeyFrameOnDiscontinuity))if(f=!0,y>0){this.logger.warn(`[mp4-remuxer]: Dropped ${y} out of ${T} video samples due to a missing keyframe`);let x=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(y),e.dropped+=y,m+=(e.samples[0].pts-x)/e.inputTimeScale,S=m}else y===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${T} video samples`),f=!1);if(this.ISGenerated){if(L&&I){let x=this.getVideoStartPts(e.samples),F=(Wt(t.samples[0].pts,x)-x)/e.inputTimeScale;p+=Math.max(0,F),m+=Math.max(0,-F)}if(L){if(t.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(t,e,r,a)),c=this.remuxAudio(t,p,this.isAudioContiguous,a,b||I||l===W.AUDIO?m:void 0),I){let x=c?c.endPTS-c.startPTS:0;e.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(t,e,r,a)),u=this.remuxVideo(e,m,V,x)}}else I&&(u=this.remuxVideo(e,m,V,0));u&&(u.firstKeyFrame=y,u.independent=y!==-1,u.firstKeyFramePTS=S)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(A=yl(i,r,this._initPTS,this._initDTS)),s.samples.length&&(d=Tl(s,r,this._initPTS))),{audio:c,video:u,initSegment:h,independent:f,text:d,id3:A}}generateIS(t,e,i,s){let r=t.samples,a=e.samples,o=this.typeSupported,l={},u=this._initPTS,c=!u||s,h="audio/mp4",d,A,f;if(c&&(d=A=1/0),t.config&&r.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":o.mpeg?(h="audio/mpeg",t.codec=""):o.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3";break}l.audio={id:"audio",container:h,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):C.initSegment([t]),metadata:{channelCount:t.channelCount}},c&&(f=t.inputTimeScale,!u||f!==u.timescale?d=A=r[0].pts-Math.round(f*i):c=!1)}if(e.sps&&e.pps&&a.length){if(e.timescale=e.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:C.initSegment([e]),metadata:{width:e.width,height:e.height}},c)if(f=e.inputTimeScale,!u||f!==u.timescale){let p=this.getVideoStartPts(a),m=Math.round(f*i);A=Math.min(A,Wt(a[0].dts,p)-m),d=Math.min(d,p-m)}else c=!1;this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:d,timescale:f},this._initDTS={baseTime:A,timescale:f}):d=f=void 0,{tracks:l,initPTS:d,timescale:f}}remuxVideo(t,e,i,s){let r=t.inputTimeScale,a=t.samples,o=[],l=a.length,u=this._initPTS,c=this.nextAvcDts,h=8,d=this.videoSampleDuration,A,f,p=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,v=!1;if(!i||c===null){let _=e*r,B=a[0].pts-Wt(a[0].dts,a[0].pts);Ve&&c!==null&&Math.abs(_-B-c)<15e3?i=!0:c=_-B}let b=u.baseTime*r/u.timescale;for(let _=0;_<l;_++){let B=a[_];B.pts=Wt(B.pts-b,c),B.dts=Wt(B.dts-b,c),B.dts<a[_>0?_-1:_].dts&&(v=!0)}v&&a.sort(function(_,B){let X=_.dts-B.dts,H=_.pts-B.pts;return X||H}),A=a[0].dts,f=a[a.length-1].dts;let T=f-A,L=T?Math.round(T/(l-1)):d||t.inputTimeScale/30;if(i){let _=A-c,B=_>L,X=_<-1;if((B||X)&&(B?this.logger.warn(`${(t.segmentCodec||"").toUpperCase()}: ${ii(_,!0)} ms (${_}dts) hole between fragments detected at ${e.toFixed(3)}`):this.logger.warn(`${(t.segmentCodec||"").toUpperCase()}: ${ii(-_,!0)} ms (${_}dts) overlapping between fragments detected at ${e.toFixed(3)}`),!X||c>=a[0].pts||Ve)){A=c;let H=a[0].pts-_;if(B)a[0].dts=A,a[0].pts=H;else{let J=!0;for(let et=0;et<a.length&&!(a[et].dts>H&&J);et++){let st=a[et].pts;if(a[et].dts-=_,a[et].pts-=_,et<a.length-1){let nt=a[et+1].pts,Tt=a[et].pts,Lt=nt<=Tt,qt=nt<=st;J=Lt==qt}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${ii(H,!0)}/${ii(A,!0)}, delta: ${ii(_,!0)} ms`)}}A=Math.max(0,A);let I=0,k=0,R=A;for(let _=0;_<l;_++){let B=a[_],X=B.units,H=X.length,J=0;for(let et=0;et<H;et++)J+=X[et].data.length;k+=J,I+=H,B.length=J,B.dts<R?(B.dts=R,R+=L/4|0||1):R=B.dts,p=Math.min(B.pts,p),m=Math.max(B.pts,m)}f=a[l-1].dts;let D=k+4*I+8,O;try{O=new Uint8Array(D)}catch(_){this.observer.emit(g.ERROR,g.ERROR,{type:G.MUX_ERROR,details:w.REMUX_ALLOC_ERROR,fatal:!1,error:_,bytes:D,reason:`fail allocating video mdat ${D}`});return}let P=new DataView(O.buffer);P.setUint32(0,D),O.set(C.types.mdat,4);let V=!1,y=Number.POSITIVE_INFINITY,S=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(let _=0;_<l;_++){let B=a[_],X=B.units,H=0;for(let st=0,nt=X.length;st<nt;st++){let Tt=X[st],Lt=Tt.data,qt=Tt.data.byteLength;P.setUint32(h,qt),h+=4,O.set(Lt,h),h+=qt,H+=4+qt}let J;if(_<l-1)d=a[_+1].dts-B.dts,J=a[_+1].pts-B.pts;else{let st=this.config,nt=_>0?B.dts-a[_-1].dts:L;if(J=_>0?B.pts-a[_-1].pts:L,st.stretchShortVideoTrack&&this.nextAudioPts!==null){let Tt=Math.floor(st.maxBufferHole*r),Lt=(s?p+s*r:this.nextAudioPts)-B.pts;Lt>Tt?(d=Lt-nt,d<0?d=nt:V=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${Lt/90} ms to the next segment; using duration ${d/90} ms for the last video frame.`)):d=nt}else d=nt}let et=Math.round(B.pts-B.dts);y=Math.min(y,d),x=Math.max(x,d),S=Math.min(S,J),E=Math.max(E,J),o.push(ro(B.key,d,H,et))}if(o.length){if(Ve){if(Ve<70){let _=o[0].flags;_.dependsOn=2,_.isNonSync=0}}else if(or&&E-S<x-y&&L/x<.025&&o[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let _=A;for(let B=0,X=o.length;B<X;B++){let H=_+o[B].duration,J=_+o[B].cts;if(B<X-1){let et=H+o[B+1].cts;o[B].duration=et-J}else o[B].duration=B?o[B-1].duration:L;o[B].cts=0,_=H}}}d=V||!d?L:d,this.nextAvcDts=c=f+d,this.videoSampleDuration=d,this.isVideoContiguous=!0;let F=C.moof(t.sequenceNumber++,A,ct(t,{samples:o})),N="video",M={data1:F,data2:O,startPTS:p/r,endPTS:(m+d)/r,startDTS:A/r,endDTS:c/r,type:N,hasAudio:!1,hasVideo:!0,nb:o.length,dropped:t.dropped};return t.samples=[],t.dropped=0,M}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return Uh;case"ac3":return Bh;default:return Fh}}remuxAudio(t,e,i,s,r){let a=t.inputTimeScale,o=t.samplerate?t.samplerate:a,l=a/o,u=this.getSamplesPerFrame(t),c=u*l,h=this._initPTS,d=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,A=[],f=r!==void 0,p=t.samples,m=d?0:8,v=this.nextAudioPts||-1,b=e*a,T=h.baseTime*a/h.timescale;if(this.isAudioContiguous=i=i||p.length&&v>0&&(s&&Math.abs(b-v)<9e3||Math.abs(Wt(p[0].pts-T,b)-v)<20*c),p.forEach(function(F){F.pts=Wt(F.pts-T,b)}),!i||v<0){if(p=p.filter(F=>F.pts>=0),!p.length)return;r===0?v=0:s&&!f?v=Math.max(0,b):v=p[0].pts}if(t.segmentCodec==="aac"){let F=this.config.maxAudioFramesDrift;for(let N=0,M=v;N<p.length;N++){let _=p[N],B=_.pts,X=B-M,H=Math.abs(1e3*X/a);if(X<=-F*c&&f)N===0&&(this.logger.warn(`Audio frame @ ${(B/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*X/a)} ms.`),this.nextAudioPts=v=M=B);else if(X>=F*c&&H<Nh&&f){let J=Math.round(X/c);M=B-J*c,M<0&&(J--,M+=c),N===0&&(this.nextAudioPts=v=M),this.logger.warn(`[mp4-remuxer]: Injecting ${J} audio frame @ ${(M/a).toFixed(3)}s due to ${Math.round(1e3*X/a)} ms gap.`);for(let et=0;et<J;et++){let st=Math.max(M,0),nt=Wr.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);nt||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),nt=_.unit.subarray()),p.splice(N,0,{unit:nt,pts:st}),M+=c,N++}}_.pts=M,M+=c}}let L=null,I=null,k,R=0,D=p.length;for(;D--;)R+=p[D].unit.byteLength;for(let F=0,N=p.length;F<N;F++){let M=p[F],_=M.unit,B=M.pts;if(I!==null){let H=A[F-1];H.duration=Math.round((B-I)/l)}else if(i&&t.segmentCodec==="aac"&&(B=v),L=B,R>0){R+=m;try{k=new Uint8Array(R)}catch(H){this.observer.emit(g.ERROR,g.ERROR,{type:G.MUX_ERROR,details:w.REMUX_ALLOC_ERROR,fatal:!1,error:H,bytes:R,reason:`fail allocating audio mdat ${R}`});return}d||(new DataView(k.buffer).setUint32(0,R),k.set(C.types.mdat,4))}else return;k.set(_,m);let X=_.byteLength;m+=X,A.push(ro(!0,u,X,0)),I=B}let O=A.length;if(!O)return;let P=A[A.length-1];this.nextAudioPts=v=I+l*P.duration;let V=d?new Uint8Array(0):C.moof(t.sequenceNumber++,L/l,ct({},t,{samples:A}));t.samples=[];let y=L/a,S=v/a,E={data1:V,data2:k,startPTS:y,endPTS:S,startDTS:y,endDTS:S,type:"audio",hasAudio:!0,hasVideo:!1,nb:O};return this.isAudioContiguous=!0,E}};function Wt(n,t){let e;if(t===null)return n;for(t<n?e=-8589934592:e=8589934592;Math.abs(n-t)>4294967296;)n+=e;return n}function Vh(n){for(let t=0;t<n.length;t++)if(n[t].key)return t;return-1}function yl(n,t,e,i){let s=n.samples.length;if(!s)return;let r=n.inputTimeScale;for(let o=0;o<s;o++){let l=n.samples[o];l.pts=Wt(l.pts-e.baseTime*r/e.timescale,t*r)/r,l.dts=Wt(l.dts-i.baseTime*r/i.timescale,t*r)/r}let a=n.samples;return n.samples=[],{samples:a}}function Tl(n,t,e){let i=n.samples.length;if(!i)return;let s=n.inputTimeScale;for(let a=0;a<i;a++){let o=n.samples[a];o.pts=Wt(o.pts-e.baseTime*s/e.timescale,t*s)/s}n.samples.sort((a,o)=>a.pts-o.pts);let r=n.samples;return n.samples=[],{samples:r}}var Gr=class{constructor(t,e,i,s){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.logger=s}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,e,i,s){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(Gu(t,s)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:e,videoCodec:i}=this;if(!(t!=null&&t.byteLength)){this.initTracks=void 0,this.initData=void 0;return}let s=this.initData=ko(t);s.audio&&(e=no(s.audio,ut.AUDIO)),s.video&&(i=no(s.video,ut.VIDEO));let r={};s.audio&&s.video?r.audiovideo={container:"video/mp4",codec:e+","+i,supplemental:s.video.supplemental,initSegment:t,id:"main"}:s.audio?r.audio={container:"audio/mp4",codec:e,initSegment:t,id:"audio"}:s.video?r.video={container:"video/mp4",codec:i,supplemental:s.video.supplemental,initSegment:t,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=r}remux(t,e,i,s,r,a){var o,l;let{initPTS:u,lastEndTime:c}=this,h={audio:void 0,video:void 0,text:s,id3:i,initSegment:void 0};z(c)||(c=this.lastEndTime=r||0);let d=e.samples;if(!(d!=null&&d.length))return h;let A={initPTS:void 0,timescale:1},f=this.initData;if((o=f)!=null&&o.length||(this.generateInitSegment(d),f=this.initData),!((l=f)!=null&&l.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),h;this.emitInitSegment&&(A.tracks=this.initTracks,this.emitInitSegment=!1);let p=Xu(d,f),m=Hu(f,d),v=m===null?r:m;(a||!u)&&(zh(u,v,r,p)||A.timescale!==u.timescale)&&(A.initPTS=v-r,u&&u.timescale===1&&this.logger.warn(`Adjusting initPTS @${r} from ${u.baseTime/u.timescale} to ${A.initPTS}`),this.initPTS=u={baseTime:A.initPTS,timescale:1});let b=t?v-u.baseTime/u.timescale:c,T=b+p;ju(f,d,u.baseTime/u.timescale),p>0?this.lastEndTime=T:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());let L=!!f.audio,I=!!f.video,k="";L&&(k+="audio"),I&&(k+="video");let R={data1:d,startPTS:b,startDTS:b,endPTS:T,endDTS:T,type:k,hasAudio:L,hasVideo:I,nb:1,dropped:0};return h.audio=R.type==="audio"?R:void 0,h.video=R.type!=="audio"?R:void 0,h.initSegment=A,h.id3=yl(i,r,u,u),s.samples.length&&(h.text=Tl(s,r,u)),h}};function zh(n,t,e,i){if(n===null)return!0;let s=Math.max(i,1),r=t-n.baseTime/n.timescale;return Math.abs(r-e)>s}function no(n,t){let e=n==null?void 0:n.codec;return e&&e.length>4?e:t===ut.AUDIO?e==="ec-3"||e==="ac-3"||e==="alac"?e:e==="fLaC"||e==="Opus"?$i(e,!1):(it.warn(`Unhandled audio codec "${e}" in mp4 MAP`),e||"mp4a"):(it.warn(`Unhandled video codec "${e}" in mp4 MAP`),e||"avc1")}var he;try{he=self.performance.now.bind(self.performance)}catch(n){he=Date.now}var qi=[{demux:Ur,remux:Gr},{demux:re,remux:He},{demux:_r,remux:He},{demux:Fr,remux:He}];qi.splice(2,0,{demux:Nr,remux:He});var fs=class{constructor(t,e,i,s,r,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=i,this.id=r,this.logger=a}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,i,s){let r=i.transmuxing;r.executeStart=he();let a=new Uint8Array(t),{currentTransmuxState:o,transmuxConfig:l}=this;s&&(this.currentTransmuxState=s);let{contiguous:u,discontinuity:c,trackSwitch:h,accurateTimeOffset:d,timeOffset:A,initSegmentChange:f}=s||o,{audioCodec:p,videoCodec:m,defaultInitPts:v,duration:b,initSegmentData:T}=l,L=Wh(a,e);if(L&&Ge(L.method)){let D=this.getDecrypter(),O=Nn(L.method);if(D.isSync()){let P=D.softwareDecrypt(a,L.key.buffer,L.iv.buffer,O);if(i.part>-1){let y=D.flush();P=y&&y.buffer}if(!P)return r.executeEnd=he(),lr(i);a=new Uint8Array(P)}else return this.asyncResult=!0,this.decryptionPromise=D.webCryptoDecrypt(a,L.key.buffer,L.iv.buffer,O).then(P=>{let V=this.push(P,null,i);return this.decryptionPromise=null,V}),this.decryptionPromise}let I=this.needsProbing(c,h);if(I){let D=this.configureTransmuxer(a);if(D)return this.logger.warn(`[transmuxer] ${D.message}`),this.observer.emit(g.ERROR,g.ERROR,{type:G.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,error:D,reason:D.message}),r.executeEnd=he(),lr(i)}(c||h||f||I)&&this.resetInitSegment(T,p,m,b,e),(c||f||I)&&this.resetInitialTimestamp(v),u||this.resetContiguity();let k=this.transmux(a,L,A,d,i);this.asyncResult=mi(k);let R=this.currentTransmuxState;return R.contiguous=!0,R.discontinuity=!1,R.trackSwitch=!1,r.executeEnd=he(),k}flush(t){let e=t.transmuxing;e.executeStart=he();let{decrypter:i,currentTransmuxState:s,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(t));let a=[],{timeOffset:o}=s;if(i){let h=i.flush();h&&a.push(this.push(h.buffer,null,t))}let{demuxer:l,remuxer:u}=this;if(!l||!u){e.executeEnd=he();let h=[lr(t)];return this.asyncResult?Promise.resolve(h):h}let c=l.flush(o);return mi(c)?(this.asyncResult=!0,c.then(h=>(this.flushRemux(a,h,t),a))):(this.flushRemux(a,c,t),this.asyncResult?Promise.resolve(a):a)}flushRemux(t,e,i){let{audioTrack:s,videoTrack:r,id3Track:a,textTrack:o}=e,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===W.MAIN?"level":"track"} ${i.level}`);let c=this.remuxer.remux(s,r,a,o,u,l,!0,this.id);t.push({remuxResult:c,chunkMeta:i}),i.transmuxing.executeEnd=he()}resetInitialTimestamp(t){let{demuxer:e,remuxer:i}=this;!e||!i||(e.resetTimeStamp(t),i.resetTimeStamp(t))}resetContiguity(){let{demuxer:t,remuxer:e}=this;!t||!e||(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,i,s,r){let{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(t,e,i,s),o.resetInitSegment(t,e,i,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,i,s,r){let a;return e&&e.method==="SAMPLE-AES"?a=this.transmuxSampleAes(t,e,i,s,r):a=this.transmuxUnencrypted(t,i,s,r),a}transmuxUnencrypted(t,e,i,s){let{audioTrack:r,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,a,o,l,e,i,!1,this.id),chunkMeta:s}}transmuxSampleAes(t,e,i,s,r){return this.demuxer.demuxSampleAes(t,e,i).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,i,s,!1,this.id),chunkMeta:r}))}configureTransmuxer(t){let{config:e,observer:i,typeSupported:s}=this,r;for(let h=0,d=qi.length;h<d;h++){var a;if((a=qi[h].demux)!=null&&a.probe(t,this.logger)){r=qi[h];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");let o=this.demuxer,l=this.remuxer,u=r.remux,c=r.demux;(!l||!(l instanceof u))&&(this.remuxer=new u(i,e,s,this.logger)),(!o||!(o instanceof c))&&(this.demuxer=new c(i,e,s,this.logger),this.probe=c.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new hi(this.config)),t}};function Wh(n,t){let e=null;return n.byteLength>0&&(t==null?void 0:t.key)!=null&&t.iv!==null&&t.method!=null&&(e=t),e}var lr=n=>({remuxResult:{},chunkMeta:n});function mi(n){return"then"in n&&n.then instanceof Function}var Hr=class{constructor(t,e,i,s,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=i,this.duration=s,this.defaultInitPts=r||null}},Xr=class{constructor(t,e,i,s,r,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=i,this.trackSwitch=s,this.timeOffset=r,this.initSegmentChange=a}},ao=0,gs=class{constructor(t,e,i,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=ao++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{let u=l.data,c=this.hls;if(!(!c||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var h;let d=(h=this.workerContext)==null?void 0:h.objectURL;d&&self.URL.revokeObjectURL(d);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{c.logger[u.data.logType]&&c.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,c.trigger(u.event,u.data);break}}},this.onWorkerError=l=>{if(!this.hls)return;let u=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};let r=t.config;this.hls=t,this.id=e,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=i,this.onFlush=s;let a=(l,u)=>{u=u||{},u.frag=this.frag||void 0,l===g.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(l,u)};this.observer=new Un,this.observer.on(g.FRAG_DECRYPTED,a),this.observer.on(g.ERROR,a);let o=Ia(r.preferManagedMediaSource);if(this.useWorker&&typeof Worker!="undefined"){let l=this.hls.logger;if(r.workerPath||th()){try{r.workerPath?(l.log(`loading Web Worker ${r.workerPath} for "${e}"`),this.workerContext=ih(r.workerPath)):(l.log(`injecting Web Worker for "${e}"`),this.workerContext=eh());let{worker:c}=this.workerContext;c.addEventListener("message",this.onWorkerMessage),c.addEventListener("error",this.onWorkerError),c.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:o,id:e,config:ft(r)})}catch(c){l.warn(`Error setting up "${e}" Web Worker, fallback to inline`,c),this.terminateWorker(),this.error=null,this.transmuxer=new fs(this.observer,o,r,"",e,t.logger)}return}}this.transmuxer=new fs(this.observer,o,r,"",e,t.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){let t=this.instanceNo;this.instanceNo=ao++;let e=this.hls.config,i=Ia(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:i,id:this.id,config:ft(e)})}}terminateWorker(){if(this.workerContext){let{worker:t}=this.workerContext;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),sh(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{let e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}let t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(t,e,i,s,r,a,o,l,u,c){var h,d;u.transmuxing.start=self.performance.now();let{instanceNo:A,transmuxer:f}=this,p=a?a.start:r.start,m=r.decryptdata,v=this.frag,b=!(v&&r.cc===v.cc),T=!(v&&u.level===v.level),L=v?u.sn-v.sn:-1,I=this.part?u.part-this.part.index:-1,k=L===0&&u.id>1&&u.id===(v==null?void 0:v.stats.chunkCount),R=!T&&(L===1||L===0&&(I===1||k&&I<=0)),D=self.performance.now();(T||L||r.stats.parsing.start===0)&&(r.stats.parsing.start=D),a&&(I||!R)&&(a.stats.parsing.start=D);let O=!(v&&((h=r.initSegment)==null?void 0:h.url)===((d=v.initSegment)==null?void 0:d.url)),P=new Xr(b,R,l,T,p,O);if(!R||b||O){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===W.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${b}
        trackSwitch: ${T}
        contiguous: ${R}
        accurateTimeOffset: ${l}
        timeOffset: ${p}
        initSegmentChange: ${O}`);let V=new Hr(i,s,e,o,c);this.configureTransmuxer(V)}if(this.frag=r,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:A,cmd:"demux",data:t,decryptdata:m,chunkMeta:u,state:P},t instanceof ArrayBuffer?[t]:[]);else if(f){let V=f.push(t,m,u,P);mi(V)?V.then(y=>{this.handleTransmuxComplete(y)}).catch(y=>{this.transmuxerError(y,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(V)}}flush(t){t.transmuxing.start=self.performance.now();let{instanceNo:e,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:e,cmd:"flush",chunkMeta:t});else if(i){let s=i.flush(t);mi(s)?s.then(r=>{this.handleFlushResult(r,t)}).catch(r=>{this.transmuxerError(r,t,"transmuxer-interface flush error")}):this.handleFlushResult(s,t)}}transmuxerError(t,e,i){!this.hls||(this.error=t,this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:i}))}handleFlushResult(t,e){t.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(e)}configureTransmuxer(t){let{instanceNo:e,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):i&&i.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}},oo=100,qr=class extends Ai{constructor(t,e,i){super(t,e,i,"audio-stream-controller",W.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();let{hls:t}=this;t.on(g.LEVEL_LOADED,this.onLevelLoaded,this),t.on(g.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(g.BUFFER_RESET,this.onBufferReset,this),t.on(g.BUFFER_CREATED,this.onBufferCreated,this),t.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(g.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(g.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(g.FRAG_LOADING,this.onFragLoading,this),t.on(g.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){let{hls:t}=this;!t||(super.unregisterListeners(),t.off(g.LEVEL_LOADED,this.onLevelLoaded,this),t.off(g.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(g.BUFFER_RESET,this.onBufferReset,this),t.off(g.BUFFER_CREATED,this.onBufferCreated,this),t.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(g.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(g.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(g.FRAG_LOADING,this.onFragLoading,this),t.off(g.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(t,{frag:e,id:i,initPTS:s,timescale:r}){if(i===W.MAIN){let a=e.cc,o=this.fragCurrent;if(this.initPTS[a]={baseTime:s,timescale:r},this.log(`InitPTS for cc: ${a} found from main: ${s}/${r}`),this.mainAnchor=e,this.state===U.WAITING_INIT_PTS){let l=this.waitingData;(!l&&!this.loadingParts||l&&l.frag.cc!==a)&&(this.nextLoadPosition=this.findSyncFrag(e).start),this.tick()}else!this.hls.hasEnoughToStart&&o&&o.cc!==a?(this.startFragRequested=!1,this.nextLoadPosition=this.findSyncFrag(e).start,o.abortRequests(),this.resetLoadingState()):this.state===U.IDLE&&this.tick()}}findSyncFrag(t){let e=this.getLevelDetails(),i=t.cc;return bc(e,i,t)||e&&Ho(e.fragments,i)||t}startLoad(t,e){if(!this.levels){this.startPosition=t,this.state=U.STOPPED;return}let i=this.lastCurrentTime;this.stopLoad(),this.setInterval(oo),i>0&&t===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i,this.state=U.IDLE):this.state=U.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}doTick(){switch(this.state){case U.IDLE:this.doTickIdle();break;case U.WAITING_TRACK:{let{levels:e,trackId:i}=this,s=e==null?void 0:e[i],r=s==null?void 0:s.details;if(r&&!this.waitForLive(s)){if(this.waitForCdnTuneIn(r))break;this.state=U.WAITING_INIT_PTS}break}case U.FRAG_LOADING_WAITING_RETRY:{var t;let e=performance.now(),i=this.retryDate;if(!i||e>=i||(t=this.media)!=null&&t.seeking){let{levels:s,trackId:r}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((s==null?void 0:s[r])||null),this.state=U.IDLE}break}case U.WAITING_INIT_PTS:{let e=this.waitingData;if(e){let{frag:i,part:s,cache:r,complete:a}=e,o=this.mainAnchor;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.state=U.FRAG_LOADING;let l=r.flush().buffer,u={frag:i,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),a&&super._handleFragmentLoadComplete(u)}else o&&o.cc!==e.frag.cc&&(this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${o.cc}`),this.nextLoadPosition=this.findSyncFrag(o).start,this.clearWaitingFragment())}else this.state=U.IDLE}}this.onTickEnd()}clearWaitingFragment(){let t=this.waitingData;t&&(this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.state!==U.STOPPED&&(this.state=U.IDLE))}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){let{media:t}=this;!(t!=null&&t.readyState)||(this.lastCurrentTime=t.currentTime)}doTickIdle(){var t;let{hls:e,levels:i,media:s,trackId:r}=this,a=e.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(i!=null&&i[r]))return;let o=i[r],l=o.details;if(!l||this.waitForLive(o)||this.waitForCdnTuneIn(l)){this.state=U.WAITING_TRACK,this.startFragRequested=!1;return}let u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,ut.AUDIO,W.AUDIO));let c=this.getFwdBufferInfo(u,W.AUDIO);if(c===null)return;if(!this.switchingTrack&&this._streamEnded(c,l)){e.trigger(g.BUFFER_EOS,{type:"audio"}),this.state=U.ENDED;return}let h=c.len,d=e.maxBufferLength,A=l.fragments,f=A[0].start,p=this.getLoadPosition(),m=this.flushing?p:c.end;if(this.switchingTrack&&s){let T=p;l.PTSKnown&&T<f&&(c.end>f||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=f+.05)}if(h>=d&&!this.switchingTrack&&m<A[A.length-1].start)return;let v=this.getNextFragment(m,l);if(v&&this.isLoopLoading(v,m)&&(v=this.getNextFragmentLoopLoading(v,l,c,W.MAIN,d)),!v){this.bufferFlushed=!0;return}let b=((t=this.mainFragLoading)==null?void 0:t.frag)||null;if(!this.audioOnly&&this.startFragRequested&&b&&xt(v)&&!v.endList&&(!l.live||!this.loadingParts&&m<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(b)===yt.OK&&(this.mainFragLoading=b=null),b&&xt(b))){if(v.start>b.end){let L=this.fragmentTracker.getFragAtPos(m,W.MAIN);L&&L.end>b.end&&(b=L,this.mainFragLoading={frag:L,targetBufferTime:null})}if(v.start>b.end)return}this.loadFragment(v,o,m)}onMediaDetaching(t,e){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(t,e)}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map(i=>new De(i))}onAudioTrackSwitching(t,e){let i=!!e.url;this.trackId=e.id;let{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),i?(this.switchingTrack=e,this.flushAudioIfNeeded(e),this.state!==U.STOPPED&&(this.setInterval(oo),this.state=U.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=e,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(t,e){this.mainDetails=e.details;let i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(g.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(t,e){var i;let{levels:s}=this,{details:r,id:a,groupId:o,track:l}=e;if(!s){this.warn(`Audio tracks reset while loading track ${a} "${l.name}" of "${o}"`);return}let u=this.mainDetails;if(!u||r.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=e,this.state!==U.STOPPED&&(this.state=U.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${l.name}" of "${o}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);let c=s[a],h=0;if(r.live||(i=c.details)!=null&&i.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;if(c.details){var d;h=this.alignPlaylists(r,c.details,(d=this.levelLastLoaded)==null?void 0:d.details)}r.alignedSliding||(il(r,u),r.alignedSliding||ls(r,u),h=r.fragmentStart)}c.details=r,this.levelLastLoaded=c,this.startFragRequested||this.setStartPosition(u,h),this.hls.trigger(g.AUDIO_TRACK_UPDATED,{details:r,id:a,groupId:e.groupId}),this.state===U.WAITING_TRACK&&!this.waitForCdnTuneIn(r)&&(this.state=U.IDLE),this.tick()}_handleFragmentLoadProgress(t){var e;let i=t.frag,{part:s,payload:r}=t,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}let u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}let c=u.details;if(!c){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}let h=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2",d=this.transmuxer;d||(d=this.transmuxer=new gs(this.hls,W.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));let A=this.initPTS[i.cc],f=(e=i.initSegment)==null?void 0:e.data;if(A!==void 0){let m=s?s.index:-1,v=m!==-1,b=new di(i.level,i.sn,i.stats.chunkCount,r.byteLength,m,v);d.push(r,f,h,"",i,s,c.totalduration,!1,b,A)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${c.startSN} ,${c.endSN}],track ${o}`);let{cache:p}=this.waitingData=this.waitingData||{frag:i,part:s,cache:new us,complete:!1};p.push(new Uint8Array(r)),this.state!==U.STOPPED&&(this.state=U.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(t){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(t,e){this.bufferFlushed=this.flushing=!1;let i=e.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(t,e){!this.audioOnly&&e.frag.type===W.MAIN&&xt(e.frag)&&(this.mainFragLoading=e,this.state===U.IDLE&&this.tick())}onFragBuffered(t,e){let{frag:i,part:s}=e;if(i.type!==W.AUDIO){!this.audioOnly&&i.type===W.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(xt(i)){this.fragPrevious=i;let r=this.switchingTrack;r&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger(g.AUDIO_TRACK_SWITCHED,at({},r)))}this.fragBufferedComplete(i,s),this.media&&this.tick()}onError(t,e){var i;if(e.fatal){this.state=U.ERROR;return}switch(e.details){case w.FRAG_GAP:case w.FRAG_PARSING_ERROR:case w.FRAG_DECRYPT_ERROR:case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(W.AUDIO,e);break;case w.AUDIO_TRACK_LOAD_ERROR:case w.AUDIO_TRACK_LOAD_TIMEOUT:case w.LEVEL_PARSING_ERROR:!e.levelRetry&&this.state===U.WAITING_TRACK&&((i=e.context)==null?void 0:i.type)===tt.AUDIO_TRACK&&(this.state=U.IDLE);break;case w.BUFFER_ADD_CODEC_ERROR:case w.BUFFER_APPEND_ERROR:if(e.parent!=="audio")return;this.resetLoadingState();break;case w.BUFFER_FULL_ERROR:if(e.parent!=="audio")return;this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case w.INTERNAL_EXCEPTION:this.recoverWorkerError(e);break}}onBufferFlushing(t,{type:e}){e!==ut.VIDEO&&(this.flushing=!0)}onBufferFlushed(t,{type:e}){if(e!==ut.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===U.ENDED&&(this.state=U.IDLE);let i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,e,W.AUDIO),this.tick())}}_handleTransmuxComplete(t){var e;let i="audio",{hls:s}=this,{remuxResult:r,chunkMeta:a}=t,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}let{frag:l,part:u,level:c}=o,{details:h}=c,{audio:d,text:A,id3:f,initSegment:p}=r;if(this.fragContextChanged(l)||!h){this.fragmentTracker.removeFragment(l);return}if(this.state=U.PARSING,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),p!=null&&p.tracks){let m=l.initSegment||l;this._bufferInitSegment(c,p.tracks,m,a),s.trigger(g.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:i,tracks:p.tracks})}if(d){let{startPTS:m,endPTS:v,startDTS:b,endDTS:T}=d;u&&(u.elementaryStreams[ut.AUDIO]={startPTS:m,endPTS:v,startDTS:b,endDTS:T}),l.setElementaryStreamInfo(ut.AUDIO,m,v,b,T),this.bufferFragmentData(d,l,u,a)}if(f!=null&&(e=f.samples)!=null&&e.length){let m=ct({id:i,frag:l,details:h},f);s.trigger(g.FRAG_PARSING_METADATA,m)}if(A){let m=ct({id:i,frag:l,details:h},A);s.trigger(g.FRAG_PARSING_USERDATA,m)}}_bufferInitSegment(t,e,i,s){if(this.state!==U.PARSING||(e.video&&delete e.video,e.audiovideo&&delete e.audiovideo,!e.audio))return;let r=e.audio;r.id=W.AUDIO;let a=t.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${a}/${r.codec}]`),a&&a.split(",").length===1&&(r.levelCodec=a),this.hls.trigger(g.BUFFER_CODECS,e);let o=r.initSegment;if(o!=null&&o.byteLength){let l={type:"audio",frag:i,part:null,chunkMeta:s,parent:i.type,data:o};this.hls.trigger(g.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(t,e,i){let s=this.fragmentTracker.getState(t);if(this.switchingTrack||s===yt.NOT_LOADED||s===yt.PARTIAL){var r;if(!xt(t))this._loadInitSegment(t,e);else if((r=e.details)!=null&&r.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=U.WAITING_INIT_PTS;let a=this.mainDetails;a&&a.fragmentStart!==e.details.fragmentStart&&ls(e.details,a)}else super.loadFragment(t,e,i)}else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){let{name:e,lang:i,assocLang:s,characteristics:r,audioCodec:a,channels:o}=this.bufferedTrack;Pe({name:e,lang:i,assocLang:s,characteristics:r,audioCodec:a,channels:o},t,Re)||(is(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}}completeAudioSwitch(t){let{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(g.AUDIO_TRACK_SWITCHED,at({},t))}},vi=class extends Qt{constructor(t,e){super(e,t.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,i){let s=e==null?void 0:e.renditionReports;if(s){let r=-1;for(let a=0;a<s.length;a++){let o=s[a],l;try{l=new self.URL(o.URI,e.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),l=o.URI||""}if(l===t){r=a;break}else l===t.substring(0,l.length)&&(r=a)}if(r!==-1){let a=s[r],o=parseInt(a["LAST-MSN"])||(e==null?void 0:e.lastPartSn),l=parseInt(a["LAST-PART"])||(e==null?void 0:e.lastPartIndex);if(this.hls.config.lowLatencyMode){let c=Math.min(e.age-e.partTarget,e.targetduration);l>=0&&c>e.partTarget&&(l+=1)}let u=i&&Pa(i);return new es(o,l>=0?l:void 0,u)}}}loadPlaylist(t){this.clearTimer()}loadingPlaylist(t,e){this.clearTimer()}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}getUrlWithDirectives(t,e){if(e)try{return e.addDirectives(t)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return t}playlistLoaded(t,e,i){let{details:s,stats:r}=e,a=self.performance.now(),o=r.loading.first?Math.max(0,a-r.loading.first):0;s.advancedDateTime=Date.now()-o;let l=this.hls.config.timelineOffset;if(l!==s.appliedTimelineOffset){let c=Math.max(l||0,0);s.appliedTimelineOffset=c,s.fragments.forEach(h=>{h.start=h.playlistOffset+c})}if(s.live||i!=null&&i.live){let c="levelInfo"in e?e.levelInfo:e.track;if(s.reloaded(i),i&&s.fragments.length>0){Hc(i,s);let b=s.playlistParsingError;if(b){this.warn(b);let T=this.hls;if(!T.config.ignorePlaylistParsingErrors){var u;let{networkDetails:L}=e;T.trigger(g.ERROR,{type:G.NETWORK_ERROR,details:w.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:b,reason:b.message,level:e.level||void 0,parent:(u=s.fragments[0])==null?void 0:u.type,networkDetails:L,stats:r});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=r.loading.start);let h=this.hls.mainForwardBufferInfo,d=h?h.end-h.len:0,A=(s.edge-d)*1e3,f=Qo(s,A);if(s.requestScheduled+f<a?s.requestScheduled=a:s.requestScheduled+=f,this.log(`live playlist ${t} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let p,m,v;if(s.canBlockReload&&s.endSN&&s.advanced){let b=this.hls.config.lowLatencyMode,T=s.lastPartSn,L=s.endSN,I=s.lastPartIndex,k=I!==-1,R=T===L;k?R?(m=L+1,v=b?0:I):(m=T,v=b?I+1:s.maxPartIndex):m=L+1;let D=s.age,O=D+s.ageHeader,P=Math.min(O-s.partTarget,s.targetduration*1.5);if(P>0){if(O>s.targetduration*3)this.log(`Playlist last advanced ${D.toFixed(2)}s ago. Omitting segment and part directives.`),m=void 0,v=void 0;else if(i!=null&&i.tuneInGoal&&O-s.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${P} with playlist age: ${s.age}`),P=0;else{let V=Math.floor(P/s.targetduration);if(m+=V,v!==void 0){let y=Math.round(P%s.targetduration/s.partTarget);v+=y}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${D.toFixed(2)}s goal: ${P} skip sn ${V} to part ${v}`)}s.tuneInGoal=P}if(p=this.getDeliveryDirectives(s,e.deliveryDirectives,m,v),b||!R){s.requestScheduled=a,this.loadingPlaylist(c,p);return}}else(s.canBlockReload||s.canSkipUntil)&&(p=this.getDeliveryDirectives(s,e.deliveryDirectives,m,v));p&&m!==void 0&&s.canBlockReload&&(s.requestScheduled=r.loading.first+Math.max(f-o*2,f/2)),this.scheduleLoading(c,p,s)}else this.clearTimer()}scheduleLoading(t,e,i){let s=i||t.details;if(!s){this.loadingPlaylist(t,e);return}let r=self.performance.now(),a=s.requestScheduled;if(r>=a){this.loadingPlaylist(t,e);return}let o=a-r;this.log(`reload live playlist ${t.name||t.bitrate+"bps"} in ${Math.round(o)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(t,e),o)}getDeliveryDirectives(t,e,i,s){let r=Pa(t);return e!=null&&e.skip&&t.deltaUpdateFailed&&(i=e.msn,s=e.part,r=Xi.No),new es(i,s,r)}checkRetry(t){let e=t.details,i=ss(t),s=t.errorAction,{action:r,retryCount:a=0,retryConfig:o}=s||{},l=!!s&&!!o&&(r===Rt.RetryRequest||!s.resolved&&r===Rt.SendAlternateToPenaltyBox);if(l){var u;if(a>=o.maxNumRetry)return!1;if(i&&(u=t.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist();else{let c=_n(o,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${e}" in ${c}ms`)}t.levelRetry=!0,s.resolved=!0}return l}};function bl(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!yi(n[e].attrs,t[e].attrs))return!1;return!0}function yi(n,t,e){let i=n["STABLE-RENDITION-ID"];return i&&!e?i===t["STABLE-RENDITION-ID"]:!(e||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>n[s]!==t[s])}function jr(n,t){return t.label.toLowerCase()===n.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(n.lang||"").toLowerCase())}var Kr=class extends vi{constructor(t){super(t,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){let{hls:t}=this;t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.MANIFEST_PARSED,this.onManifestParsed,this),t.on(g.LEVEL_LOADING,this.onLevelLoading,this),t.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(g.ERROR,this.onError,this)}unregisterListeners(){let{hls:t}=this;t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.MANIFEST_PARSED,this.onManifestParsed,this),t.off(g.LEVEL_LOADING,this.onLevelLoading,this),t.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(g.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){let{id:i,groupId:s,details:r}=e,a=this.tracksInGroup[i];if(!a||a.groupId!==s){this.warn(`Audio track with id:${i} and group:${s} not found in active group ${a==null?void 0:a.groupId}`);return}let o=a.details;a.details=e.details,this.log(`Audio track ${i} "${a.name}" lang:${a.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,o)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){let e=this.hls.levels[t];if(!e)return;let i=e.audioGroups||null,s=this.groupIds,r=this.currentTrack;if(!i||(s==null?void 0:s.length)!==(i==null?void 0:i.length)||i!=null&&i.some(o=>(s==null?void 0:s.indexOf(o))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;let o=this.tracks.filter(d=>!i||i.indexOf(d.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(d=>d.default)&&(this.selectDefaultTrack=!1),o.forEach((d,A)=>{d.id=A});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=o;let l=this.hls.config.audioPreference;if(!r&&l){let d=ne(l,o,Re);if(d>-1)r=o[d];else{let A=ne(l,this.tracks);r=this.tracks[A]}}let u=this.findTrackId(r);u===-1&&r&&(u=this.findTrackId(null));let c={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${i==null?void 0:i.join(",")}`),this.hls.trigger(g.AUDIO_TRACKS_UPDATED,c);let h=this.trackId;if(u!==-1&&h===-1)this.setAudioTrack(u);else if(o.length&&h===-1){var a;let d=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(d.message),this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:d})}}}onError(t,e){e.fatal||!e.context||e.context.type===tt.AUDIO_TRACK&&e.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(e.context.groupId)!==-1)&&this.checkRetry(e)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){let e=this.hls;if(e.config.audioPreference=t,t){let i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){let s=this.currentTrack;if(s&&Pe(t,s,Re))return s;let r=ne(t,this.tracksInGroup,Re);if(r>-1){let a=this.tracksInGroup[r];return this.setAudioTrack(r),a}else if(s){let a=e.loadLevel;a===-1&&(a=e.firstAutoLevel);let o=mc(t,e.levels,i,a,Re);if(o===-1)return null;e.nextLoadLevel=o}if(t.channels||t.audioCodec){let a=ne(t,i);if(a>-1)return i[a]}}}return null}setAudioTrack(t){let e=this.tracksInGroup;if(t<0||t>=e.length){this.warn(`Invalid audio track id: ${t}`);return}this.selectDefaultTrack=!1;let i=this.currentTrack,s=e[t],r=s.details&&!s.details.live;if(t===this.trackId&&s===i&&r||(this.log(`Switching to audio-track ${t} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=t,this.currentTrack=s,this.hls.trigger(g.AUDIO_TRACK_SWITCHING,at({},s)),r))return;let a=this.switchParams(s.url,i==null?void 0:i.details,s.details);this.loadPlaylist(a)}findTrackId(t){let e=this.tracksInGroup;for(let i=0;i<e.length;i++){let s=e[i];if(!(this.selectDefaultTrack&&!s.default)&&(!t||Pe(t,s,Re)))return i}if(t){let{name:i,lang:s,assocLang:r,characteristics:a,audioCodec:o,channels:l}=t;for(let u=0;u<e.length;u++){let c=e[u];if(Pe({name:i,lang:s,assocLang:r,characteristics:a,audioCodec:o,channels:l},c,Re))return u}for(let u=0;u<e.length;u++){let c=e[u];if(yi(t.attrs,c.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<e.length;u++){let c=e[u];if(yi(t.attrs,c.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(t){super.loadPlaylist();let e=this.currentTrack;!this.shouldLoadPlaylist(e)||is(e.url,this.hls)&&this.scheduleLoading(e,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);let i=t.id,s=t.groupId,r=this.getUrlWithDirectives(t.url,e),a=t.details,o=a==null?void 0:a.age;this.log(`Loading audio-track ${i} "${t.name}" lang:${t.lang} group:${s}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(g.AUDIO_TRACK_LOADING,{url:r,id:i,groupId:s,deliveryDirectives:e||null,track:t})}},Zr=class{constructor(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}destroy(){this.tracks=this.queues=null}append(t,e,i){if(this.queues===null||this.tracks===null)return;let s=this.queues[e];s.push(t),s.length===1&&!i&&this.executeNext(e)}appendBlocker(t){return new Promise(e=>{let i={label:"async-blocker",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,t)})}prependBlocker(t){return new Promise(e=>{if(this.queues){let i={label:"async-blocker-prepend",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[t].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(t=>{var e;let i=(e=t[0])==null?void 0:e.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(t[0].execute(),t.splice(0,1))})}unblockAudio(t){if(this.queues===null)return;this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")}executeNext(t){if(this.queues===null||this.tracks===null)return;let e=this.queues[t];if(e.length){let s=e[0];try{s.execute()}catch(r){var i;if(s.onError(r),this.queues===null||this.tracks===null)return;let a=(i=this.tracks[t])==null?void 0:i.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){this.queues!==null&&(this.queues[t].shift(),this.executeNext(t))}current(t){var e;return((e=this.queues)==null?void 0:e[t][0])||null}toString(){let{queues:t,tracks:e}=this;return t===null||e===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(t){var e,i;return(e=this.queues)!=null&&e[t]||(i=this.tracks)!=null&&i[t]?`${t}: (${this.listSbInfo(t)}) ${this.listOps(t)}`:""}listSbInfo(t){var e;let i=(e=this.tracks)==null?void 0:e[t],s=i==null?void 0:i.buffer;return s?`SourceBuffer${s.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(t){var e;return((e=this.queues)==null?void 0:e[t].map(i=>i.label).join(", "))||""}},lo=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,El="HlsJsTrackRemovedError",Yr=class extends Error{constructor(t){super(t),this.name=El}},Qr=class extends Qt{constructor(t,e){super("buffer-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var s;!this.hls||((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{!this.hls||this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{let{media:s,mediaSource:r}=this;i&&this.log("Media source opened"),!(!s||!r)&&(r.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(g.MEDIA_ATTACHED,{media:s,mediaSource:r}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{let{mediaSrc:i,_objectUrl:s}=this;i!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${i})`)},this.hls=t,this.fragmentTracker=e,this.appendSource=_u(ye(t.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){let{hls:t}=this;t.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.MANIFEST_PARSED,this.onManifestParsed,this),t.on(g.BUFFER_RESET,this.onBufferReset,this),t.on(g.BUFFER_APPENDING,this.onBufferAppending,this),t.on(g.BUFFER_CODECS,this.onBufferCodecs,this),t.on(g.BUFFER_EOS,this.onBufferEos,this),t.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(g.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(g.FRAG_PARSED,this.onFragParsed,this),t.on(g.FRAG_CHANGED,this.onFragChanged,this),t.on(g.ERROR,this.onError,this)}unregisterListeners(){let{hls:t}=this;t.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.MANIFEST_PARSED,this.onManifestParsed,this),t.off(g.BUFFER_RESET,this.onBufferReset,this),t.off(g.BUFFER_APPENDING,this.onBufferAppending,this),t.off(g.BUFFER_CODECS,this.onBufferCodecs,this),t.off(g.BUFFER_EOS,this.onBufferEos,this),t.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(g.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(g.FRAG_PARSED,this.onFragParsed,this),t.off(g.FRAG_CHANGED,this.onFragChanged,this),t.off(g.ERROR,this.onError,this)}transferMedia(){let{media:t,mediaSource:e}=this;if(!t)return null;let i={};if(this.operationQueue){let r=this.isUpdating();r||this.operationQueue.removeBlockers();let a=this.isQueued();(r||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${r?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}let s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===e?ct(i,s.tracks):this.sourceBuffers.forEach(r=>{let[a]=r;a&&(i[a]=ct({},this.tracks[a]),this.removeBuffer(a)),r[0]=r[1]=null}),{media:t,mediaSource:e,tracks:i}}initTracks(){let t={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=t,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){var i;let s=2;(e.audio&&!e.video||!e.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(t,e){let i=this.media=e.media,s=ye(this.appendSource);if(this.transferData=this.overrides=void 0,i&&s){let r=!!e.mediaSource;(r||e.overrides)&&(this.transferData=e,this.overrides=e.overrides);let a=this.mediaSource=e.mediaSource||new s;if(this.assignMediaSource(a),r)this._objectUrl=i.src,this.attachTransferred();else{let o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{i.removeAttribute("src");let l=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||l&&a instanceof l,uo(i),Gh(i,o),i.load()}catch(l){i.src=o}else i.src=o}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(t){var e,i;this.log(`${((e=this.transferData)==null?void 0:e.mediaSource)===t?"transferred":"created"} media source: ${(i=t.constructor)==null?void 0:i.name}`),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){let t=this.media,e=this.transferData;if(!e||!t)return;let i=this.tracks,s=e.tracks,r=s?Object.keys(s):null,a=r?r.length:0,o=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(s&&r&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${ft(i,(l,u)=>l==="initSegment"?void 0:u)};
transfer tracks: ${ft(s,(l,u)=>l==="initSegment"?void 0:u)}}`),!Po(s,i)){e.mediaSource=null,e.tracks=void 0;let l=t.currentTime,u=this.details,c=Math.max(l,(u==null?void 0:u.fragments[0].start)||0);if(c-l>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${c}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(i)}") start time: ${c} currentTime: ${l}`),this.onMediaDetaching(g.MEDIA_DETACHING,{}),this.onMediaAttaching(g.MEDIA_ATTACHING,e),t.currentTime=c;return}this.transferData=void 0,r.forEach(l=>{let u=l,c=s[u];if(c){let h=c.buffer;if(h){let d=this.fragmentTracker,A=c.id;if(d.hasFragments(A)||d.hasParts(A)){let m=Q.getBuffered(h);d.detectEvictedFragments(u,m,A,null,!0)}let f=ur(u),p=[u,h];this.sourceBuffers[f]=p,h.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,c)}}}),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}get mediaSourceOpenOrEnded(){var t;let e=(t=this.mediaSource)==null?void 0:t.readyState;return e==="open"||e==="ended"}onMediaDetaching(t,e){let i=!!e.transferMedia;this.transferData=this.overrides=void 0;let{media:s,mediaSource:r,_objectUrl:a}=this;if(r){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([o])=>{o&&this.removeBuffer(o)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){let o=r.readyState==="open";try{let l=r.sourceBuffers;for(let u=l.length;u--;)o&&l[u].abort(),r.removeSourceBuffer(l[u]);o&&r.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),i||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(s.removeAttribute("src"),this.appendSource&&uo(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(g.MEDIA_DETACHED,e)}onBufferReset(){this.sourceBuffers.forEach(([t])=>{t&&this.resetBuffer(t)}),this.initTracks()}resetBuffer(t){var e;let i=(e=this.tracks[t])==null?void 0:e.buffer;if(this.removeBuffer(t),i)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(r){this.warn(`onBufferReset ${t}`,r)}delete this.tracks[t]}removeBuffer(t){this.removeBufferListeners(t),this.sourceBuffers[ur(t)]=[null,null];let e=this.tracks[t];e&&(e.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Zr(this.tracks)}onBufferCodecs(t,e){let i=this.tracks,s=Object.keys(e);this.log(`BUFFER_CODECS: "${s}" (current SB count ${this.sourceBufferCount})`);let r="audiovideo"in e&&(i.audio||i.video)||i.audiovideo&&("audio"in e||"video"in e),a=!r&&this.sourceBufferCount&&this.media&&s.some(o=>!i[o]);if(r||a){this.warn(`Unsupported transition between "${Object.keys(i)}" and "${s}" SourceBuffers`);return}s.forEach(o=>{var l,u,c;let h=e[o],{id:d,codec:A,levelCodec:f,container:p,metadata:m,supplemental:v}=h,b=i[o],T=(l=this.transferData)==null||(u=l.tracks)==null?void 0:u[o],L=T!=null&&T.buffer?T:b,I=(L==null?void 0:L.pendingCodec)||(L==null?void 0:L.codec),k=L==null?void 0:L.levelCodec;b||(b=i[o]={buffer:void 0,listeners:[],codec:A,supplemental:v,container:p,levelCodec:f,metadata:m,id:d});let R=Hi(I,k),D=R==null?void 0:R.replace(lo,"$1"),O=Hi(A,f),P=(c=O)==null?void 0:c.replace(lo,"$1");O&&R&&D!==P&&(o.slice(0,5)==="audio"&&(O=$i(O,this.appendSource)),this.log(`switching codec ${I} to ${O}`),O!==(b.pendingCodec||b.codec)&&(b.pendingCodec=O),b.container=p,this.appendChangeType(o,p,O))}),(this.tracksReady||this.sourceBufferCount)&&(e.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((t,e)=>{let i=this.tracks[e];return t[e]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},t},{})}appendChangeType(t,e,i){let s=`${e};codecs=${i}`,r={label:`change-type=${s}`,execute:()=>{let a=this.tracks[t];if(a){let o=a.buffer;o!=null&&o.changeType&&(this.log(`changing ${t} sourceBuffer type to ${s}`),o.changeType(s),a.codec=i,a.container=e)}this.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${t} SourceBuffer type`,a)}};this.append(r,t,this.isPending(this.tracks[t]))}blockAudio(t){var e;let i=t.start,s=i+t.duration*.05;if(((e=this.fragmentTracker.getAppendedFrag(i,W.MAIN))==null?void 0:e.gap)===!0)return;let a={label:"block-audio",execute:()=>{var o;let l=this.tracks.video;(this.lastVideoAppendEnd>s||l!=null&&l.buffer&&Q.isBuffered(l.buffer,s)||((o=this.fragmentTracker.getAppendedFrag(s,W.MAIN))==null?void 0:o.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn("Error executing block-audio operation",o)}};this.blockedAudioAppend={op:a,frag:t},this.append(a,"audio",!0)}unblockAudio(){let{blockedAudioAppend:t,operationQueue:e}=this;t&&e&&(this.blockedAudioAppend=null,e.unblockAudio(t.op))}onBufferAppending(t,e){let{tracks:i}=this,{data:s,type:r,parent:a,frag:o,part:l,chunkMeta:u}=e,c=u.buffering[r],h=o.sn,d=self.performance.now();c.start=d;let A=o.stats.buffering,f=l?l.stats.buffering:null;A.start===0&&(A.start=d),f&&f.start===0&&(f.start=d);let p=i.audio,m=!1;r==="audio"&&(p==null?void 0:p.container)==="audio/mpeg"&&(m=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);let v=this.tracks.video,b=v==null?void 0:v.buffer;if(b&&h!=="initSegment"){let I=l||o,k=this.blockedAudioAppend;if(r==="audio"&&a!=="main"&&!this.blockedAudioAppend){let D=I.start+I.duration*.05,O=b.buffered,P=this.currentOp("video");!O.length&&!P?this.blockAudio(I):!P&&!Q.isBuffered(b,D)&&this.lastVideoAppendEnd<D&&this.blockAudio(I)}else if(r==="video"){let R=I.end;if(k){let D=k.frag.start;(R>D||R<this.lastVideoAppendEnd||Q.isBuffered(b,D))&&this.unblockAudio()}this.lastVideoAppendEnd=R}}let T=(l||o).start,L={label:`append-${r}`,execute:()=>{if(c.executeStart=self.performance.now(),m){let I=this.tracks[r];if(I){let k=I.buffer;if(k){let R=T-k.timestampOffset;Math.abs(R)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${T} (delta: ${R}) sn: ${h})`),k.timestampOffset=T)}}}this.appendExecutor(s,r)},onStart:()=>{},onComplete:()=>{let I=self.performance.now();c.executeEnd=c.end=I,A.first===0&&(A.first=I),f&&f.first===0&&(f.first=I);let k={};this.sourceBuffers.forEach(([R,D])=>{R&&(k[R]=Q.getBuffered(D))}),this.appendErrors[r]=0,r==="audio"||r==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(g.BUFFER_APPENDED,{type:r,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:k})},onError:I=>{var k;let R={type:G.MEDIA_ERROR,parent:o.type,details:w.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:o,part:l,chunkMeta:u,error:I,err:I,fatal:!1},D=(k=this.media)==null?void 0:k.error;if(I.code===DOMException.QUOTA_EXCEEDED_ERR)R.details=w.BUFFER_FULL_ERROR;else if(I.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!D)R.errorAction=ci(!0);else if(I.name===El&&this.sourceBufferCount===0)R.errorAction=ci(!0);else{let O=++this.appendErrors[r];this.warn(`Failed ${O}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${D||"no media error"})`),(O>=this.hls.config.appendErrorMaxRetry||!!D)&&(R.fatal=!0)}this.hls.trigger(g.ERROR,R)}};this.append(L,r,this.isPending(this.tracks[r]))}getFlushOp(t,e,i){return this.log(`queuing "${t}" remove ${e}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(t,e,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(g.BUFFER_FLUSHED,{type:t})},onError:s=>{this.warn(`Failed to remove ${e}-${i} from "${t}" SourceBuffer`,s)}}}onBufferFlushing(t,e){let{type:i,startOffset:s,endOffset:r}=e;i?this.append(this.getFlushOp(i,s,r),i):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,s,r),a)})}onFragParsed(t,e){let{frag:i,part:s}=e,r=[],a=s?s.elementaryStreams:i.elementaryStreams;a[ut.AUDIOVIDEO]?r.push("audiovideo"):(a[ut.AUDIO]&&r.push("audio"),a[ut.VIDEO]&&r.push("video"));let o=()=>{let l=self.performance.now();i.stats.buffering.end=l,s&&(s.stats.buffering.end=l);let u=s?s.stats:i.stats;this.hls.trigger(g.FRAG_BUFFERED,{frag:i,part:s,stats:u,id:i.type})};r.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(o,r).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(t,e){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([t])=>{var e,i;return t&&(!((e=this.tracks[t])!=null&&e.ended)||((i=this.tracks[t])==null?void 0:i.ending))})}onBufferEos(t,e){var i;this.sourceBuffers.forEach(([a])=>{if(a){let o=this.tracks[a];(!e.type||e.type===a)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${a} buffer reached EOS`)))}});let s=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var o;return a&&!((o=this.tracks[a])!=null&&o.ended)})&&(s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();let{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(g.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(g.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([t])=>{if(t!==null){let e=this.tracks[t];e&&(e.ending=!1)}})}onLevelUpdated(t,{details:e}){!e.fragments.length||(this.details=e,this.updateDuration())}updateDuration(){let t=this.getDurationAndRange();!t||this.blockUntilOpen(()=>this.updateMediaSource(t))}onError(t,e){if(e.details===w.BUFFER_APPEND_ERROR&&e.frag){var i;let s=(i=e.errorAction)==null?void 0:i.nextAutoLevel;z(s)&&s!==e.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){let{hls:t,details:e,media:i}=this;if(!i||e===null||!this.sourceBufferCount)return;let s=t.config,r=i.currentTime,a=e.levelTargetDuration,o=e.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(z(o)&&o>=0){let l=Math.max(o,a),u=Math.floor(r/a)*a-l;this.flushBackBuffer(r,a,u)}if(z(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){let l=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),u=Math.max(l,a),c=Math.floor(r/a)*a+u;this.flushFrontBuffer(r,a,c)}}flushBackBuffer(t,e,i){this.sourceBuffers.forEach(([s,r])=>{if(r){let o=Q.getBuffered(r);if(o.length>0&&i>o.start(0)){var a;this.hls.trigger(g.BACK_BUFFER_REACHED,{bufferEnd:i});let l=this.tracks[s];if((a=this.details)!=null&&a.live)this.hls.trigger(g.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(l!=null&&l.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(g.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:s})}}})}flushFrontBuffer(t,e,i){this.sourceBuffers.forEach(([s,r])=>{if(r){let a=Q.getBuffered(r),o=a.length;if(o<2)return;let l=a.start(o-1),u=a.end(o-1);if(i>l||t>=l&&t<=u)return;this.hls.trigger(g.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:s})}})}getDurationAndRange(){var t;let{details:e,mediaSource:i}=this;if(!e||!this.media||(i==null?void 0:i.readyState)!=="open")return null;let s=e.edge;if(e.live&&this.hls.config.liveDurationInfinity){if(e.fragments.length&&e.live&&!!i.setLiveSeekableRange){let u=Math.max(0,e.fragmentStart),c=Math.max(u,s);return{duration:1/0,start:u,end:c}}return{duration:1/0}}let r=(t=this.overrides)==null?void 0:t.duration;if(r)return z(r)?{duration:r}:null;let a=this.media.duration,o=z(i.duration)?i.duration:0;return s>o&&s>a||!z(a)?{duration:s}:null}updateMediaSource({duration:t,start:e,end:i}){let s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==t&&(z(t)&&this.log(`Updating MediaSource duration to ${t.toFixed(3)}`),s.duration=t),e!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${e}-${i}.`),s.setLiveSeekableRange(e,i)))}get tracksReady(){let t=this.pendingTrackCount;return t>0&&(t>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){let{bufferCodecEventsTotal:t,pendingTrackCount:e,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${e} codec events expected: ${t}) ${ft(i)}`),this.tracksReady){var s;let r=(s=this.transferData)==null?void 0:s.tracks;r&&Object.keys(r).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){let t={};this.sourceBuffers.forEach(([e,i])=>{if(e){let s=this.tracks[e];t[e]={buffer:i,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(g.BUFFER_CREATED,{tracks:t}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([e])=>{this.executeNext(e)})}else{let t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}createSourceBuffers(){let{tracks:t,sourceBuffers:e,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(let r in t){let a=r,o=t[a];if(this.isPending(o)){let l=this.getTrackCodec(o,a),u=`${o.container};codecs=${l}`;o.codec=l,this.log(`creating sourceBuffer(${u})${this.currentOp(a)?" Queued":""} ${ft(o)}`);try{let c=i.addSourceBuffer(u),h=ur(a),d=[a,c];e[h]=d,o.buffer=c}catch(c){var s;this.error(`error while trying to add sourceBuffer: ${c.message}`),this.shiftAndExecuteNext(a),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[a],this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:c,sourceBufferName:a,mimeType:u,parent:o.id});return}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(t,e){let i=t.supplemental,s=t.codec;i&&(e==="video"||e==="audiovideo")&&br(i,"video")&&(s=sc(s,i));let r=Hi(s,t.levelCodec);return r?e.slice(0,5)==="audio"?$i(r,this.appendSource):r:""}trackSourceBuffer(t,e){let i=e.buffer;if(!i)return;let s=this.getTrackCodec(e,t);this.tracks[t]={buffer:i,codec:s,container:e.container,levelCodec:e.levelCodec,supplemental:e.supplemental,metadata:e.metadata,id:e.id,listeners:[]},this.removeBufferListeners(t),this.addBufferListener(t,"updatestart",this.onSBUpdateStart),this.addBufferListener(t,"updateend",this.onSBUpdateEnd),this.addBufferListener(t,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(t,"bufferedchange",(r,a)=>{let o=a.removedRanges;o!=null&&o.length&&this.hls.trigger(g.BUFFER_FLUSHED,{type:r})})}get mediaSrc(){var t,e;let i=((t=this.media)==null||(e=t.querySelector)==null?void 0:e.call(t,"source"))||this.media;return i==null?void 0:i.src}onSBUpdateStart(t){let e=this.currentOp(t);!e||e.onStart()}onSBUpdateEnd(t){var e;if(((e=this.mediaSource)==null?void 0:e.readyState)==="closed"){this.resetBuffer(t);return}let i=this.currentOp(t);!i||(i.onComplete(),this.shiftAndExecuteNext(t))}onSBUpdateError(t,e){var i;let s=new Error(`${t} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${s}`,e),this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:s,fatal:!1});let r=this.currentOp(t);r&&r.onError(s)}removeExecutor(t,e,i){let{media:s,mediaSource:r}=this,a=this.tracks[t],o=a==null?void 0:a.buffer;if(!s||!r||!o){this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(t);return}let l=z(s.duration)?s.duration:1/0,u=z(r.duration)?r.duration:1/0,c=Math.max(0,e),h=Math.min(i,l,u);h>c&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${c},${h}] from the ${t} SourceBuffer`),o.remove(c,h)):this.shiftAndExecuteNext(t)}appendExecutor(t,e){let i=this.tracks[e],s=i==null?void 0:i.buffer;if(!s)throw new Yr(`Attempting to append to the ${e} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,s.appendBuffer(t)}blockUntilOpen(t){if(this.isUpdating()||this.isQueued())this.blockBuffers(t).catch(e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{t()}catch(e){this.warn(`Callback run without blocking ${this.operationQueue} ${e}`)}}isUpdating(){return this.sourceBuffers.some(([t,e])=>t&&e.updating)}isQueued(){return this.sourceBuffers.some(([t])=>t&&!!this.currentOp(t))}isPending(t){return!!t&&!t.buffer}blockBuffers(t,e=this.sourceBufferTypes){if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);let{operationQueue:i}=this,s=e.map(a=>this.appendBlocker(a));return e.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(a=>{i===this.operationQueue&&(t(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(t){t.forEach(e=>{var i;let s=(i=this.tracks[e])==null?void 0:i.buffer;!s||s.updating||this.shiftAndExecuteNext(e)})}append(t,e,i){this.operationQueue&&this.operationQueue.append(t,e,i)}appendBlocker(t){if(this.operationQueue)return this.operationQueue.appendBlocker(t)}currentOp(t){return this.operationQueue?this.operationQueue.current(t):null}executeNext(t){t&&this.operationQueue&&this.operationQueue.executeNext(t)}shiftAndExecuteNext(t){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(t)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((t,e)=>t+(this.isPending(this.tracks[e])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((t,[e])=>t+(e?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([t])=>t).filter(t=>!!t)}addBufferListener(t,e,i){let s=this.tracks[t];if(!s)return;let r=s.buffer;if(!r)return;let a=i.bind(this,t);s.listeners.push({event:e,listener:a}),r.addEventListener(e,a)}removeBufferListeners(t){let e=this.tracks[t];if(!e)return;let i=e.buffer;!i||(e.listeners.forEach(s=>{i.removeEventListener(s.event,s.listener)}),e.listeners.length=0)}};function uo(n){let t=n.querySelectorAll("source");[].slice.call(t).forEach(e=>{n.removeChild(e)})}function Gh(n,t){let e=self.document.createElement("source");e.type="video/mp4",e.src=t,n.appendChild(e)}function ur(n){return n==="audio"?1:0}var Ti=class{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){let{hls:t}=this;t.on(g.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(g.MANIFEST_PARSED,this.onManifestParsed,this),t.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(g.BUFFER_CODECS,this.onBufferCodecs,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){let{hls:t}=this;t.off(g.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(g.MANIFEST_PARSED,this.onManifestParsed,this),t.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(g.BUFFER_CODECS,this.onBufferCodecs,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){let i=this.hls.levels[e.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){let i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&z(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}let t=this.hls.levels;if(t.length){let e=this.hls,i=this.getMaxLevel(t.length-1);i!==this.autoLevelCapping&&e.logger.log(`Setting autoLevelCapping to ${i}: ${t[i].height}p@${t[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),e.autoLevelCapping=i,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){let e=this.hls.levels;if(!e.length)return-1;let i=e.filter((s,r)=>this.isLevelAllowed(s)&&r<=t);return this.clientRect=null,Ti.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;let t=this.media,e={width:0,height:0};if(t){let i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,!e.width&&!e.height&&(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(e){}return Math.min(t,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(t){return!this.restrictedLevels.some(i=>t.bitrate===i.bitrate&&t.width===i.width&&t.height===i.height)}static getMaxLevelByMediaSize(t,e,i){if(!(t!=null&&t.length))return-1;let s=(o,l)=>l?o.width!==l.width||o.height!==l.height:!0,r=t.length-1,a=Math.max(e,i);for(let o=0;o<t.length;o+=1){let l=t[o];if((l.width>=a||l.height>=a)&&s(l,t[o+1])){r=o;break}}return r}},Hh={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},kt=Hh,Xh={HLS:"h"},qh=Xh,jh="CMCD-Object",Kh="CMCD-Request",Zh="CMCD-Session",Yh="CMCD-Status",si={OBJECT:jh,REQUEST:Kh,SESSION:Zh,STATUS:Yh},Qh={[si.OBJECT]:["br","d","ot","tb"],[si.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[si.SESSION]:["cid","pr","sf","sid","st","v"],[si.STATUS]:["bs","rtp"]},be=class{constructor(t,e){Array.isArray(t)&&(t=t.map(i=>i instanceof be?i:new be(i))),this.value=t,this.params=e}},Jh="Dict";function $h(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function td(n,t,e,i){return new Error(`failed to ${n} "${$h(t)}" as ${e}`,{cause:i})}function oe(n,t,e){return td("serialize",n,t,e)}var ps=class{constructor(t){this.description=t}},co="Bare Item",ed="Boolean";function id(n){if(typeof n!="boolean")throw oe(n,ed);return n?"?1":"?0"}var sd="Byte Sequence";function rd(n){if(ArrayBuffer.isView(n)===!1)throw oe(n,sd);return`:${Ah(n)}:`}var nd="Integer";function ad(n){return n<-999999999999999||999999999999999<n}function xl(n){if(ad(n))throw oe(n,nd);return n.toString()}function od(n){return`@${xl(n.getTime()/1e3)}`}var ld="Decimal";function ud(n){let t=ul(n,3);if(Math.floor(Math.abs(t)).toString().length>12)throw oe(n,ld);let e=t.toString();return e.includes(".")?e:`${e}.0`}var cd="String",hd=/[\x00-\x1f\x7f]+/;function dd(n){if(hd.test(n))throw oe(n,cd);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Ad(n){return n.description||n.toString().slice(7,-1)}var fd="Token";function ho(n){let t=Ad(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t)===!1)throw oe(t,fd);return t}function Jr(n){switch(typeof n){case"number":if(!z(n))throw oe(n,co);return Number.isInteger(n)?xl(n):ud(n);case"string":return dd(n);case"symbol":return ho(n);case"boolean":return id(n);case"object":if(n instanceof Date)return od(n);if(n instanceof Uint8Array)return rd(n);if(n instanceof ps)return ho(n);default:throw oe(n,co)}}var gd="Key";function $r(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw oe(n,gd);return n}function Hn(n){return n==null?"":Object.entries(n).map(([t,e])=>e===!0?`;${$r(t)}`:`;${$r(t)}=${Jr(e)}`).join("")}function Sl(n){return n instanceof be?`${Jr(n.value)}${Hn(n.params)}`:Jr(n)}function pd(n){return`(${n.value.map(Sl).join(" ")})${Hn(n.params)}`}function md(n,t={whitespace:!0}){if(typeof n!="object")throw oe(n,Jh);let e=n instanceof Map?n.entries():Object.entries(n),i=t!=null&&t.whitespace?" ":"";return Array.from(e).map(([s,r])=>{r instanceof be||(r=new be(r));let a=$r(s);return r.value===!0?a+=Hn(r.params):(a+="=",Array.isArray(r.value)?a+=pd(r):a+=Sl(r)),a}).join(`,${i}`)}function vd(n,t){return md(n,t)}function yd(n){return n==="ot"||n==="sf"||n==="st"}function Td(n){return typeof n=="number"?z(n):n!=null&&n!==""&&n!==!1}var ji=n=>Math.round(n),bd=(n,t)=>(t!=null&&t.baseUrl&&(n=fh(n,t.baseUrl)),encodeURIComponent(n)),Vi=n=>ji(n/100)*100,Ed={br:ji,d:ji,bl:Vi,dl:Vi,mtp:Vi,nor:bd,rtp:Vi,tb:ji};function xd(n,t){let e={};if(n==null||typeof n!="object")return e;let i=Object.keys(n).sort(),s=ct({},Ed,t==null?void 0:t.formatters),r=t==null?void 0:t.filter;return i.forEach(a=>{if(r!=null&&r(a))return;let o=n[a],l=s[a];l&&(o=l(o,t)),!(a==="v"&&o===1)&&(a=="pr"&&o===1||!Td(o)||(yd(a)&&typeof o=="string"&&(o=new ps(o)),e[a]=o))}),e}function Ll(n,t={}){return n?vd(xd(n,t),ct({whitespace:!1},t)):""}function Sd(n,t={}){let e={};if(!n)return e;let i=Object.entries(n),s=Object.entries(Qh).concat(Object.entries((t==null?void 0:t.customHeaderMap)||{})),r=i.reduce((a,o)=>{var l,u;let[c,h]=o,d=((l=s.find(A=>A[1].includes(c)))===null||l===void 0?void 0:l[0])||si.REQUEST;return(u=a[d])!==null&&u!==void 0||(a[d]={}),a[d][c]=h,a},{});return Object.entries(r).reduce((a,[o,l])=>(a[o]=Ll(l,t),a),e)}function Ld(n,t,e){return ct(n,Sd(t,e))}var Id="CMCD";function Rd(n,t={}){if(!n)return"";let e=Ll(n,t);return`${Id}=${encodeURIComponent(e)}`}var Ao=/CMCD=[^&#]+/;function Pd(n,t,e){let i=Rd(t,e);if(!i)return n;if(Ao.test(n))return n.replace(Ao,i);let s=n.includes("?")?"&":"?";return`${n}${s}${i}`}var tn=class{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:kt.MANIFEST,su:!this.initialized})}catch(r){this.hls.logger.warn("Could not generate manifest CMCD data.",r)}},this.applyFragmentData=s=>{try{let{frag:r,part:a}=s,o=this.hls.levels[r.level],l=this.getObjectType(r),u={d:(a||r).duration*1e3,ot:l};(l===kt.VIDEO||l===kt.AUDIO||l==kt.MUXED)&&(u.br=o.bitrate/1e3,u.tb=this.getTopBandwidth(l)/1e3,u.bl=this.getBufferLength(l));let c=a?this.getNextPart(a):this.getNextFrag(r);c!=null&&c.url&&c.url!==r.url&&(u.nor=c.url),this.apply(s,u)}catch(r){this.hls.logger.warn("Could not generate segment CMCD data.",r)}},this.hls=t;let e=this.config=t.config,{cmcd:i}=e;i!=null&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||t.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){let t=this.hls;t.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.MEDIA_DETACHED,this.onMediaDetached,this),t.on(g.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){let t=this.hls;t.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.MEDIA_DETACHED,this.onMediaDetached,this),t.off(g.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var i,s;this.audioBuffer=(i=e.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(s=e.tracks.video)==null?void 0:s.buffer}createData(){var t;return{v:1,sf:qh.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)==null?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){ct(e,this.createData());let i=e.ot===kt.INIT||e.ot===kt.VIDEO||e.ot===kt.MUXED;this.starved&&i&&(e.bs=!0,e.su=!0,this.starved=!1),e.su==null&&(e.su=this.buffering);let{includeKeys:s}=this;s&&(e=Object.keys(e).reduce((a,o)=>(s.includes(o)&&(a[o]=e[o]),a),{}));let r={baseUrl:t.url};this.useHeaders?(t.headers||(t.headers={}),Ld(t.headers,e,r)):t.url=Pd(t.url,e,r)}getNextFrag(t){var e;let i=(e=this.hls.levels[t.level])==null?void 0:e.details;if(i){let s=t.sn-i.startSN;return i.fragments[s+1]}}getNextPart(t){var e,i;let{index:s,fragment:r}=t,a=(e=this.hls.levels[r.level])==null||(i=e.details)==null?void 0:i.partList;if(a){let{sn:o}=r;for(let l=a.length-1;l>=0;l--){let u=a[l];if(u.index===s&&u.fragment.sn===o)return a[l+1]}}}getObjectType(t){let{type:e}=t;if(e==="subtitle")return kt.TIMED_TEXT;if(t.sn==="initSegment")return kt.INIT;if(e==="audio")return kt.AUDIO;if(e==="main")return this.hls.audioTracks.length?kt.VIDEO:kt.MUXED}getTopBandwidth(t){let e=0,i,s=this.hls;if(t===kt.AUDIO)i=s.audioTracks;else{let r=s.maxAutoLevel,a=r>-1?r+1:s.levels.length;i=s.levels.slice(0,a)}for(let r of i)r.bitrate>e&&(e=r.bitrate);return e>0?e:NaN}getBufferLength(t){let e=this.media,i=t===kt.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!e?NaN:Q.bufferInfo(i,e.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){let{pLoader:t}=this.config,e=this.applyPlaylistData,i=t||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new i(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,a,o){e(r),this.loader.load(r,a,o)}}}createFragmentLoader(){let{fLoader:t}=this.config,e=this.applyFragmentData,i=t||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new i(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,a,o){e(r),this.loader.load(r,a,o)}}}},Cd=3e5,en=class extends Qt{constructor(t){super("content-steering",t.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.registerListeners()}registerListeners(){let t=this.hls;t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(g.MANIFEST_PARSED,this.onManifestParsed,this),t.on(g.ERROR,this.onError,this)}unregisterListeners(){let t=this.hls;!t||(t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(g.MANIFEST_PARSED,this.onManifestParsed,this),t.off(g.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((t,e)=>(t.indexOf(e.pathwayId)===-1&&t.push(e.pathwayId),t),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(t){this.updatePathwayPriority(t)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){let t=this.timeToLoad*1e3-(performance.now()-this.updated);if(t>0){this.scheduleRefresh(this.uri,t);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){let e=this.levels;e&&(this.levels=e.filter(i=>i!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){let{contentSteering:i}=e;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){let{errorAction:i}=e;if((i==null?void 0:i.action)===Rt.SendAlternateToPenaltyBox&&i.flags===Zt.MoveAllAlternatesMatchingHost){let s=this.levels,r=this._pathwayPriority,a=this.pathwayId;if(e.context){let{groupId:o,pathwayId:l,type:u}=e.context;o&&s?a=this.getPathwayForGroupId(o,u,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!r&&s&&(r=this.pathways()),r&&r.length>1&&(this.updatePathwayPriority(r),i.resolved=this.pathwayId!==a),i.resolved||this.warn(`Could not resolve ${e.details} ("${e.error.message}") with content-steering for Pathway: ${a} levels: ${s&&s.length} priorities: ${ft(r)} penalized: ${ft(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(e.length===0){let i=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),e=this.getLevelsForPathway(i),this.pathwayId=i}return e.length!==t.length&&this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e}getLevelsForPathway(t){return this.levels===null?[]:this.levels.filter(e=>t===e.pathwayId)}updatePathwayPriority(t){this._pathwayPriority=t;let e,i=this.penalizedPathways,s=performance.now();Object.keys(i).forEach(r=>{s-i[r]>Cd&&delete i[r]});for(let r=0;r<t.length;r++){let a=t[r];if(a in i)continue;if(a===this.pathwayId)return;let o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(e=this.getLevelsForPathway(a),e.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,tl(e),this.hls.trigger(g.LEVELS_UPDATED,{levels:e});let u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(t,e,i){let s=this.getLevelsForPathway(i).concat(this.levels||[]);for(let r=0;r<s.length;r++)if(e===tt.AUDIO_TRACK&&s[r].hasAudioGroup(t)||e===tt.SUBTITLE_TRACK&&s[r].hasSubtitleGroup(t))return s[r].pathwayId;return i}clonePathways(t){let e=this.levels;if(!e)return;let i={},s={};t.forEach(r=>{let{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=r;if(e.some(c=>c.pathwayId===a))return;let u=this.getLevelsForPathway(o).map(c=>{let h=new dt(c.attrs);h["PATHWAY-ID"]=a;let d=h.AUDIO&&`${h.AUDIO}_clone_${a}`,A=h.SUBTITLES&&`${h.SUBTITLES}_clone_${a}`;d&&(i[h.AUDIO]=d,h.AUDIO=d),A&&(s[h.SUBTITLES]=A,h.SUBTITLES=A);let f=Il(c.uri,h["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),p=new De({attrs:h,audioCodec:c.audioCodec,bitrate:c.bitrate,height:c.height,name:c.name,url:f,videoCodec:c.videoCodec,width:c.width});if(c.audioGroups)for(let m=1;m<c.audioGroups.length;m++)p.addGroupId("audio",`${c.audioGroups[m]}_clone_${a}`);if(c.subtitleGroups)for(let m=1;m<c.subtitleGroups.length;m++)p.addGroupId("text",`${c.subtitleGroups[m]}_clone_${a}`);return p});e.push(...u),fo(this.audioTracks,i,l,a),fo(this.subtitleTracks,s,l,a)})}loadSteeringManifest(t){let e=this.hls.config,i=e.loader;this.loader&&this.loader.destroy(),this.loader=new i(e);let s;try{s=new self.URL(t)}catch(c){this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${t}`);return}if(s.protocol!=="data:"){let c=(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+c)}let r={responseType:"json",url:s.href},a=e.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(c,h,d,A)=>{this.log(`Loaded steering manifest: "${s}"`);let f=c.data;if((f==null?void 0:f.VERSION)!==1){this.log(`Steering VERSION ${f.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=f.TTL;let{"RELOAD-URI":p,"PATHWAY-CLONES":m,"PATHWAY-PRIORITY":v}=f;if(p)try{this.uri=new self.URL(p,s).href}catch(T){this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${p}`);return}this.scheduleRefresh(this.uri||d.url),m&&this.clonePathways(m);let b={steeringManifest:f,url:s.toString()};this.hls.trigger(g.STEERING_MANIFEST_LOADED,b),v&&this.updatePathwayPriority(v)},onError:(c,h,d,A)=>{if(this.log(`Error loading steering manifest: ${c.code} ${c.text} (${h.url})`),this.stopLoad(),c.code===410){this.enabled=!1,this.log(`Steering manifest ${h.url} no longer available`);return}let f=this.timeToLoad*1e3;if(c.code===429){let p=this.loader;if(typeof(p==null?void 0:p.getResponseHeader)=="function"){let m=p.getResponseHeader("Retry-After");m&&(f=parseFloat(m)*1e3)}this.log(`Steering manifest ${h.url} rate limited`);return}this.scheduleRefresh(this.uri||h.url,f)},onTimeout:(c,h,d)=>{this.log(`Timeout loading steering manifest (${h.url})`),this.scheduleRefresh(this.uri||h.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(r,l,u)}scheduleRefresh(t,e=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;let s=(i=this.hls)==null?void 0:i.media;if(s&&!s.ended){this.loadSteeringManifest(t);return}this.scheduleRefresh(t,this.timeToLoad*1e3)},e)}};function fo(n,t,e,i){!n||Object.keys(t).forEach(s=>{let r=n.filter(a=>a.groupId===s).map(a=>{let o=ct({},a);return o.details=void 0,o.attrs=new dt(o.attrs),o.url=o.attrs.URI=Il(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",e),o.groupId=o.attrs["GROUP-ID"]=t[s],o.attrs["PATHWAY-ID"]=i,o});n.push(...r)})}function Il(n,t,e,i){let{HOST:s,PARAMS:r,[e]:a}=i,o;t&&(o=a==null?void 0:a[t],o&&(n=o));let l=new self.URL(n);return s&&!o&&(l.host=s),r&&Object.keys(r).sort().forEach(u=>{u&&l.searchParams.set(u,r[u])}),l.href}var ve=class extends Qt{constructor(t){super("eme",t.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=ve.CDMCleanupPromise?[ve.CDMCleanupPromise]:[],this.onMediaEncrypted=e=>{let{initDataType:i,initData:s}=e,r=`"${e.type}" event: init data type: "${i}"`;if(this.debug(r),s!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=Ni(this.config));let o=a.map(er).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(o)}this.keyFormatPromise.then(a=>{let o=$s(a),l,u;if(i==="sinf"){if(o!==ot.FAIRPLAY){this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${i}" for selected key-system ${o}`);return}let f=vt(new Uint8Array(s));try{let p=Fn(JSON.parse(f).sinf),m=Mo(p);if(!m)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=new Uint8Array(m.subarray(8,24)),u=ot.FAIRPLAY}catch(p){this.warn(`${r} Failed to parse sinf: ${p}`);return}}else{if(o!==ot.WIDEVINE&&o!==ot.PLAYREADY){this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${i}" for selected key-system ${o}`);return}let f=$u(s),p=f.filter(v=>!!v.systemId&&tr(v.systemId)===o);p.length>1&&this.warn(`${r} Using first of ${p.length} pssh found for selected key-system ${o}`);let m=p[0];if(!m){f.length===0||f.some(v=>!v.systemId)?this.warn(`${r} contains incomplete or invalid pssh data`):this.log(`ignoring ${r} for ${f.map(v=>tr(v.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=tr(m.systemId),m.version===0&&m.data)if(u===ot.WIDEVINE){let v=m.data.length-22;l=new Uint8Array(m.data.subarray(v,v+16))}else u===ot.PLAYREADY&&(l=jo(m.data))}if(!u||!l)return;let c=ie.hexDump(l),{keyIdToKeySessionPromise:h,mediaKeySessions:d}=this,A=h[c];for(let f=0;f<d.length;f++){let p=d[f],m=p.decryptdata;if(!m.keyId)continue;let v=ie.hexDump(m.keyId);if(c===v||m.uri.replace(/-/g,"").indexOf(c)!==-1){if(A=h[v],m.pssh)break;delete h[v],m.pssh=new Uint8Array(s),m.keyId=l,A=h[c]=A.then(()=>this.generateRequestWithPreferredKeySession(p,i,s,"encrypted-event-key-match")),A.catch(b=>this.handleError(b));break}}if(!A){if(u!==o){this.log(`Ignoring "${e.type}" event with ${u} init data for selected key-system ${o}`);return}A=h[c]=this.getKeySystemSelectionPromise([u]).then(({keySystem:f,mediaKeys:p})=>{var m;this.throwIfDestroyed();let v=new Oe("ISO-23001-7",c,(m=er(f))!=null?m:"");return v.pssh=new Uint8Array(s),v.keyId=l,this.attemptSetMediaKeys(f,p).then(()=>{this.throwIfDestroyed();let b=this.createMediaKeySessionContext({decryptdata:v,keySystem:f,mediaKeys:p});return this.generateRequestWithPreferredKeySession(b,i,s,"encrypted-event-no-match")})}),A.catch(f=>this.handleError(f))}})}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=t,this.config=t.config,this.registerListeners()}destroy(){let t=this.media;this.unregisterListeners(),this.onMediaDetached(),this._clear(t);let e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(g.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(g.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(g.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(g.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){let{drmSystems:e,widevineLicenseUrl:i}=this.config,s=e[t];if(s)return s.licenseUrl;if(t===ot.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(t){let e=this.getLicenseServerUrl(t);if(e===void 0)throw new Error(`no license server URL configured for key-system "${t}"`);return e}getServerCertificateUrl(t){let{drmSystems:e}=this.config,i=e[t];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){let e=this.hls.levels,i=(a,o,l)=>!!a&&l.indexOf(a)===o,s=e.map(a=>a.audioCodec).filter(i),r=e.map(a=>a.videoCodec).filter(i);return s.length+r.length===0&&r.push("avc1.42e01e"),new Promise((a,o)=>{let l=u=>{let c=u.shift();this.getMediaKeysPromise(c,s,r).then(h=>a({keySystem:c,mediaKeys:h})).catch(h=>{u.length?l(u):h instanceof Mt?o(h):o(new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_ACCESS,error:h,fatal:!0},h.message))})};l(t)})}requestMediaKeySystemAccess(t,e){let{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${i}`;return qo===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return i(t,e)}getMediaKeysPromise(t,e,i){let s=Nc(t,e,i,this.config.drmSystemOptions),r=this.keySystemAccessPromises[t],a=r==null?void 0:r.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${t}" key-system access with config: ${ft(s)}`),a=this.requestMediaKeySystemAccess(t,s);let o=this.keySystemAccessPromises[t]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${t}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);let u=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),o.mediaKeys=l.createMediaKeys().then(c=>(this.log(`Media-keys created for "${t}"`),u.then(h=>h?this.setMediaKeysServerCertificate(c,t,h):c))),o.mediaKeys.catch(c=>{this.error(`Failed to create media-keys for "${t}"}: ${c}`)}),o.mediaKeys})}return a.then(()=>r.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:e,mediaKeys:i}){this.log(`Creating key-system session "${e}" keyId: ${ie.hexDump(t.keyId||[])}`);let s=i.createSession(),r={decryptdata:t,keySystem:e,mediaKeys:i,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(t){let e=t.decryptdata;if(e.pssh){let i=this.createMediaKeySessionContext(t),s=this.getKeyIdString(e),r="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(i,r,e.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return ie.hexDump(t.keyId)}updateKeySession(t,e){var i;let s=t.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${ie.hexDump(((i=t.decryptdata)==null?void 0:i.keyId)||[])}
      } (data length: ${e&&e.byteLength})`),s.update(e)}selectKeySystemFormat(t){let e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise((e,i)=>{let s=Ni(this.config),r=t.map($s).filter(a=>!!a&&s.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(r).then(({keySystem:a})=>{let o=er(a);o?e(o):i(new Error(`Unable to find format for key-system "${a}"`))}).catch(i)})}loadKey(t){let e=t.keyInfo.decryptdata,i=this.getKeyIdString(e),s=`(keyId: ${i} format: "${e.keyFormat}" method: ${e.method} uri: ${e.uri})`;this.log(`Starting session for key ${s}`);let r=this.keyIdToKeySessionPromise[i];return r||(r=this.getKeySystemForKeyPromise(e).then(({keySystem:o,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${s}`),this.attemptSetMediaKeys(o,l).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:o,mediaKeys:l,decryptdata:e}))))),(this.keyIdToKeySessionPromise[i]=r.then(o=>{let l="cenc",u=e.pssh?e.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(o,l,u,"playlist-key")})).catch(o=>this.handleError(o))),r}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){!this.hls||(this.error(t.message),t instanceof Mt?this.hls.trigger(g.ERROR,t.data):this.hls.trigger(g.ERROR,{type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){let e=this.getKeyIdString(t),i=this.keyIdToKeySessionPromise[e];if(!i){let s=$s(t.keyFormat),r=s?[s]:Ni(this.config);return this.attemptKeySystemAccess(r)}return i}getKeySystemSelectionPromise(t){if(t.length||(t=Ni(this.config)),t.length===0)throw new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${ft({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}attemptSetMediaKeys(t,e){let i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);let s=Promise.all(i).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(e)});return this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${t}"`),i.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(r=>i.indexOf(r)===-1)})}generateRequestWithPreferredKeySession(t,e,i,s){var r,a;let o=(r=this.config.drmSystems)==null||(a=r[t.keySystem])==null?void 0:a.generateRequest;if(o)try{let f=o.call(this.hls,e,i,t);if(!f)throw new Error("Invalid response from configured generateRequest filter");e=f.initDataType,i=f.initData?f.initData:null,t.decryptdata.pssh=i?new Uint8Array(i):null}catch(f){var l;if(this.warn(f.message),(l=this.hls)!=null&&l.config.debug)throw f}if(i===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(t);let u=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${s}": ${u} (init data type: ${e} length: ${i?i.byteLength:null})`);let c=new Un,h=t._onmessage=f=>{let p=t.mediaKeysSession;if(!p){c.emit("error",new Error("invalid state"));return}let{messageType:m,message:v}=f;this.log(`"${m}" message event for session "${p.sessionId}" message size: ${v.byteLength}`),m==="license-request"||m==="license-renewal"?this.renewLicense(t,v).catch(b=>{c.eventNames().length?c.emit("error",b):this.handleError(b)}):m==="license-release"?t.keySystem===ot.FAIRPLAY&&(this.updateKeySession(t,Or("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${m}"`)},d=t._onkeystatuseschange=f=>{if(!t.mediaKeysSession){c.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(t);let m=t.keyStatus;c.emit("keyStatus",m),m==="expired"&&(this.warn(`${t.keySystem} expired for key ${u}`),this.renewKeySession(t))};t.mediaKeysSession.addEventListener("message",h),t.mediaKeysSession.addEventListener("keystatuseschange",d);let A=new Promise((f,p)=>{c.on("error",p),c.on("keyStatus",m=>{m.startsWith("usable")?f():m==="output-restricted"?p(new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):m==="internal-error"?p(new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${m}"`)):m==="expired"?p(new Error("key expired while generating request")):this.warn(`unhandled key status change "${m}"`)})});return t.mediaKeysSession.generateRequest(e,i).then(()=>{var f;this.log(`Request generated for key-session "${(f=t.mediaKeysSession)==null?void 0:f.sessionId}" keyId: ${u}`)}).catch(f=>{throw new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_SESSION,error:f,fatal:!1},`Error generating key-session request: ${f}`)}).then(()=>A).catch(f=>{throw c.removeAllListeners(),this.removeSession(t),f}).then(()=>(c.removeAllListeners(),t))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach((e,i)=>{if(typeof i=="string"&&typeof e=="object"){let s=i;i=e,e=s}this.log(`key status change "${e}" for keyStatuses keyId: ${ie.hexDump("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${ie.hexDump(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=e})}fetchServerCertificate(t){let e=this.config,i=e.loader,s=new i(e),r=this.getServerCertificateUrl(t);return r?(this.log(`Fetching server certificate for "${t}"`),new Promise((a,o)=>{let l={responseType:"arraybuffer",url:r},u=e.certLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(d,A,f,p)=>{a(d.data)},onError:(d,A,f,p)=>{o(new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:f,response:at({url:l.url,data:void 0},d)},`"${t}" certificate request failed (${r}). Status: ${d.code} (${d.text})`))},onTimeout:(d,A,f)=>{o(new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:f,response:{url:l.url,data:void 0}},`"${t}" certificate request timed out (${r})`))},onAbort:(d,A,f)=>{o(new Error("aborted"))}};s.load(l,c,h)})):Promise.resolve()}setMediaKeysServerCertificate(t,e,i){return new Promise((s,r)=>{t.setServerCertificate(i).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${i==null?void 0:i.byteLength}) on "${e}"`),s(t)}).catch(a=>{r(new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(t,e){return this.requestLicense(t,new Uint8Array(e)).then(i=>this.updateKeySession(t,new Uint8Array(i)).catch(s=>{throw new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:s,fatal:!0},s.message)}))}unpackPlayReadyKeyMessage(t,e){let i=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(!i.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),e;let s=new DOMParser().parseFromString(i,"application/xml"),r=s.querySelectorAll("HttpHeader");if(r.length>0){let c;for(let h=0,d=r.length;h<d;h++){var a,o;c=r[h];let A=(a=c.querySelector("name"))==null?void 0:a.textContent,f=(o=c.querySelector("value"))==null?void 0:o.textContent;A&&f&&t.setRequestHeader(A,f)}}let l=s.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Or(atob(u))}setupLicenseXHR(t,e,i,s){let r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return r.call(this.hls,t,e,i,s)}).catch(a=>{if(!i.decryptdata)throw a;return t.open("POST",e,!0),r.call(this.hls,t,e,i,s)}).then(a=>(t.readyState||t.open("POST",e,!0),{xhr:t,licenseChallenge:a||s})):(t.open("POST",e,!0),Promise.resolve({xhr:t,licenseChallenge:s}))}requestLicense(t,e){let i=this.config.keyLoadPolicy.default;return new Promise((s,r)=>{let a=this.getLicenseServerUrlOrThrow(t.keySystem);this.log(`Sending license request to URL: ${a}`);let o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return r(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);let u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,o,a,t)}catch(c){this.error(c)}s(l)}else{let l=i.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||o.status>=400&&o.status<500)r(new Mt({type:G.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{let c=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${c} attempts left`),this.requestLicense(t,e).then(s,r)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=o,this.setupLicenseXHR(o,a,t,e).then(({xhr:l,licenseChallenge:u})=>{t.keySystem==ot.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)})})}onMediaAttached(t,e){if(!this.config.emeEnabled)return;let i=e.media;this.media=i,i.removeEventListener("encrypted",this.onMediaEncrypted),i.removeEventListener("waitingforkey",this.onWaitingForKey),i.addEventListener("encrypted",this.onMediaEncrypted),i.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){let t=this.media;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null)}_clear(t){var e;let i=this.mediaKeySessions;this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Oe.clearKeyUriToKeyIdMap();let s=i.length;ve.CDMCleanupPromise=Promise.all(i.map(r=>this.removeSession(r)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(r=>{var a;this.log(`Could not clear media keys: ${r}`),(a=this.hls)==null||a.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${r}`)})}))).then(()=>{s&&(this.log("finished closing key sessions and clearing media keys"),i.length=0)}).catch(r=>{var a;this.log(`Could not close sessions and clear media keys: ${r}`),(a=this.hls)==null||a.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${r}`)})})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:e}){if(!(!e||!this.config.emeEnabled)&&!this.keyFormatPromise){let i=e.reduce((s,r)=>(s.indexOf(r.keyFormat)===-1&&s.push(r.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(t){let{mediaKeysSession:e,licenseXhr:i}=t;if(e){this.log(`Remove licenses and keys and close session ${e.sessionId}`),t._onmessage&&(e.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(e.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;let s=this.mediaKeySessions.indexOf(t);s>-1&&this.mediaKeySessions.splice(s,1);let{drmSystemOptions:r}=this.config;return(Uc(r)?new Promise((o,l)=>{self.setTimeout(()=>l(new Error("MediaKeySession.remove() timeout")),8e3),e.remove().then(o)}):Promise.resolve()).catch(o=>{var l;this.log(`Could not remove session: ${o}`),(l=this.hls)==null||l.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${o}`)})}).then(()=>e.close()).catch(o=>{var l;this.log(`Could not close session: ${o}`),(l=this.hls)==null||l.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${o}`)})})}}};ve.CDMCleanupPromise=void 0;var Mt=class extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}},sn=class{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(g.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(g.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){let i=this.hls.config;if(i.capLevelOnFPSDrop){let s=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(t,e,i){let s=performance.now();if(e){if(this.lastTime){let r=s-this.lastTime,a=i-this.lastDroppedFrames,o=e-this.lastDecodedFrames,l=1e3*a/r,u=this.hls;if(u.trigger(g.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:i}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*o){let c=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)&&(c=c-1,u.trigger(g.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=i,this.lastDecodedFrames=e}}checkFPSInterval(){let t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){let e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}};function Rl(n,t){let e;try{e=new Event("addtrack")}catch(i){e=document.createEvent("Event"),e.initEvent("addtrack",!1,!1)}e.track=n,t.dispatchEvent(e)}function Pl(n,t){let e=n.mode;if(e==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(t.id))try{if(n.addCue(t),!n.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(i){it.debug(`[texttrack-utils]: ${i}`);try{let s=new self.TextTrackCue(t.startTime,t.endTime,t.text);s.id=t.id,n.addCue(s)}catch(s){it.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}e==="disabled"&&(n.mode=e)}function ze(n,t){let e=n.mode;if(e==="disabled"&&(n.mode="hidden"),n.cues)for(let i=n.cues.length;i--;)t&&n.cues[i].removeEventListener("enter",t),n.removeCue(n.cues[i]);e==="disabled"&&(n.mode=e)}function rn(n,t,e,i){let s=n.mode;if(s==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){let r=wd(n.cues,t,e);for(let a=0;a<r.length;a++)(!i||i(r[a]))&&n.removeCue(r[a])}s==="disabled"&&(n.mode=s)}function Dd(n,t){if(t<=n[0].startTime)return 0;let e=n.length-1;if(t>n[e].endTime)return-1;let i=0,s=e,r;for(;i<=s;)if(r=Math.floor((s+i)/2),t<n[r].startTime)s=r-1;else if(t>n[r].startTime&&i<e)i=r+1;else return r;return n[i].startTime-t<t-n[s].startTime?i:s}function wd(n,t,e){let i=[],s=Dd(n,t);if(s>-1)for(let r=s,a=n.length;r<a;r++){let o=n[r];if(o.startTime>=t&&o.endTime<=e)i.push(o);else if(o.startTime>e)return i}return i}function Ki(n){let t=[];for(let e=0;e<n.length;e++){let i=n[e];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&t.push(n[e])}return t}var nn=class extends vi{constructor(t){super(t,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null,i=Ki(this.media.textTracks);for(let r=0;r<i.length;r++)if(i[r].mode==="hidden")e=i[r];else if(i[r].mode==="showing"){e=i[r];break}let s=this.findTrackForTextTrack(e);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){let{hls:t}=this;t.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.MANIFEST_PARSED,this.onManifestParsed,this),t.on(g.LEVEL_LOADING,this.onLevelLoading,this),t.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(g.ERROR,this.onError,this)}unregisterListeners(){let{hls:t}=this;t.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.MANIFEST_PARSED,this.onManifestParsed,this),t.off(g.LEVEL_LOADING,this.onLevelLoading,this),t.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(g.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(t,e){let i=this.media;if(!i)return;let s=!!e.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;Ki(i.textTracks).forEach(a=>{ze(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){let{id:i,groupId:s,details:r}=e,a=this.tracksInGroup[i];if(!a||a.groupId!==s){this.warn(`Subtitle track with id:${i} and group:${s} not found in active group ${a==null?void 0:a.groupId}`);return}let o=a.details;a.details=e.details,this.log(`Subtitle track ${i} "${a.name}" lang:${a.lang} group:${s} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,o)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){let e=this.hls.levels[t];if(!e)return;let i=e.subtitleGroups||null,s=this.groupIds,r=this.currentTrack;if(!i||(s==null?void 0:s.length)!==(i==null?void 0:i.length)||i!=null&&i.some(a=>(s==null?void 0:s.indexOf(a))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;let a=this.tracks.filter(c=>!i||i.indexOf(c.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(c=>c.default)&&(this.selectDefaultTrack=!1),a.forEach((c,h)=>{c.id=h});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=a;let o=this.hls.config.subtitlePreference;if(!r&&o){this.selectDefaultTrack=!1;let c=ne(o,a);if(c>-1)r=a[c];else{let h=ne(o,this.tracks);r=this.tracks[h]}}let l=this.findTrackId(r);l===-1&&r&&(l=this.findTrackId(null));let u={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${i==null?void 0:i.join(",")}" group-id`),this.hls.trigger(g.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}}findTrackId(t){let e=this.tracksInGroup,i=this.selectDefaultTrack;for(let s=0;s<e.length;s++){let r=e[s];if(!(i&&!r.default||!i&&!t)&&(!t||Pe(r,t)))return s}if(t){for(let s=0;s<e.length;s++){let r=e[s];if(yi(t.attrs,r.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<e.length;s++){let r=e[s];if(yi(t.attrs,r.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(t){if(t){let e=this.tracksInGroup;for(let i=0;i<e.length;i++){let s=e[i];if(jr(s,t))return i}}return-1}onError(t,e){e.fatal||!e.context||e.context.type===tt.SUBTITLE_TRACK&&e.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(e.context.groupId)!==-1)&&this.checkRetry(e)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){if(t.id===-1)return this.setSubtitleTrack(-1),null;let e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){let i=this.currentTrack;if(i&&Pe(t,i))return i;let s=ne(t,this.tracksInGroup);if(s>-1){let r=this.tracksInGroup[s];return this.setSubtitleTrack(s),r}else{if(i)return null;{let r=ne(t,e);if(r>-1)return e[r]}}}}return null}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);let i=t.id,s=t.groupId,r=this.getUrlWithDirectives(t.url,e),a=t.details,o=a==null?void 0:a.age;this.log(`Loading subtitle ${i} "${t.name}" lang:${t.lang} group:${s}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(g.SUBTITLE_TRACK_LOADING,{url:r,id:i,groupId:s,deliveryDirectives:e||null,track:t})}toggleTrackModes(){let{media:t}=this;if(!t)return;let e=Ki(t.textTracks),i=this.currentTrack,s;if(i&&(s=e.filter(r=>jr(i,r))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(e).forEach(r=>{r.mode!=="disabled"&&r!==s&&(r.mode="disabled")}),s){let r=this.subtitleDisplay?"showing":"hidden";s.mode!==r&&(s.mode=r)}}setSubtitleTrack(t){let e=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(t<-1||t>=e.length||!z(t)){this.warn(`Invalid subtitle track id: ${t}`);return}this.selectDefaultTrack=!1;let i=this.currentTrack,s=e[t]||null;if(this.trackId=t,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(g.SUBTITLE_TRACK_SWITCH,{id:t});return}let r=!!s.details&&!s.details.live;if(t===this.trackId&&s===i&&r)return;this.log(`Switching to subtitle-track ${t}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));let{id:a,groupId:o="",name:l,type:u,url:c}=s;this.hls.trigger(g.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:c});let h=this.switchParams(s.url,i==null?void 0:i.details,s.details);this.loadPlaylist(h)}};function ai(n){let t=5381,e=n.length;for(;e;)t=t*33^n.charCodeAt(--e);return(t>>>0).toString()}var Xe=.025,ms=function(n){return n[n.Point=0]="Point",n[n.Range=1]="Range",n}({});function Od(n,t,e){return`${n.identifier}-${e+1}-${ai(t)}`}var an=class{constructor(t,e){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=e,this.dateRange=t,this.setDateRange(t)}setDateRange(t){this.dateRange=t,this.resumeOffset=t.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=t.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=t.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=t.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var t;this.appendInPlaceStarted=!1,(t=this.assetListLoader)==null||t.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(t){if(t>=this.assetList.length)return!0;let e=this.playoutLimit;return t<=0||isNaN(e)?!1:this.assetList[t].startOffset>e}findAssetIndex(t){return this.assetList.indexOf(t)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){let t=this.dateRange.startTime;if(this.snapOptions.out){let e=this.dateRange.tagAnchor;if(e)return cr(t,e)}return t}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;let t=this.dateRange.tagAnchor;if(t){let e=this.dateRange.startTime,i=cr(e,t);return e-i<.1}return!1}get resumptionOffset(){let t=this.resumeOffset,e=z(t)?t:this.duration;return this.cumulativeDuration+e}get resumeTime(){let t=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){let e=this.resumeAnchor;if(e)return cr(t,e)}return t}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Xe))}set appendInPlace(t){if(this.appendInPlaceStarted){this.resetOnResume=!t;return}this.appendInPlaceDisabled=!t}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(t){this._timelineStart=t}get duration(){let t=this.playoutLimit,e;return this._duration!==null?e=this._duration:this.dateRange.duration?e=this.dateRange.duration:e=this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(t){this._duration=t}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?ms.Range:ms.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return kd(this)}};function cr(n,t){return n-t.start<t.duration/2&&!(Math.abs(n-(t.start+t.duration))<Xe)?t.start:t.start+t.duration}function Cl(n,t,e){let i=new self.URL(n,e);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",t),i}function kd(n){return`["${n.identifier}" ${n.cue.pre?"<pre>":n.cue.post?"<post>":""}${n.timelineStart.toFixed(2)}-${n.resumeTime.toFixed(2)}]`}function on(n){let t=n.timelineStart,e=n.duration||0;return`["${n.identifier}" ${t.toFixed(2)}-${(t+e).toFixed(2)}]`}var ln=class{constructor(t,e,i,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{let u=this.interstitial.playoutLimit,c=this.currentTime;this.startOffset+c>=u&&this.hls.trigger(g.PLAYOUT_LIMIT_REACHED,{})};let r=this.hls=new t(e);this.interstitial=i,this.assetItem=s;let a=s.uri;try{a=Cl(a,r.sessionId).href}catch(l){}r.loadSource(a);let o=()=>{this.hasDetails=!0};r.once(g.LEVEL_LOADED,o),r.once(g.AUDIO_TRACK_LOADED,o),r.once(g.SUBTITLE_TRACK_LOADED,o),r.on(g.MEDIA_ATTACHING,(l,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&u.addEventListener("timeupdate",this.checkPlayout)})}bufferedInPlaceToEnd(t){var e;if(!this.interstitial.appendInPlace)return!1;if((e=this.hls)!=null&&e.bufferedToEnd)return!0;if(!t||!this._bufferedEosTime)return!1;let i=this.timelineOffset,s=Q.bufferInfo(t,i,0);return this.getAssetTime(s.end)>=this._bufferedEosTime-.02}get destroyed(){var t;return!((t=this.hls)!=null&&t.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var t;return((t=this.hls)==null?void 0:t.media)||null}get bufferedEnd(){let t=this.media||this.mediaAttached;if(!t)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;let e=Q.bufferInfo(t,t.currentTime,.001);return this.getAssetTime(e.end)}get currentTime(){let t=this.media||this.mediaAttached;return t?this.getAssetTime(t.currentTime):this._currentTime||0}get duration(){let t=this.assetItem.duration;return t||0}get remaining(){let t=this.duration;return t?Math.max(0,t-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var t;return((t=this.hls)==null?void 0:t.config.timelineOffset)||0}set timelineOffset(t){let e=this.timelineOffset;if(t!==e){let i=t-e;if(Math.abs(i)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=t}}}getAssetTime(t){let e=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,t-e),i)}removeMediaListeners(){let t=this.mediaAttached;t&&(this._currentTime=t.currentTime,this.bufferSnapShot(),t.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var t;(t=this.hls)!=null&&t.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(t){this.hls.attachMedia(t)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}on(t,e,i){this.hls.on(t,e)}once(t,e,i){this.hls.once(t,e)}off(t,e,i){this.hls.off(t,e)}toString(){var t,e;return`HlsAssetPlayer: ${on(this.assetItem)} ${(t=this.hls)==null?void 0:t.sessionId} ${(e=this.interstitial)!=null&&e.appendInPlace?"append-in-place":""}`}},go=.033,un=class extends Qt{constructor(t,e){super("interstitials-sched",e),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=t}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(t=>t.reset()),this.events=this.items=null}resetErrorsInRange(t,e){return this.events?this.events.reduce((i,s)=>t<=s.startOffset&&e>s.startOffset?(delete s.error,i+1):i,0):0}get duration(){let t=this.items;return t?t[t.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(t){return t&&this.eventMap[t]||null}hasEvent(t){return t in this.eventMap}findItemIndex(t,e){if(t.event)return this.findEventIndex(t.event.identifier);let i=-1;t.nextEvent?i=this.findEventIndex(t.nextEvent.identifier)-1:t.previousEvent&&(i=this.findEventIndex(t.previousEvent.identifier)+1);let s=this.items;if(s)for(s[i]||(e===void 0&&(e=t.start),i=this.findItemIndexAtTime(e));i>=0&&(r=s[i])!=null&&r.event;){var r;i--}return i}findItemIndexAtTime(t,e){let i=this.items;if(i)for(let s=0;s<i.length;s++){let r=i[s];if(e&&e!=="primary"&&(r=r[e]),t===r.start||t>r.start&&t<r.end)return s}return-1}findJumpRestrictedIndex(t,e){let i=this.items;if(i)for(let s=t;s<=e&&i[s];s++){let r=i[s].event;if(r!=null&&r.restrictions.jump&&!r.appendInPlace)return s}return-1}findEventIndex(t){let e=this.items;if(e)for(let s=e.length;s--;){var i;if(((i=e[s].event)==null?void 0:i.identifier)===t)return s}return-1}findAssetIndex(t,e){let i=t.assetList,s=i.length;if(s>1)for(let r=0;r<s;r++){let a=i[r];if(!a.error){let o=a.timelineStart;if(e===o||e>o&&e<o+(a.duration||0))return r}}return 0}get assetIdAtEnd(){var t,e;let i=(t=this.items)==null||(e=t[this.length-1])==null?void 0:e.event;if(i){let s=i.assetList,r=s[s.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(t,e){let i=t.main.details,{dateRanges:s}=i,r=this.events,a=this.parseDateRanges(s,{url:i.url},e),o=Object.keys(s),l=r?r.filter(u=>!o.includes(u.identifier)):[];a.length&&a.sort((u,c)=>{let h=u.cue.pre,d=u.cue.post,A=c.cue.pre,f=c.cue.post;if(h&&!A)return-1;if(A&&!h||d&&!f)return 1;if(f&&!d)return-1;if(!h&&!A&&!d&&!f){let p=u.startTime,m=c.startTime;if(p!==m)return p-m}return u.dateRange.tagOrder-c.dateRange.tagOrder}),this.events=a,l.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(t,l)}updateSchedule(t,e=[]){let i=this.events||[];if(i.length||e.length||this.length<2){let s=this.items,r=this.parseSchedule(i,t);(e.length||(s==null?void 0:s.length)!==r.length||r.some((o,l)=>Math.abs(o.playout.start-s[l].playout.start)>.005||Math.abs(o.playout.end-s[l].playout.end)>.005))&&(this.items=r,this.onScheduleUpdate(e,s))}}parseDateRanges(t,e,i){let s=[],r=Object.keys(t);for(let a=0;a<r.length;a++){let o=r[a],l=t[o];if(l.isInterstitial){let u=this.eventMap[o];u?u.setDateRange(l):(u=new an(l,e),this.eventMap[o]=u,i===!1&&(u.appendInPlace=i)),s.push(u)}}return s}parseSchedule(t,e){let i=[],s=e.main.details,r=s.live?1/0:s.edge,a=0;if(t=t.filter(l=>!l.error&&!(l.cue.once&&l.hasPlayed)),t.length){this.resolveOffsets(t,e);let l=0,u=0;if(t.forEach((c,h)=>{let d=c.cue.pre,A=c.cue.post,f=t[h-1]||null,p=c.appendInPlace,m=A?r:c.startOffset,v=c.duration,b=c.timelineOccupancy===ms.Range?v:0,T=c.resumptionOffset,L=(f==null?void 0:f.startTime)===m,I=m+c.cumulativeDuration,k=p?I+v:m+T;if(d||!A&&m<=0){let D=u;u+=b,c.timelineStart=I;let O=a;a+=v,i.push({event:c,start:I,end:k,playout:{start:O,end:a},integrated:{start:D,end:u}})}else if(m<=r){if(!L){let P=m-l;if(P>go){let V=l,y=u;u+=P;let S=a;a+=P;let x={previousEvent:t[h-1]||null,nextEvent:c,start:V,end:V+P,playout:{start:S,end:a},integrated:{start:y,end:u}};i.push(x)}else P>0&&f&&(f.cumulativeDuration+=P,i[i.length-1].end=m)}A&&(k=I),c.timelineStart=I;let D=u;u+=b;let O=a;a+=v,i.push({event:c,start:I,end:k,playout:{start:O,end:a},integrated:{start:D,end:u}})}else return;let R=c.resumeTime;A||R>r?l=r:l=R}),l<r){var o;let c=l,h=u,d=r-l;u+=d;let A=a;a+=d,i.push({previousEvent:((o=i[i.length-1])==null?void 0:o.event)||null,nextEvent:null,start:l,end:c+d,playout:{start:A,end:a},integrated:{start:h,end:u}})}this.setDurations(r,a,u)}else i.push({previousEvent:null,nextEvent:null,start:0,end:r,playout:{start:0,end:r},integrated:{start:0,end:r}}),this.setDurations(r,r,r);return i}setDurations(t,e,i){this.durations={primary:t,playout:e,integrated:i}}resolveOffsets(t,e){let i=e.main.details,s=i.live?1/0:i.edge,r=0,a=-1;t.forEach((o,l)=>{let u=o.cue.pre,c=o.cue.post,h=u?0:c?s:o.startTime;this.updateAssetDurations(o),a===h?o.cumulativeDuration=r:(r=0,a=h),!c&&o.snapOptions.in&&(o.resumeAnchor=we(null,i.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(o,e)||(o.appendInPlace=!1)),!o.appendInPlace&&l+1<t.length&&t[l+1].startTime-t[l].resumeTime<go&&(t[l+1].appendInPlace=!1,t[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`));let A=z(o.resumeOffset)?o.resumeOffset:o.duration;r+=A})}primaryCanResumeInPlaceAt(t,e){let i=t.resumeTime,s=t.startTime+t.resumptionOffset;return Math.abs(i-s)>Xe?(this.log(`"${t.identifier}" resumption ${i} not aligned with estimated timeline end ${s}`),!1):e?!Object.keys(e).some(a=>{let o=e[a].details,l=o.edge;if(i>=l)return this.log(`"${t.identifier}" resumption ${i} past ${a} playlist end ${l}`),!1;let u=we(null,o.fragments,i);if(!u)return this.log(`"${t.identifier}" resumption ${i} does not align with any fragments in ${a} playlist (${o.fragStart}-${o.fragmentEnd})`),!0;let c=a==="audio"?.175:0;return Math.abs(u.start-i)<Xe+c||Math.abs(u.end-i)<Xe+c?!1:(this.log(`"${t.identifier}" resumption ${i} not aligned with ${a} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)}):(this.log(`"${t.identifier}" resumption ${i} can not be aligned with media (none selected)`),!1)}updateAssetDurations(t){if(!t.assetListLoaded)return;let e=t.timelineStart,i=0,s=!1,r=!1;t.assetList.forEach((a,o)=>{let l=e+i;a.startOffset=i,a.timelineStart=l,s||(s=a.duration===null),r||(r=!!a.error);let u=a.error?0:a.duration||0;i+=u}),s&&!r?t.duration=Math.max(i,t.duration):t.duration=i}removeEvent(t){t.reset(),delete this.eventMap[t.identifier]}};function ge(n){return`[${n.event?'"'+n.event.identifier+'"':"primary"}: ${n.start.toFixed(2)}-${n.end.toFixed(2)}]`}var cn=class{constructor(t){this.hls=void 0,this.hls=t}destroy(){this.hls=null}loadAssetList(t,e){let i=t.assetListUrl,s;try{s=Cl(i,this.hls.sessionId,t.baseUrl)}catch(d){let A=this.assignAssetListError(t,w.ASSET_LIST_LOAD_ERROR,d,i);this.hls.trigger(g.ERROR,A);return}e&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+e);let r=this.hls.config,a=r.loader,o=new a(r),l={responseType:"json",url:s.href},u=r.interstitialAssetListLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(d,A,f,p)=>{let m=d.data,v=m==null?void 0:m.ASSETS;if(!Array.isArray(v)){let b=this.assignAssetListError(t,w.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),f.url,A,p);this.hls.trigger(g.ERROR,b);return}t.assetListResponse=m,this.hls.trigger(g.ASSET_LIST_LOADED,{event:t,assetListResponse:m,networkDetails:p})},onError:(d,A,f,p)=>{let m=this.assignAssetListError(t,w.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${d.code} ${d.text} (${A.url})`),A.url,p,f);this.hls.trigger(g.ERROR,m)},onTimeout:(d,A,f)=>{let p=this.assignAssetListError(t,w.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${A.url})`),A.url,d,f);this.hls.trigger(g.ERROR,p)}};return o.load(l,c,h),this.hls.trigger(g.ASSET_LIST_LOADING,{event:t}),o}assignAssetListError(t,e,i,s,r,a){return t.error=i,{type:G.NETWORK_ERROR,details:e,fatal:!1,interstitial:t,url:s,error:i,networkDetails:a,stats:r}}};function de(n,t,e){ae(n,t,e),n.addEventListener(t,e)}function ae(n,t,e){n.removeEventListener(t,e)}function po(n){n==null||n.play().catch(()=>{})}var hn=class extends Qt{constructor(t,e){super("interstitials",t.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{let i=this.currentTime;if(i===void 0||this.playbackDisabled)return;let s=i-this.timelinePos;if(Math.abs(s)<1/7056e5)return;let a=s<=-.01;this.timelinePos=i,this.bufferedPos=i;let o=this.playingItem;if(!o){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(i,i-s)&&this.updateSchedule(),this.checkBuffer(),a&&i<o.start||i>=o.end){var l;let d=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(o)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!a){let A=this.findItemIndex(o);if(d>A){let f=this.schedule.findJumpRestrictedIndex(A+1,d);if(f>A){this.setSchedulePosition(f);return}}}this.setSchedulePosition(d);return}let u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(o)){let d=o.event.assetList[0];d&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,d))}return}let c=u.timelineStart,h=u.duration||0;(a&&i<c||i>=c+h)&&this.setScheduleToAssetAtTime(i,u)},this.onTimeupdate=()=>{let i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;let s=this.playingItem;if(!s||this.playingLastItem)return;if(i>=s.end){this.timelinePos=s.end;let o=this.findItemIndex(s);this.setSchedulePosition(o+1)}let r=this.playingAsset;if(!r)return;let a=r.timelineStart+(r.duration||0);i>=a&&this.setScheduleToAssetAtTime(i,r)},this.onScheduleUpdate=(i,s)=>{let r=this.schedule,a=this.playingItem,o=r.events||[],l=r.items||[],u=r.durations,c=i.map(A=>A.identifier),h=!!(o.length||c.length);if(h&&this.log(`INTERSTITIALS_UPDATED (${o.length}): ${o}
Schedule: ${l.map(A=>ge(A))}`),c.length&&this.log(`Removed events ${c}`),this.playerQueue.forEach(A=>{if(A.interstitial.appendInPlace){let f=A.assetItem.timelineStart,p=A.timelineOffset-f;if(p)try{A.timelineOffset=f}catch(m){Math.abs(p)>Xe&&this.warn(`${m} ("${A.assetId}" ${A.timelineOffset}->${f})`)}}}),a){let A=this.updateItem(a,this.timelinePos);this.itemsMatch(a,A)&&(this.playingItem=A,this.waitingItem=this.endedItem=null)}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);let d=this.bufferingItem;if(d){let A=this.updateItem(d,this.bufferedPos);this.itemsMatch(d,A)?this.bufferingItem=A:d.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(d.event,null))}if(i.forEach(A=>{A.assetList.forEach(f=>{this.clearAssetPlayer(f.identifier,null)})}),h||s){if(this.hls.trigger(g.INTERSTITIALS_UPDATED,{events:o.slice(0),schedule:l.slice(0),durations:u,removedIds:c}),this.isInterstitial(a)&&c.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}this.checkBuffer()}},this.hls=t,this.HlsPlayerClass=e,this.assetListLoader=new cn(t),this.schedule=new un(this.onScheduleUpdate,t.logger),this.registerListeners()}registerListeners(){let t=this.hls;t.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(g.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.on(g.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(g.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.on(g.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.on(g.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.on(g.BUFFER_APPENDED,this.onBufferAppended,this),t.on(g.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(g.BUFFERED_TO_END,this.onBufferedToEnd,this),t.on(g.MEDIA_ENDED,this.onMediaEnded,this),t.on(g.ERROR,this.onError,this),t.on(g.DESTROYING,this.onDestroying,this)}unregisterListeners(){let t=this.hls;!t||(t.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(g.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.off(g.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(g.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.off(g.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.off(g.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.off(g.BUFFER_CODECS,this.onBufferCodecs,this),t.off(g.BUFFER_APPENDED,this.onBufferAppended,this),t.off(g.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(g.BUFFERED_TO_END,this.onBufferedToEnd,this),t.off(g.MEDIA_ENDED,this.onMediaEnded,this),t.off(g.ERROR,this.onError,this),t.off(g.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var t;(t=this.getBufferingPlayer())==null||t.resumeBuffering()}pauseBuffering(){var t;(t=this.getBufferingPlayer())==null||t.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){let t=this.primaryMedia||this.media;t&&this.removeMediaListeners(t)}removeMediaListeners(t){ae(t,"play",this.onPlay),ae(t,"pause",this.onPause),ae(t,"seeking",this.onSeeking),ae(t,"timeupdate",this.onTimeupdate)}onMediaAttaching(t,e){let i=this.media=e.media;de(i,"seeking",this.onSeeking),de(i,"timeupdate",this.onTimeupdate),de(i,"play",this.onPlay),de(i,"pause",this.onPause)}onMediaAttached(t,e){let i=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!s){this.clearScheduleState();let r=this.findItemIndex(i);this.setSchedulePosition(r)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(t,e){let i=!!e.transferMedia,s=this.media;if(this.media=null,!i&&(s&&this.removeMediaListeners(s),this.detachedData)){let r=this.getBufferingPlayer();r&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,r.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;let t=this,e=()=>t.bufferingItem||t.waitingItem,i=h=>h&&t.getAssetPlayer(h.identifier),s=(h,d,A,f,p)=>{if(h){let m=h[d].start,v=h.event;if(v){if(d==="playout"||v.timelineOccupancy!==ms.Point){let b=i(A);(b==null?void 0:b.interstitial)===v&&(m+=b.assetItem.startOffset+b[p])}}else{let b=f==="bufferedPos"?a():t[f];m+=b-h.start}return m}return 0},r=(h,d)=>{if(h!==0&&d!=="primary"&&t.schedule.length){var A;let f=t.schedule.findItemIndexAtTime(h),p=(A=t.schedule.items)==null?void 0:A[f];if(p){let m=p[d].start-p.start;return h+m}}return h},a=()=>{let h=t.bufferedPos;return h===Number.MAX_VALUE?o("primary"):Math.max(h,0)},o=h=>{var d;return(d=t.primaryDetails)!=null&&d.live?t.primaryDetails.edge:t.schedule.durations[h]},l=(h,d)=>{var A,f;let p=t.effectivePlayingItem;if(p!=null&&(A=p.event)!=null&&A.restrictions.skip)return;t.log(`seek to ${h} "${d}"`);let m=t.effectivePlayingItem,v=t.schedule.findItemIndexAtTime(h,d),b=(f=t.schedule.items)==null?void 0:f[v],T=t.getBufferingPlayer(),L=T==null?void 0:T.interstitial,I=L==null?void 0:L.appendInPlace,k=m&&t.itemsMatch(m,b);if(m&&(I||k)){let D=i(t.playingAsset),O=(D==null?void 0:D.media)||t.primaryMedia;if(O){let P=d==="primary"?O.currentTime:s(m,d,t.playingAsset,"timelinePos","currentTime"),V=h-P,y=(I?P:O.currentTime)+V;if(y>=0&&(!D||I||y<=D.duration)){O.currentTime=y;return}}}if(b){let D=h;if(d!=="primary"){let P=b[d].start,V=h-P;D=b.start+V}let O=!t.isInterstitial(b);if((!t.isInterstitial(m)||m.event.appendInPlace)&&(O||b.event.appendInPlace)){let P=t.media||(I?T==null?void 0:T.media:null);P&&(P.currentTime=D)}else if(m){let P=t.findItemIndex(m);if(v>P){let y=t.schedule.findJumpRestrictedIndex(P+1,v);if(y>P){t.setSchedulePosition(y);return}}let V=0;if(O)t.timelinePos=D,t.checkBuffer();else{var R;let y=b==null||(R=b.event)==null?void 0:R.assetList;if(y){let S=h-(b[d]||b).start;for(let x=y.length;x--;){let E=y[x];if(E.duration&&S>=E.startOffset&&S<E.startOffset+E.duration){V=x;break}}}}t.setSchedulePosition(v,V)}}},u=()=>{let h=t.effectivePlayingItem;if(t.isInterstitial(h))return h;let d=e();return t.isInterstitial(d)?d:null},c={get currentTime(){let h=u(),d=t.effectivePlayingItem;return d&&d===h?s(d,"playout",t.effectivePlayingAsset,"timelinePos","currentTime")-d.playout.start:0},set currentTime(h){let d=u(),A=t.effectivePlayingItem;A&&A===d&&l(h+A.playout.start,"playout")},get duration(){let h=u();return h?h.playout.end-h.playout.start:0},get assetPlayers(){var h;let d=(h=u())==null?void 0:h.event.assetList;return d?d.map(A=>t.getAssetPlayer(A.identifier)):[]},get playingIndex(){var h;let d=(h=u())==null?void 0:h.event;return d&&t.effectivePlayingAsset?d.findAssetIndex(t.effectivePlayingAsset):-1},get scheduleItem(){return u()}};this.manager={get events(){var h,d;return((h=t.schedule)==null||(d=h.events)==null?void 0:d.slice(0))||[]},get schedule(){var h,d;return((h=t.schedule)==null||(d=h.items)==null?void 0:d.slice(0))||[]},get interstitialPlayer(){return u()?c:null},get playerQueue(){return t.playerQueue.slice(0)},get bufferingAsset(){return t.bufferingAsset},get bufferingItem(){return e()},get bufferingIndex(){let h=e();return t.findItemIndex(h)},get playingAsset(){return t.effectivePlayingAsset},get playingItem(){return t.effectivePlayingItem},get playingIndex(){let h=t.effectivePlayingItem;return t.findItemIndex(h)},primary:{get bufferedEnd(){return a()},get currentTime(){let h=t.timelinePos;return h>0?h:0},set currentTime(h){l(h,"primary")},get duration(){return o("primary")},get seekableStart(){var h;return((h=t.primaryDetails)==null?void 0:h.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(e(),"integrated",t.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(t.effectivePlayingItem,"integrated",t.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(h){l(h,"integrated")},get duration(){return o("integrated")},get seekableStart(){var h;return r(((h=t.primaryDetails)==null?void 0:h.fragmentStart)||0,"integrated")}},skip:()=>{let h=t.effectivePlayingItem,d=h==null?void 0:h.event;if(d&&!d.restrictions.skip){let A=t.findItemIndex(h);if(d.appendInPlace){let f=h.playout.start+h.event.duration;l(f+.001,"playout")}else t.advanceAfterAssetEnded(d,A,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var t;let e=this.playingItem,i=(t=this.schedule)==null?void 0:t.items;return!this.playbackStarted||!e||!i?!1:this.findItemIndex(e)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var t,e,i;if(this.mediaSelection===null)return;let s=this.waitingItem||this.playingItem;if(this.isInterstitial(s)&&!s.event.appendInPlace)return;let r=this.media;!r&&(t=this.bufferingItem)!=null&&(e=t.event)!=null&&e.appendInPlace&&(r=this.primaryMedia);let a=(i=r)==null?void 0:i.currentTime;if(!(a===void 0||!z(a)))return a}get primaryMedia(){var t;return this.media||((t=this.detachedData)==null?void 0:t.media)||null}isInterstitial(t){return!!(t!=null&&t.event)}retreiveMediaSource(t,e){let i=this.getAssetPlayer(t);i&&this.transferMediaFromPlayer(i,e)}transferMediaFromPlayer(t,e){let i=t.interstitial.appendInPlace,s=t.media;if(i&&s===this.primaryMedia){if(this.bufferingAsset=null,(!e||this.isInterstitial(e)&&!e.event.appendInPlace)&&e&&s){this.detachedData={media:s};return}let r=t.transferMedia();this.log(`transfer MediaSource from ${t} ${ft(r)}`),this.detachedData=r}else e&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(t,e){var i,s;if(t.media===e)return;let r=null,a=this.hls,o=t!==a,l=o&&t.interstitial.appendInPlace,u=(i=this.detachedData)==null?void 0:i.mediaSource,c;if(a.media)l&&(r=a.transferMedia(),this.detachedData=r),c="Primary";else if(u){let A=this.getBufferingPlayer();A?(r=A.transferMedia(),c=`${A}`):c="detached MediaSource"}else c="detached media";if(!r){if(u)r=this.detachedData,this.log(`using detachedData: MediaSource ${ft(r)}`);else if(!this.detachedData||a.media===e){let A=this.playerQueue;A.length>1&&A.forEach(f=>{if(o&&f.interstitial.appendInPlace!==l){let p=f.interstitial;this.clearInterstitial(f.interstitial,null),p.appendInPlace=!1,p.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${p}`)}}),this.hls.detachMedia(),this.detachedData={media:e}}}let h=r&&"mediaSource"in r&&((s=r.mediaSource)==null?void 0:s.readyState)!=="closed",d=h&&r?r:e;if(this.log(`${h?"transfering MediaSource":"attaching media"} to ${o?t:"Primary"} from ${c}`),d===r){let A=o&&t.assetId===this.schedule.assetIdAtEnd;d.overrides={duration:this.schedule.duration,endOfStream:!o||A,cueRemoval:!o}}t.attachMedia(d)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){let t=this.schedule,e=t.events;if(!e||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);let i=this.timelinePos,s=this.effectivePlayingItem;if(i===-1){let r=this.hls.startPosition;if(this.timelinePos=r,e.length&&e[0].cue.pre){let a=t.findEventIndex(e[0].identifier);this.setSchedulePosition(a)}else if(r>=0||!this.primaryLive){let a=this.timelinePos=r>0?r:0,o=t.findItemIndexAtTime(a);this.setSchedulePosition(o)}}else if(s&&!this.playingItem){let r=t.findItemIndex(s);this.setSchedulePosition(r)}}advanceAfterAssetEnded(t,e,i){let s=i+1;if(!t.isAssetPastPlayoutLimit(s)&&!t.assetList[s].error)this.setSchedulePosition(e,s);else{let r=this.schedule.items;if(r){let a=e+1,o=r.length;if(a>=o){this.setSchedulePosition(-1);return}let l=t.resumeTime;this.timelinePos<l&&(this.timelinePos=l,this.checkBuffer()),this.setSchedulePosition(a)}}}setScheduleToAssetAtTime(t,e){let i=this.schedule,s=e.parentIdentifier,r=i.getEvent(s);if(r){let a=i.findEventIndex(s),o=i.findAssetIndex(r,t);this.setSchedulePosition(a,o)}}setSchedulePosition(t,e){let i=this.schedule.items;if(!i||this.playbackDisabled)return;this.log(`setSchedulePosition ${t}, ${e}`);let s=t>=0?i[t]:null,r=this.playingItem,a=this.playingLastItem;if(this.isInterstitial(r)){var o;let u=r.event,c=this.playingAsset,h=c==null?void 0:c.identifier,d=h?this.getAssetPlayer(h):null;if(d&&h&&(!this.eventItemsMatch(r,s)||e!==void 0&&h!==((o=u.assetList)==null?void 0:o[e].identifier))){var l;let A=u.findAssetIndex(c);this.log(`INTERSTITIAL_ASSET_ENDED ${A+1}/${u.assetList.length} ${on(c)}`),this.endedAsset=c,this.playingAsset=null,this.hls.trigger(g.INTERSTITIAL_ASSET_ENDED,{asset:c,assetListIndex:A,event:u,schedule:i.slice(0),scheduleIndex:t,player:d}),this.retreiveMediaSource(h,s),d.media&&!((l=this.detachedData)!=null&&l.mediaSource)&&d.detachMedia()}if(!this.eventItemsMatch(r,s)&&(this.endedItem=r,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${u} ${ge(r)}`),u.hasPlayed=!0,this.hls.trigger(g.INTERSTITIAL_ENDED,{event:u,schedule:i.slice(0),scheduleIndex:t}),u.cue.once)){this.updateSchedule();let A=this.schedule.items;if(s&&A){let f=this.schedule.findItemIndex(s);this.advanceSchedule(f,A,e,r,a)}return}}this.advanceSchedule(t,i,e,r,a)}advanceSchedule(t,e,i,s,r){let a=t>=0?e[t]:null,o=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(u=>{let c=u.interstitial,h=this.schedule.findEventIndex(c.identifier);(h<t||h>t+1)&&this.clearInterstitial(c,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);let u=a.event;i===void 0&&(i=this.schedule.findAssetIndex(u,this.timelinePos));let c=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let h=this.preloadAssets(u,i);if(this.eventItemsMatch(a,c||s)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${ge(a)} ${u.appendInPlace?"append in place":""}`),this.hls.trigger(g.INTERSTITIAL_STARTED,{event:u,schedule:e.slice(0),scheduleIndex:t})),!u.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${u}`);return}if(u.assetListLoader&&(u.assetListLoader.destroy(),u.assetListLoader=void 0),!o){this.log(`Waiting for attachMedia to start Interstitial ${u}`);return}this.waitingItem=this.endedItem=null,this.playingItem=a;let d=u.assetList[i];if(!d){let A=e[t+1],f=this.media;A&&f&&!this.isInterstitial(A)&&f.currentTime<A.start&&(f.currentTime=this.timelinePos=A.start),this.advanceAfterAssetEnded(u,t,i||0);return}if(h||(h=this.getAssetPlayer(d.identifier)),h===null||h.destroyed){let A=u.assetList.length;this.warn(`asset ${i+1}/${A} player destroyed ${u}`),h=this.createAssetPlayer(u,d,i)}if(!this.eventItemsMatch(a,this.bufferingItem)&&u.appendInPlace&&this.isAssetBuffered(d))return;this.startAssetPlayer(h,i,e,t,o),this.shouldPlay&&po(h.media)}else a!==null?(this.resumePrimary(a,t,s),this.shouldPlay&&po(this.hls.media)):r&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var t,e;return(t=this.mediaSelection)==null||(e=t.main)==null?void 0:e.details}get primaryLive(){var t;return!!((t=this.primaryDetails)!=null&&t.live)}resumePrimary(t,e,i){var s;if(this.playingItem=t,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(t),this.log(`resuming ${ge(t)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let a=this.timelinePos;(a<t.start||a>=t.end)&&(a=this.getPrimaryResumption(t,e),this.timelinePos=a),this.attachPrimary(a,t)}if(!i)return;let r=this.schedule.items;!r||(this.log(`resumed ${ge(t)}`),this.hls.trigger(g.INTERSTITIALS_PRIMARY_RESUMED,{schedule:r.slice(0),scheduleIndex:e}),this.checkBuffer())}getPrimaryResumption(t,e){let i=t.start;if(this.primaryLive){let s=this.primaryDetails;if(e===0)return this.hls.startPosition;if(s&&(i<s.fragmentStart||i>s.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(t){let e=this.getAssetPlayer(t.identifier);return e!=null&&e.hls?e.hls.bufferedToEnd:Q.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=t.timelineStart+(t.duration||0)}attachPrimary(t,e,i){e?this.setBufferingItem(e):this.bufferingItem=this.playingItem,this.bufferingAsset=null;let s=this.primaryMedia;if(!s)return;let r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,s),i&&this.startLoadingPrimaryAt(t,i)),i||(this.timelinePos=t,this.startLoadingPrimaryAt(t,i))}startLoadingPrimaryAt(t,e){var i;let s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((i=s.mainForwardBufferInfo)==null?void 0:i.start)||s.media.currentTime)-t)>.5?s.startLoad(t,e):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(g.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(g.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(t,e){if(e.level===-1)return;let i=this.hls.levels[e.level],s=at(at({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(t,e){let i=this.hls.audioTracks[e.id],s=this.mediaSelection;if(!s){this.altSelection=at(at({},this.altSelection),{},{audio:i});return}let r=at(at({},s),{},{audio:i});this.mediaSelection=r}onSubtitleTrackUpdated(t,e){let i=this.hls.subtitleTracks[e.id],s=this.mediaSelection;if(!s){this.altSelection=at(at({},this.altSelection),{},{subtitles:i});return}let r=at(at({},s),{},{subtitles:i});this.mediaSelection=r}onAudioTrackSwitching(t,e){let i=Da(e);this.playerQueue.forEach(s=>s.hls.setAudioOption(e)||s.hls.setAudioOption(i))}onSubtitleTrackSwitch(t,e){let i=Da(e);this.playerQueue.forEach(s=>s.hls.setSubtitleOption(e)||e.id!==-1&&s.hls.setSubtitleOption(i))}onBufferCodecs(t,e){let i=e.tracks;i&&(this.requiredTracks=i)}onBufferAppended(t,e){this.checkBuffer()}onBufferFlushed(t,e){let i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){let s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(t){let e=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&e){for(let s=0;s<e.length;s++){let r=e[s];if(r.cue.post){var i;let a=this.schedule.findEventIndex(r.identifier),o=(i=this.schedule.items)==null?void 0:i[a];this.isInterstitial(o)&&this.eventItemsMatch(o,this.bufferingItem)&&this.bufferedToItem(o,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(t){let e=this.playingItem;if(!this.playingLastItem&&e){let i=this.findItemIndex(e);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(t,e){let i=this.schedule.items;if(t&&i){let s=this.findItemIndex(t,e);return i[s]||null}return null}itemsMatch(t,e){return!!e&&(t===e||t.event&&e.event&&this.eventItemsMatch(t,e)||!t.event&&!e.event&&this.findItemIndex(t)===this.findItemIndex(e))}eventItemsMatch(t,e){var i;return!!e&&(t===e||t.event.identifier===((i=e.event)==null?void 0:i.identifier))}findItemIndex(t,e){return t?this.schedule.findItemIndex(t,e):-1}updateSchedule(){let t=this.mediaSelection;!t||this.schedule.updateSchedule(t,[])}checkBuffer(t){let e=this.schedule.items;if(!e)return;let i=Q.bufferInfo(this.primaryMedia,this.timelinePos,0);t&&(this.bufferedPos=this.timelinePos),t||(t=i.len<1),this.updateBufferedPos(i.end,e,t)}updateBufferedPos(t,e,i){let s=this.schedule,r=this.bufferingItem;if(this.bufferedPos>t)return;if(e.length===1&&this.itemsMatch(e[0],r)){this.bufferedPos=t;return}let a=this.playingItem,o=this.findItemIndex(a),l=s.findItemIndexAtTime(t);if(this.bufferedPos<t){var u,c;let h=this.findItemIndex(r),d=Math.min(h+1,e.length-1),A=e[d];if((l===-1&&r&&t>=r.end||(u=A.event)!=null&&u.appendInPlace&&t+.01>=A.start)&&(l=d),d-o>1&&(r==null||(c=r.event)==null?void 0:c.appendInPlace)===!1)return;if(this.bufferedPos=t,l>h&&l>o)this.bufferedToItem(A);else{let f=this.primaryDetails;this.primaryLive&&f&&t>f.edge-f.targetduration&&A.start<f.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(A)&&this.preloadAssets(A.event,0)}}else i&&a&&!this.itemsMatch(a,r)&&(l===o?this.bufferedToItem(a):l===o+1&&this.bufferedToItem(e[l]))}assetsBuffered(t,e){return t.event.assetList.length===0?!1:!t.event.assetList.some(s=>{let r=this.getAssetPlayer(s.identifier);return!(r!=null&&r.bufferedInPlaceToEnd(e))})}setBufferingItem(t){let e=this.bufferingItem,i=this.schedule;if(this.itemsMatch(t,e))this.bufferingItem!==t&&(this.bufferingItem=t);else{let{items:s,events:r}=i;if(!s||!r)return e;let a=this.isInterstitial(t),o=this.getBufferingPlayer();if(this.bufferingItem=t,this.bufferedPos=Math.max(t.start,Math.min(t.end,this.timelinePos)),!this.playbackDisabled){let l=o?o.remaining:e?e.end-this.timelinePos:0;this.log(`buffered to boundary ${ge(t)}`+(e?` (${l.toFixed(2)} remaining)`:"")),a?t.event.assetList.forEach(u=>{let c=this.getAssetPlayer(u.identifier);c&&c.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering()))}this.hls.trigger(g.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(t),playingIndex:this.findItemIndex(this.playingItem)})}return e}bufferedToItem(t,e=0){let i=this.setBufferingItem(t);if(!this.playbackDisabled){if(this.isInterstitial(t))this.bufferedToEvent(t,e);else if(i!==null){this.bufferingAsset=null;let s=this.detachedData;s?s.mediaSource?this.attachPrimary(t.start,t,!0):this.preloadPrimary(t):this.preloadPrimary(t)}}}preloadPrimary(t){let e=this.findItemIndex(t),i=this.getPrimaryResumption(t,e);this.startLoadingPrimaryAt(i)}bufferedToEvent(t,e){let i=t.event,s=i.assetList.length===0&&!i.assetListLoader,r=i.cue.once;if(s||!r){let a=this.preloadAssets(i,e);if(a!=null&&a.interstitial.appendInPlace){let o=i.assetList[e],l=this.primaryMedia;o&&l&&this.bufferAssetPlayer(a,l)}}}preloadAssets(t,e){let i=t.assetUrl,s=t.assetList.length,r=s===0&&!t.assetListLoader,a=t.cue.once;if(r){let l=t.timelineStart;if(t.appendInPlace){var o;let d=this.playingItem;!this.isInterstitial(d)&&(d==null||(o=d.nextEvent)==null?void 0:o.identifier)===t.identifier&&this.flushFrontBuffer(l+.25)}let u,c=0;if(!this.playingItem&&this.primaryLive&&(c=this.hls.startPosition,c===-1&&(c=this.hls.liveSyncPosition||0)),c&&!(t.cue.pre||t.cue.post)){let d=c-l;d>0&&(u=Math.round(d*1e3)/1e3)}if(this.log(`Load interstitial asset ${e+1}/${i?1:s} ${t}${u?` live-start: ${c} start-offset: ${u}`:""}`),i)return this.createAsset(t,0,0,l,t.duration,i);let h=this.assetListLoader.loadAssetList(t,u);h&&(t.assetListLoader=h)}else if(!a&&s){for(let l=e;l<s;l++){let u=t.assetList[l],c=this.getAssetPlayerQueueIndex(u.identifier);(c===-1||this.playerQueue[c].destroyed)&&!u.error&&this.createAssetPlayer(t,u,l)}return this.getAssetPlayer(t.assetList[e].identifier)}return null}flushFrontBuffer(t){let e=this.requiredTracks;if(!e)return;this.log(`Removing front buffer starting at ${t}`),Object.keys(e).forEach(s=>{this.hls.trigger(g.BUFFER_FLUSHING,{startOffset:t,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(t){let e=this.playerQueue;for(let i=0;i<e.length;i++)if(t===e[i].assetId)return i;return-1}getAssetPlayer(t){let e=this.getAssetPlayerQueueIndex(t);return this.playerQueue[e]||null}getBufferingPlayer(){let{playerQueue:t,primaryMedia:e}=this;if(e){for(let i=0;i<t.length;i++)if(t[i].media===e)return t[i]}return null}createAsset(t,e,i,s,r,a){let o={parentIdentifier:t.identifier,identifier:Od(t,a,e),duration:r,startOffset:i,timelineStart:s,uri:a};return this.createAssetPlayer(t,o,e)}createAssetPlayer(t,e,i){this.log(`create HLSAssetPlayer for ${on(e)}`);let s=this.hls,r=s.userConfig,a=r.videoPreference,o=s.loadLevelObj||s.levels[s.currentLevel];(a||o)&&(a=ct({},a),o.videoCodec&&(a.videoCodec=o.videoCodec),o.videoRange&&(a.allowedVideoRanges=[o.videoRange]));let l=s.audioTracks[s.audioTrack],u=s.subtitleTracks[s.subtitleTrack],c=0;if(this.primaryLive||t.appendInPlace){let T=this.timelinePos-e.timelineStart;if(T>1){let L=e.duration;L&&T<L&&(c=T)}}let h=e.identifier,d=at(at({},r),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:h,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:c,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:l||r.audioPreference,subtitlePreference:u||r.subtitlePreference});t.appendInPlace&&(t.appendInPlaceStarted=!0,e.timelineStart&&(d.timelineOffset=e.timelineStart));let A=d.cmcd;A!=null&&A.sessionId&&A.contentId&&(d.cmcd=ct({},A,{contentId:ai(e.uri)})),this.getAssetPlayer(h)&&this.warn(`Duplicate date range identifier ${t} and asset ${h}`);let f=new ln(this.HlsPlayerClass,d,t,e);this.playerQueue.push(f),t.assetList[i]=e;let p=T=>{if(T.live){let k=new Error(`Interstitials MUST be VOD assets ${t}`),R={fatal:!0,type:G.OTHER_ERROR,details:w.INTERSTITIAL_ASSET_ITEM_ERROR,error:k};this.handleAssetItemError(R,t,this.schedule.findEventIndex(t.identifier),i,k.message);return}let L=T.edge-T.fragmentStart,I=e.duration;(I===null||L>I)&&(this.log(`Interstitial asset "${h}" duration change ${I} > ${L}`),e.duration=L,this.updateSchedule())};f.on(g.LEVEL_UPDATED,(T,{details:L})=>p(L)),f.on(g.LEVEL_PTS_UPDATED,(T,{details:L})=>p(L));let m=(T,L)=>{let I=this.getAssetPlayer(h);if(I&&L.tracks){I.off(g.BUFFER_CODECS,m),I.tracks=L.tracks;let k=this.primaryMedia;this.bufferingAsset===I.assetItem&&k&&!I.media&&this.bufferAssetPlayer(I,k)}};f.on(g.BUFFER_CODECS,m);let v=()=>{var T;let L=this.getAssetPlayer(h);if(this.log(`buffered to end of asset ${L}`),!L)return;let I=this.schedule.findEventIndex(t.identifier),k=t.findAssetIndex(e),R=k+1,D=(T=this.schedule.items)==null?void 0:T[I];if(this.isInterstitial(D))if(k!==-1&&!t.isAssetPastPlayoutLimit(R)&&!t.assetList[R].error)this.bufferedToItem(D,R);else{var O;let P=(O=this.schedule.items)==null?void 0:O[I+1];P&&this.bufferedToItem(P)}};f.on(g.BUFFERED_TO_END,v);let b=T=>()=>{if(!this.getAssetPlayer(h))return;this.shouldPlay=!0;let I=this.schedule.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,I,T)};return f.once(g.MEDIA_ENDED,b(i)),f.once(g.PLAYOUT_LIMIT_REACHED,b(1/0)),f.on(g.ERROR,(T,L)=>{let I=this.getAssetPlayer(h);if(L.details===w.BUFFER_STALLED_ERROR){if(I!=null&&I.media){let k=I.currentTime,R=I.duration-k;k&&t.appendInPlace&&R/I.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${h} ${t} at ${I.media.currentTime}`),v()):(this.warn(`Stalled at ${k} of ${k+R} in asset ${h} ${t}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(L,t,this.schedule.findEventIndex(t.identifier),i,`Asset player error ${L.error} ${t}`)}),f.on(g.DESTROYING,()=>{if(!this.getAssetPlayer(h))return;let L=new Error(`Asset player destroyed unexpectedly ${h}`),I={fatal:!0,type:G.OTHER_ERROR,details:w.INTERSTITIAL_ASSET_ITEM_ERROR,error:L};this.handleAssetItemError(I,t,this.schedule.findEventIndex(t.identifier),i,L.message)}),this.hls.trigger(g.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:e,assetListIndex:i,event:t,player:f}),f}clearInterstitial(t,e){t.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,e)}),t.reset()}clearAssetPlayer(t,e){let i=this.getAssetPlayerQueueIndex(t);if(i!==-1){this.log(`clearAssetPlayer "${t}" toSegment: ${e&&ge(e)}`);let s=this.playerQueue[i];this.transferMediaFromPlayer(s,e),this.playerQueue.splice(i,1),s.destroy()}}emptyPlayerQueue(){let t;for(;t=this.playerQueue.pop();)t.destroy();this.playerQueue=[]}startAssetPlayer(t,e,i,s,r){let{interstitial:a,assetItem:o,assetId:l}=t,u=a.assetList.length,c=this.playingAsset;this.endedAsset=null,this.playingAsset=o,(!c||c.identifier!==l)&&(c&&(this.clearAssetPlayer(c.identifier,i[s]),delete c.error),this.log(`INTERSTITIAL_ASSET_STARTED ${e+1}/${u} ${t}`),this.hls.trigger(g.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:e,event:a,schedule:i.slice(0),scheduleIndex:s,player:t})),this.bufferAssetPlayer(t,r)}bufferAssetPlayer(t,e){var i,s;let{interstitial:r,assetItem:a,assetId:o}=t,l=this.schedule.findEventIndex(r.identifier),u=(i=this.schedule.items)==null?void 0:i[l];if(!u)return;this.setBufferingItem(u),this.bufferingAsset=a;let c=this.getBufferingPlayer();if(c===t)return;let h=r.appendInPlace;if(h&&(c==null?void 0:c.interstitial.appendInPlace)===!1)return;let d=(c==null?void 0:c.tracks)||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(h&&a!==this.playingAsset){if(!t.tracks)return;if(d&&!Po(d,t.tracks)){let A=new Error(`Asset "${o}" SourceBuffer tracks ('${Object.keys(t.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`),f={fatal:!0,type:G.OTHER_ERROR,details:w.INTERSTITIAL_ASSET_ITEM_ERROR,error:A},p=r.findAssetIndex(a);this.handleAssetItemError(f,r,l,p,A.message);return}}this.transferMediaTo(t,e)}handleAssetItemError(t,e,i,s,r){if(t.details===w.BUFFER_STALLED_ERROR)return;let a=e.assetList[s]||null,o=null;if(a){let h=this.getAssetPlayerQueueIndex(a.identifier);o=this.playerQueue[h]||null}let l=this.schedule.items,u=ct({},t,{fatal:!1,errorAction:ci(!0),asset:a,assetListIndex:s,event:e,schedule:l,scheduleIndex:i,player:o});if(this.warn(`Asset item error: ${t.error}`),this.hls.trigger(g.INTERSTITIAL_ASSET_ERROR,u),!t.fatal)return;let c=new Error(r);a&&(this.playingAsset!==a&&this.clearAssetPlayer(a.identifier,null),a.error=c),e.assetList.some(h=>!h.error)?e.appendInPlace&&(e.error=c):e.error=c,this.primaryFallback(e)}primaryFallback(t){let e=t.timelineStart,i=this.effectivePlayingItem;if(this.updateSchedule(),i){this.log(`Fallback to primary from event "${t.identifier}" start: ${e} pos: ${this.timelinePos} playing: ${i?ge(i):"<none>"} error: ${t.error}`),t.appendInPlace&&(this.attachPrimary(e,null),this.flushFrontBuffer(e));let s=this.timelinePos;s===-1&&(s=this.hls.startPosition);let r=this.updateItem(i,s);if(this.itemsMatch(i,r))this.clearInterstitial(t,null);else{let a=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(a)}}else this.checkStart()}onAssetListLoaded(t,e){var i;let s=e.event,r=s.identifier,a=e.assetListResponse.ASSETS;if(!this.schedule.hasEvent(r))return;let o=s.timelineStart,l=s.duration,u=0;a.forEach((f,p)=>{let m=parseFloat(f.DURATION);this.createAsset(s,p,u,o+u,m,f.URI),u+=m}),s.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${l}) ${s}`);let c=this.waitingItem,h=(c==null?void 0:c.event.identifier)===r;this.updateSchedule();let d=(i=this.bufferingItem)==null?void 0:i.event;if(h){var A;let f=this.schedule.findEventIndex(r),p=(A=this.schedule.items)==null?void 0:A[f];if(p){if(!this.playingItem&&this.timelinePos>p.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==f){s.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${s}`),this.primaryFallback(s);return}this.setBufferingItem(p)}this.setSchedulePosition(f)}else if((d==null?void 0:d.identifier)===r&&d.appendInPlace){let f=s.assetList[0],p=this.getAssetPlayer(f.identifier),m=this.primaryMedia;f&&p&&m&&this.bufferAssetPlayer(p,m)}}onError(t,e){switch(e.details){case w.ASSET_LIST_PARSING_ERROR:case w.ASSET_LIST_LOAD_ERROR:case w.ASSET_LIST_LOAD_TIMEOUT:{let i=e.interstitial;i&&this.primaryFallback(i);break}case w.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}},mo=500,dn=class extends Ai{constructor(t,e,i){super(t,e,i,"subtitle-stream-controller",W.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();let{hls:t}=this;t.on(g.LEVEL_LOADED,this.onLevelLoaded,this),t.on(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(g.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(g.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();let{hls:t}=this;t.off(g.LEVEL_LOADED,this.onLevelLoaded,this),t.off(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(g.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(g.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(t,e){this.stopLoad(),this.state=U.IDLE,this.setInterval(mo),this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(t,e){this.tracksBuffered=[],super.onMediaDetaching(t,e)}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){let{frag:i,success:s}=e;if(xt(i)&&(this.fragPrevious=i),this.state=U.IDLE,!s)return;let r=this.tracksBuffered[this.currentTrackId];if(!r)return;let a,o=i.start;for(let u=0;u<r.length;u++)if(o>=r[u].start&&o<=r[u].end){a=r[u];break}let l=i.start+i.duration;a?a.end=l:(a={start:o,end:l},r.push(a)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(t,e){let{startOffset:i,endOffset:s}=e;if(i===0&&s!==Number.POSITIVE_INFINITY){let r=s-1;if(r<=0)return;e.endOffsetSubtitles=Math.max(0,r),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=r){a.shift();continue}else if(a[o].start<r)a[o].start=r;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(i,r,W.SUBTITLE)}}onError(t,e){let i=e.frag;(i==null?void 0:i.type)===W.SUBTITLE&&(e.details===w.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==U.STOPPED&&(this.state=U.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:e}){if(this.levels&&bl(this.levels,e)){this.levels=e.map(i=>new De(i));return}this.tracksBuffered=[],this.levels=e.map(i=>{let s=new De(i);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,W.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(t,e){var i;if(this.currentTrackId=e.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}let s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==U.STOPPED&&this.setInterval(mo)}onSubtitleTrackLoaded(t,e){var i;let{currentTrackId:s,levels:r}=this,{details:a,id:o}=e;if(!r){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}let l=r[o];if(o>=r.length||!l)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(a.live||(i=l.details)!=null&&i.live){let h=this.mainDetails;if(a.deltaUpdateFailed||!h)return;let d=h.fragments[0];if(!l.details)a.hasProgramDateTime&&h.hasProgramDateTime?(ls(a,h),u=a.fragmentStart):d&&(u=d.start,Mr(a,u));else{var c;u=this.alignPlaylists(a,l.details,(c=this.levelLastLoaded)==null?void 0:c.details),u===0&&d&&(u=d.start,Mr(a,u))}}l.details=a,this.levelLastLoaded=l,o===s&&(this.hls.trigger(g.SUBTITLE_TRACK_UPDATED,{details:a,id:o,groupId:e.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===U.IDLE&&(we(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(t){let{frag:e,payload:i}=t,s=e.decryptdata,r=this.hls;if(!this.fragContextChanged(e)&&i&&i.byteLength>0&&s!=null&&s.key&&s.iv&&Ge(s.method)){let a=performance.now();this.decrypter.decrypt(new Uint8Array(i),s.key.buffer,s.iv.buffer,Nn(s.method)).catch(o=>{throw r.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:e}),o}).then(o=>{let l=performance.now();r.trigger(g.FRAG_DECRYPTED,{frag:e,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=U.IDLE})}}doTick(){if(!this.media){this.state=U.IDLE;return}if(this.state===U.IDLE){let{currentTrackId:t,levels:e}=this,i=e==null?void 0:e[t];if(!i||!e.length||!i.details||this.waitForLive(i))return;let{config:s}=this,r=this.getLoadPosition(),a=Q.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,s.maxBufferHole),{end:o,len:l}=a,u=i.details,c=this.hls.maxBufferLength+u.levelTargetDuration;if(l>c)return;let h=u.fragments,d=h.length,A=u.edge,f=null,p=this.fragPrevious;if(o<A){let b=s.maxFragLookUpTolerance,T=o>A-b?0:b;f=we(p,h,Math.max(h[0].start,o),T),!f&&p&&p.start<h[0].start&&(f=h[0])}else f=h[d-1];if(f=this.filterReplacedPrimary(f,i.details),!f)return;let m=f.sn-u.startSN,v=h[m-1];if(v&&v.cc===f.cc&&this.fragmentTracker.getState(v)===yt.NOT_LOADED&&(f=v),this.fragmentTracker.getState(f)===yt.NOT_LOADED){let b=this.mapToInitFragWhenRequired(f);b&&this.loadFragment(b,i,o)}}}loadFragment(t,e,i){xt(t)?super.loadFragment(t,e,i):this._loadInitSegment(t,e)}get mediaBufferTimeRanges(){return new An(this.tracksBuffered[this.currentTrackId]||[])}},An=class{constructor(t){this.buffered=void 0;let e=(i,s,r)=>{if(s=s>>>0,s>r-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${r})`);return t[s][i]};this.buffered={get length(){return t.length},end(i){return e("end",i,t.length)},start(i){return e("start",i,t.length)}}}},Md={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Dl=n=>String.fromCharCode(Md[n]||n),Kt=15,ce=100,_d={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Nd={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Fd={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Ud={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Bd=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],fn=class{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){let i=typeof e=="function"?e():e;it.log(`${this.time} [${t}] ${i}`)}}},Ie=function(t){let e=[];for(let i=0;i<t.length;i++)e.push(t[i].toString(16));return e},vs=class{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){let e=["foreground","underline","italics","background","flash"];for(let i=0;i<e.length;i++){let s=e[i];t.hasOwnProperty(s)&&(this[s]=t[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}},gn=class{constructor(){this.uchar=" ",this.penState=new vs}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}},pn=class{constructor(t){this.chars=[],this.pos=0,this.currPenState=new vs,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<ce;e++)this.chars.push(new gn);this.logger=t}equals(t){for(let e=0;e<ce;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<ce;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<ce;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>ce&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=ce)}moveCursor(t){let e=this.pos+t;if(t>1)for(let i=this.pos+1;i<e+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();let e=Dl(t);if(this.pos>=ce){this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1)}clearFromPos(t){let e;for(e=t;e<ce;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){let t=[],e=!0;for(let i=0;i<ce;i++){let s=this.chars[i].uchar;s!==" "&&(e=!1),t.push(s)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}},oi=class{constructor(t){this.rows=[],this.currRow=Kt-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<Kt;e++)this.rows.push(new pn(t));this.logger=t}reset(){for(let t=0;t<Kt;t++)this.rows[t].clear();this.currRow=Kt-1}equals(t){let e=!0;for(let i=0;i<Kt;i++)if(!this.rows[i].equals(t.rows[i])){e=!1;break}return e}copy(t){for(let e=0;e<Kt;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<Kt;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+ft(t));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let o=0;o<Kt;o++)this.rows[o].clear();let r=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){let o=a.rows[r].cueStartTime,l=this.logger.time;if(o!==null&&l!==null&&o<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[e-this.nrRollUpRows+u+1].copy(a.rows[r+u])}}this.currRow=e;let i=this.rows[this.currRow];if(t.indent!==null){let r=t.indent,a=Math.max(r-1,0);i.setCursor(t.indent),t.color=i.chars[a].penState.foreground}let s={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+ft(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());let t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;let e=[],i="",s=-1;for(let r=0;r<Kt;r++){let a=this.rows[r].getTextString();a&&(s=r+1,t?e.push("Row "+s+": '"+a+"'"):e.push(a.trim()))}return e.length>0&&(t?i="["+e.join(" | ")+"]":i=e.join(`
`)),i}getTextAndFormat(){return this.rows}},ys=class{constructor(t,e,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new oi(i),this.nonDisplayedMemory=new oi(i),this.lastOutputScreen=new oi(i),this.currRollUpRow=this.displayedMemory.rows[Kt-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Kt-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let i=0;i<t.length;i++)this.writeScreen.insertChar(t[i]);let e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>e+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){let t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){let e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{let i=Math.floor(t/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=s[i]}this.logger.log(2,"MIDROW: "+ft(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){let e=this.logger.time;e!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=e:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}},Ts=class{constructor(t,e,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=zd(),this.logger=void 0;let s=this.logger=new fn;this.channels=[null,new ys(t,e,s),new ys(t+1,i,s)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){this.logger.time=t;for(let i=0;i<e.length;i+=2){let s=e[i]&127,r=e[i+1]&127,a=!1,o=null;if(s===0&&r===0)continue;this.logger.log(3,()=>"["+Ie([e[i],e[i+1]])+"] -> ("+Ie([s,r])+")");let l=this.cmdHistory;if(s>=16&&s<=31){if(Vd(s,r,l)){zi(null,null,l),this.logger.log(3,()=>"Repeated command ("+Ie([s,r])+") is dropped");continue}zi(s,r,this.cmdHistory),a=this.parseCmd(s,r),a||(a=this.parseMidrow(s,r)),a||(a=this.parsePAC(s,r)),a||(a=this.parseBackgroundAttributes(s,r))}else zi(null,null,l);if(!a&&(o=this.parseChars(s,r),o)){let c=this.currentChannel;c&&c>0?this.channels[c].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Ie([s,r])+" orig: "+Ie([e[i],e[i+1]]))}}parseCmd(t,e){let i=(t===20||t===28||t===21||t===29)&&e>=32&&e<=47,s=(t===23||t===31)&&e>=33&&e<=35;if(!(i||s))return!1;let r=t===20||t===21||t===23?1:2,a=this.channels[r];return t===20||t===21||t===28||t===29?e===32?a.ccRCL():e===33?a.ccBS():e===34?a.ccAOF():e===35?a.ccAON():e===36?a.ccDER():e===37?a.ccRU(2):e===38?a.ccRU(3):e===39?a.ccRU(4):e===40?a.ccFON():e===41?a.ccRDC():e===42?a.ccTR():e===43?a.ccRTD():e===44?a.ccEDM():e===45?a.ccCR():e===46?a.ccENM():e===47&&a.ccEOC():a.ccTO(e-32),this.currentChannel=r,!0}parseMidrow(t,e){let i=0;if((t===17||t===25)&&e>=32&&e<=47){if(t===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;let s=this.channels[i];return s?(s.ccMIDROW(e),this.logger.log(3,()=>"MIDROW ("+Ie([t,e])+")"),!0):!1}return!1}parsePAC(t,e){let i,s=(t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127,r=(t===16||t===24)&&e>=64&&e<=95;if(!(s||r))return!1;let a=t<=23?1:2;e>=64&&e<=95?i=a===1?_d[t]:Fd[t]:i=a===1?Nd[t]:Ud[t];let o=this.channels[a];return o?(o.setPAC(this.interpretPAC(i,e)),this.currentChannel=a,!0):!1}interpretPAC(t,e){let i,s={color:null,italics:!1,indent:null,underline:!1,row:t};return e>95?i=e-96:i=e-64,s.underline=(i&1)===1,i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((i-16)/2)*4,s}parseChars(t,e){let i,s=null,r=null;if(t>=25?(i=2,r=t-8):(i=1,r=t),r>=17&&r<=19){let a;r===17?a=e+80:r===18?a=e+112:a=e+144,this.logger.log(2,()=>"Special char '"+Dl(a)+"' in channel "+i),s=[a]}else t>=32&&t<=127&&(s=e===0?[t]:[t,e]);return s&&this.logger.log(3,()=>"Char codes =  "+Ie(s).join(",")),s}parseBackgroundAttributes(t,e){let i=(t===16||t===24)&&e>=32&&e<=47,s=(t===23||t===31)&&e>=45&&e<=47;if(!(i||s))return!1;let r,a={};t===16||t===24?(r=Math.floor((e-32)/2),a.background=Bd[r],e%2===1&&(a.background=a.background+"_semi")):e===45?a.background="transparent":(a.foreground="black",e===47&&(a.underline=!0));let o=t<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){let e=this.channels[t];e&&e.reset()}zi(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){let i=this.channels[e];i&&i.cueSplitAtTime(t)}}};function zi(n,t,e){e.a=n,e.b=t}function Vd(n,t,e){return e.a===n&&e.b===t}function zd(){return{a:null,b:null}}var Xn=function(){if(os!=null&&os.VTTCue)return self.VTTCue;let n=["","lr","rl"],t=["start","middle","end","left","right"];function e(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;let u=l.toLowerCase();return~o.indexOf(u)?u:!1}function i(o){return e(n,o)}function s(o){return e(t,o)}function r(o,...l){let u=1;for(;u<arguments.length;u++){let c=arguments[u];for(let h in c)o[h]=c[h]}return o}function a(o,l,u){let c=this,h={enumerable:!0};c.hasBeenReset=!1;let d="",A=!1,f=o,p=l,m=u,v=null,b="",T=!0,L="auto",I="start",k=50,R="middle",D=50,O="middle";Object.defineProperty(c,"id",r({},h,{get:function(){return d},set:function(P){d=""+P}})),Object.defineProperty(c,"pauseOnExit",r({},h,{get:function(){return A},set:function(P){A=!!P}})),Object.defineProperty(c,"startTime",r({},h,{get:function(){return f},set:function(P){if(typeof P!="number")throw new TypeError("Start time must be set to a number.");f=P,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",r({},h,{get:function(){return p},set:function(P){if(typeof P!="number")throw new TypeError("End time must be set to a number.");p=P,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",r({},h,{get:function(){return m},set:function(P){m=""+P,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",r({},h,{get:function(){return v},set:function(P){v=P,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",r({},h,{get:function(){return b},set:function(P){let V=i(P);if(V===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=V,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",r({},h,{get:function(){return T},set:function(P){T=!!P,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",r({},h,{get:function(){return L},set:function(P){if(typeof P!="number"&&P!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");L=P,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",r({},h,{get:function(){return I},set:function(P){let V=s(P);if(!V)throw new SyntaxError("An invalid or illegal string was specified.");I=V,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",r({},h,{get:function(){return k},set:function(P){if(P<0||P>100)throw new Error("Position must be between 0 and 100.");k=P,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",r({},h,{get:function(){return R},set:function(P){let V=s(P);if(!V)throw new SyntaxError("An invalid or illegal string was specified.");R=V,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",r({},h,{get:function(){return D},set:function(P){if(P<0||P>100)throw new Error("Size must be between 0 and 100.");D=P,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",r({},h,{get:function(){return O},set:function(P){let V=s(P);if(!V)throw new SyntaxError("An invalid or illegal string was specified.");O=V,this.hasBeenReset=!0}})),c.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}(),mn=class{decode(t,e){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}};function wl(n){function t(i,s,r,a){return(i|0)*3600+(s|0)*60+(r|0)+parseFloat(a||0)}let e=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return e?parseFloat(e[2])>59?t(e[2],e[3],0,e[4]):t(e[1],e[2],e[3],e[4]):null}var vn=class{constructor(){this.values=Object.create(null)}set(t,e){!this.get(t)&&e!==""&&(this.values[t]=e)}get(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,i){for(let s=0;s<i.length;++s)if(e===i[s]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){let i=parseFloat(e);if(i>=0&&i<=100)return this.set(t,i),!0}return!1}};function Ol(n,t,e,i){let s=i?n.split(i):[n];for(let r in s){if(typeof s[r]!="string")continue;let a=s[r].split(e);if(a.length!==2)continue;let o=a[0],l=a[1];t(o,l)}}var yn=new Xn(0,0,""),Wi=yn.align==="middle"?"middle":"center";function Wd(n,t,e){let i=n;function s(){let o=wl(n);if(o===null)throw new Error("Malformed timestamp: "+i);return n=n.replace(/^[^\sa-zA-Z-]+/,""),o}function r(o,l){let u=new vn;Ol(o,function(d,A){let f;switch(d){case"region":for(let p=e.length-1;p>=0;p--)if(e[p].id===A){u.set(d,e[p].region);break}break;case"vertical":u.alt(d,A,["rl","lr"]);break;case"line":f=A.split(","),u.integer(d,f[0]),u.percent(d,f[0])&&u.set("snapToLines",!1),u.alt(d,f[0],["auto"]),f.length===2&&u.alt("lineAlign",f[1],["start",Wi,"end"]);break;case"position":f=A.split(","),u.percent(d,f[0]),f.length===2&&u.alt("positionAlign",f[1],["start",Wi,"end","line-left","line-right","auto"]);break;case"size":u.percent(d,A);break;case"align":u.alt(d,A,["start",Wi,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let c=u.get("line","auto");c==="auto"&&yn.line===-1&&(c=-1),l.line=c,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",Wi);let h=u.get("position","auto");h==="auto"&&yn.position===50&&(h=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=h}function a(){n=n.replace(/^\s+/,"")}if(a(),t.startTime=s(),a(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);n=n.slice(3),a(),t.endTime=s(),a(),r(n,t)}function kl(n){return n.replace(/<br(?: \/)?>/gi,`
`)}var Tn=class{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new mn,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){let e=this;t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));function i(){let r=e.buffer,a=0;for(r=kl(r);a<r.length&&r[a]!=="\r"&&r[a]!==`
`;)++a;let o=r.slice(0,a);return r[a]==="\r"&&++a,r[a]===`
`&&++a,e.buffer=r.slice(a),o}function s(r){Ol(r,function(a,o){},/:/)}try{let r="";if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;r=i();let o=r.match(/^(Ã¯Â»Â¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let a=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(a?a=!1:r=i(),e.state){case"HEADER":/:/.test(r)?s(r):r||(e.state="ID");continue;case"NOTE":r||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){e.state="NOTE";break}if(!r)continue;if(e.cue=new Xn(0,0,""),e.state="CUE",r.indexOf("-->")===-1){e.cue.id=r;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{Wd(r,e.cue,e.regionList)}catch(o){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{let o=r.indexOf("-->")!==-1;if(!r||o&&(a=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(e.cue===null)continue;e.cue.text&&(e.cue.text+=`
`),e.cue.text+=r}continue;case"BADCUE":r||(e.state="ID")}}}catch(r){e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){let t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this}},Gd=/\r\n|\n\r|\n|\r/g,hr=function(t,e,i=0){return t.slice(i,i+e.length)===e},Hd=function(t){let e=parseInt(t.slice(-3)),i=parseInt(t.slice(-6,-4)),s=parseInt(t.slice(-9,-7)),r=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!z(e)||!z(i)||!z(s)||!z(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return e+=1e3*i,e+=60*1e3*s,e+=60*60*1e3*r,e};function qn(n,t,e){return ai(n.toString())+ai(t.toString())+ai(e)}var Xd=function(t,e,i){let s=t[e],r=t[s.prevCC];if(!r||!r.new&&s.new){t.ccOffset=t.presentationOffset=s.start,s.new=!1;return}for(;(a=r)!=null&&a.new;){var a;t.ccOffset+=s.start-r.start,s.new=!1,s=r,r=t[s.prevCC]}t.presentationOffset=i};function qd(n,t,e,i,s,r,a){let o=new Tn,l=Ut(new Uint8Array(n)).trim().replace(Gd,`
`).split(`
`),u=[],c=t?_h(t.baseTime,t.timescale):0,h="00:00.000",d=0,A=0,f,p=!0;o.oncue=function(m){let v=e[i],b=e.ccOffset,T=(d-c)/9e4;if(v!=null&&v.new&&(A!==void 0?b=e.ccOffset=v.start:Xd(e,i,T)),T){if(!t){f=new Error("Missing initPTS for VTT MPEGTS");return}b=T-e.presentationOffset}let L=m.endTime-m.startTime,I=Wt((m.startTime+b-A)*9e4,s*9e4)/9e4;m.startTime=Math.max(I,0),m.endTime=Math.max(I+L,0);let k=m.text.trim();m.text=decodeURIComponent(encodeURIComponent(k)),m.id||(m.id=qn(m.startTime,m.endTime,k)),m.endTime>0&&u.push(m)},o.onparsingerror=function(m){f=m},o.onflush=function(){if(f){a(f);return}r(u)},l.forEach(m=>{if(p)if(hr(m,"X-TIMESTAMP-MAP=")){p=!1,m.slice(16).split(",").forEach(v=>{hr(v,"LOCAL:")?h=v.slice(6):hr(v,"MPEGTS:")&&(d=parseInt(v.slice(7)))});try{A=Hd(h)/1e3}catch(v){f=v}return}else m===""&&(p=!1);o.parse(m+`
`)}),o.flush()}var dr="stpp.ttml.im1t",Ml=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,_l=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,jd={left:"start",center:"center",right:"end",start:"start",end:"end"};function vo(n,t,e,i){let s=Z(new Uint8Array(n),["mdat"]);if(s.length===0){i(new Error("Could not parse IMSC1 mdat"));return}let r=s.map(o=>Ut(o)),a=Mh(t.baseTime,1,t.timescale);try{r.forEach(o=>e(Kd(o,a)))}catch(o){i(o)}}function Kd(n,t){let s=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");let r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(r).reduce((h,d)=>(h[d]=s.getAttribute(`ttp:${d}`)||r[d],h),{}),o=s.getAttribute("xml:space")!=="preserve",l=yo(Ar(s,"styling","style")),u=yo(Ar(s,"layout","region")),c=Ar(s,"body","[begin]");return[].map.call(c,h=>{let d=Nl(h,o);if(!d||!h.hasAttribute("begin"))return null;let A=gr(h.getAttribute("begin"),a),f=gr(h.getAttribute("dur"),a),p=gr(h.getAttribute("end"),a);if(A===null)throw To(h);if(p===null){if(f===null)throw To(h);p=A+f}let m=new Xn(A-t,p-t,d);m.id=qn(m.startTime,m.endTime,m.text);let v=u[h.getAttribute("region")],b=l[h.getAttribute("style")],T=Zd(v,b,l),{textAlign:L}=T;if(L){let I=jd[L];I&&(m.lineAlign=I),m.align=L}return ct(m,T),m}).filter(h=>h!==null)}function Ar(n,t,e){let i=n.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(e)):[]}function yo(n){return n.reduce((t,e)=>{let i=e.getAttribute("xml:id");return i&&(t[i]=e),t},{})}function Nl(n,t){return[].slice.call(n.childNodes).reduce((e,i,s)=>{var r;return i.nodeName==="br"&&s?e+`
`:(r=i.childNodes)!=null&&r.length?Nl(i,t):t?e+i.textContent.trim().replace(/\s+/g," "):e+i.textContent},"")}function Zd(n,t,e){let i="http://www.w3.org/ns/ttml#styling",s=null,r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return a&&e.hasOwnProperty(a)&&(s=e[a]),r.reduce((o,l)=>{let u=fr(t,i,l)||fr(n,i,l)||fr(s,i,l);return u&&(o[l]=u),o},{})}function fr(n,t,e){return n&&n.hasAttributeNS(t,e)?n.getAttributeNS(t,e):null}function To(n){return new Error(`Could not parse ttml timestamp ${n}`)}function gr(n,t){if(!n)return null;let e=wl(n);return e===null&&(Ml.test(n)?e=Yd(n,t):_l.test(n)&&(e=Qd(n,t))),e}function Yd(n,t){let e=Ml.exec(n),i=(e[4]|0)+(e[5]|0)/t.subFrameRate;return(e[1]|0)*3600+(e[2]|0)*60+(e[3]|0)+i/t.frameRate}function Qd(n,t){let e=_l.exec(n),i=Number(e[1]);switch(e[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}var We=class{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,i){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}},bn=class{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Eo(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(g.FRAG_LOADING,this.onFragLoading,this),t.on(g.FRAG_LOADED,this.onFragLoaded,this),t.on(g.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(g.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(g.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(g.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){let{hls:t}=this;t.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(g.FRAG_LOADING,this.onFragLoading,this),t.off(g.FRAG_LOADED,this.onFragLoaded,this),t.off(g.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(g.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(g.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(g.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){let t=new We(this,"textTrack1"),e=new We(this,"textTrack2"),i=new We(this,"textTrack3"),s=new We(this,"textTrack4");this.cea608Parser1=new Ts(1,t,e),this.cea608Parser2=new Ts(3,i,s)}addCues(t,e,i,s,r){let a=!1;for(let o=r.length;o--;){let l=r[o],u=Jd(l[0],l[1],e,i);if(u>=0&&(l[0]=Math.min(l[0],e),l[1]=Math.max(l[1],i),a=!0,u/(i-e)>.5))return}if(a||r.push([e,i]),this.config.renderTextTracksNatively){let o=this.captionsTracks[t];this.Cues.newCue(o,e,i,s)}else{let o=this.Cues.newCue(null,e,i,s);this.hls.trigger(g.CUES_PARSED,{type:"captions",cues:o,track:t})}}onInitPtsFound(t,{frag:e,id:i,initPTS:s,timescale:r}){let{unparsedVttFrags:a}=this;i===W.MAIN&&(this.initPTS[e.cc]={baseTime:s,timescale:r}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(g.FRAG_LOADED,o)}))}getExistingTrack(t,e){let{media:i}=this;if(i)for(let s=0;s<i.textTracks.length;s++){let r=i.textTracks[s];if(bo(r,{name:t,lang:e,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;let{captionsProperties:e,captionsTracks:i,media:s}=this,{label:r,languageCode:a}=e[t],o=this.getExistingTrack(r,a);if(o)i[t]=o,ze(i[t]),Rl(i[t],s);else{let l=this.createTextTrack("captions",r,a);l&&(l[t]=!0,i[t]=l)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;let e=this.captionsProperties[t];if(!e)return;let i=e.label,s={_id:t,label:i,kind:"captions",default:e.media?!!e.media.default:!1,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=s,this.hls.trigger(g.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(t,e,i){let s=this.media;if(!!s)return s.addTextTrack(t,e,i)}onMediaAttaching(t,e){this.media=e.media,e.mediaSource||this._cleanTracks()}onMediaDetaching(t,e){let i=!!e.transferMedia;if(this.media=null,i)return;let{captionsTracks:s}=this;Object.keys(s).forEach(r=>{ze(s[r]),delete s[r]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Eo(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){let{media:t}=this;if(!t)return;let e=t.textTracks;if(e)for(let i=0;i<e.length;i++)ze(e[i])}onSubtitleTracksUpdated(t,e){let i=e.subtitleTracks||[],s=i.some(r=>r.textCodec===dr);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(bl(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){let a=this.media,o=a?Ki(a.textTracks):null;if(this.tracks.forEach((l,u)=>{let c;if(o){let h=null;for(let d=0;d<o.length;d++)if(o[d]&&bo(o[d],l)){h=o[d],o[d]=null;break}h&&(c=h)}if(c)ze(c);else{let h=Fl(l);c=this.createTextTrack(h,l.name,l.lang),c&&(c.mode="disabled")}c&&this.textTracks.push(c)}),o!=null&&o.length){let l=o.filter(u=>u!==null).map(u=>u.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){let a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(g.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(i=>{let s=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!s)return;let r=`textTrack${s[1]}`,a=this.captionsProperties[r];!a||(a.label=i.name,i.lang&&(a.languageCode=i.lang),a.media=i)})}closedCaptionsForLevel(t){let e=this.hls.levels[t.level];return e==null?void 0:e.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){if(this.enabled&&e.frag.type===W.MAIN){var i,s;let{cea608Parser1:r,cea608Parser2:a,lastSn:o}=this,{cc:l,sn:u}=e.frag,c=(i=(s=e.part)==null?void 0:s.index)!=null?i:-1;r&&a&&(u!==o+1||u===o&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(r.reset(),a.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}}onFragLoaded(t,e){let{frag:i,payload:s}=e;if(i.type===W.SUBTITLE)if(s.byteLength){let r=i.decryptdata,a="stats"in e;if(r==null||!r.encrypted||a){let o=this.tracks[i.level],l=this.vttCCs;l[i.cc]||(l[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),o&&o.textCodec===dr?this._parseIMSC1(i,s):this._parseVTTs(e)}}else this.hls.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){let i=this.hls;vo(e,this.initPTS[t.cc],s=>{this._appendCues(s,t.level),i.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},s=>{i.logger.log(`Failed to parse IMSC1: ${s}`),i.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:s})})}_parseVTTs(t){var e;let{frag:i,payload:s}=t,{initPTS:r,unparsedVttFrags:a}=this,o=r.length-1;if(!r[i.cc]&&o===-1){a.push(t);return}let l=this.hls,u=(e=i.initSegment)!=null&&e.data?Ht(i.initSegment.data,new Uint8Array(s)).buffer:s;qd(u,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,c=>{this._appendCues(c,i.level),l.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},c=>{let h=c.message==="Missing initPTS for VTT MPEGTS";h?a.push(t):this._fallbackToIMSC1(i,s),l.logger.log(`Failed to parse VTT cue: ${c}`),!(h&&o>i.cc)&&l.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:c})})}_fallbackToIMSC1(t,e){let i=this.tracks[t.level];i.textCodec||vo(e,this.initPTS[t.cc],()=>{i.textCodec=dr,this._parseIMSC1(t,e)},()=>{i.textCodec="wvtt"})}_appendCues(t,e){let i=this.hls;if(this.config.renderTextTracksNatively){let s=this.textTracks[e];if(!s||s.mode==="disabled")return;t.forEach(r=>Pl(s,r))}else{let s=this.tracks[e];if(!s)return;let r=s.default?"default":"subtitles"+e;i.trigger(g.CUES_PARSED,{type:"subtitles",cues:t,track:r})}}onFragDecrypted(t,e){let{frag:i}=e;i.type===W.SUBTITLE&&this.onFragLoaded(g.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){if(!this.enabled||!this.config.enableCEA708Captions)return;let{frag:i,samples:s}=e;if(!(i.type===W.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let r=0;r<s.length;r++){let a=s[r].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();let o=this.extractCea608Data(a);this.cea608Parser1.addData(s[r].pts,o[0]),this.cea608Parser2.addData(s[r].pts,o[1])}}}onBufferFlushing(t,{startOffset:e,endOffset:i,endOffsetSubtitles:s,type:r}){let{media:a}=this;if(!(!a||a.currentTime<i)){if(!r||r==="video"){let{captionsTracks:o}=this;Object.keys(o).forEach(l=>rn(o[l],e,i))}if(this.config.renderTextTracksNatively&&e===0&&s!==void 0){let{textTracks:o}=this;Object.keys(o).forEach(l=>rn(o[l],e,s))}}}extractCea608Data(t){let e=[[],[]],i=t[0]&31,s=2;for(let r=0;r<i;r++){let a=t[s++],o=127&t[s++],l=127&t[s++];if(o===0&&l===0)continue;if((4&a)!==0){let c=3&a;(c===0||c===1)&&(e[c].push(o),e[c].push(l))}}return e}};function Fl(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function bo(n,t){return!!n&&n.kind===Fl(t)&&jr(t,n)}function Jd(n,t,e,i){return Math.min(t,i)-Math.max(n,e)}function Eo(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}var $d=/\s/,tA={newCue(n,t,e,i){let s=[],r,a,o,l,u,c=self.VTTCue||self.TextTrackCue;for(let d=0;d<i.rows.length;d++)if(r=i.rows[d],o=!0,l=0,u="",!r.isEmpty()){var h;for(let p=0;p<r.chars.length;p++)$d.test(r.chars[p].uchar)&&o?l++:(u+=r.chars[p].uchar,o=!1);r.cueStartTime=t,t===e&&(e+=1e-4),l>=16?l--:l++;let A=kl(u.trim()),f=qn(t,e,A);n!=null&&(h=n.cues)!=null&&h.getCueById(f)||(a=new c(t,e,A),a.id=f,a.line=d+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),s.push(a))}return n&&s.length&&(s.sort((d,A)=>d.line==="auto"||A.line==="auto"?0:d.line>8&&A.line>8?A.line-d.line:d.line-A.line),s.forEach(d=>Pl(n,d))),s}};function eA(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(n){}return!1}var iA=/(\d+)-(\d+)\/(\d+)/,bs=class{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||aA,this.controller=new self.AbortController,this.stats=new li}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,i){let s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();let r=sA(t,this.controller.signal),a=t.responseType==="arraybuffer",o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,r),self.clearTimeout(this.requestTimeout),e.timeout=l&&z(l)?l:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,t,this.response))},e.timeout),(mi(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(h=>{var d;this.response=this.loader=h;let A=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,t,this.response))},u-(A-s.loading.start)),!h.ok){let{status:p,statusText:m}=h;throw new En(m||"fetch, bad network response",p,h)}s.loading.first=A,s.total=nA(h.headers)||s.total;let f=(d=this.callbacks)==null?void 0:d.onProgress;return f&&z(e.highWaterMark)?this.loadProgressively(h,s,t,e.highWaterMark,f):a?h.arrayBuffer():t.responseType==="json"?h.json():h.text()}).then(h=>{var d,A;let f=this.response;if(!f)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);let p=h[o];p&&(s.loaded=s.total=p);let m={url:f.url,data:h,code:f.status},v=(d=this.callbacks)==null?void 0:d.onProgress;v&&!z(e.highWaterMark)&&v(s,t,h,f),(A=this.callbacks)==null||A.onSuccess(m,s,t,f)}).catch(h=>{var d;if(self.clearTimeout(this.requestTimeout),s.aborted)return;let A=h&&h.code||0,f=h?h.message:null;(d=this.callbacks)==null||d.onError({code:A,text:f},t,h?h.details:null,s)})}getCacheAge(){let t=null;if(this.response){let e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,i,s=0,r){let a=new us,o=t.body.getReader(),l=()=>o.read().then(u=>{if(u.done)return a.dataLength&&r(e,i,a.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));let c=u.value,h=c.length;return e.loaded+=h,h<s||a.dataLength?(a.push(c),a.dataLength>=s&&r(e,i,a.flush().buffer,t)):r(e,i,c.buffer,t),l()}).catch(()=>Promise.reject());return l()}};function sA(n,t){let e={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(ct({},n.headers))};return n.rangeEnd&&e.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),e}function rA(n){let t=iA.exec(n);if(t)return parseInt(t[2])-parseInt(t[1])+1}function nA(n){let t=n.get("Content-Range");if(t){let i=rA(t);if(z(i))return i}let e=n.get("Content-Length");if(e)return parseInt(e)}function aA(n,t){return new self.Request(n.url,t)}var En=class extends Error{constructor(t,e,i){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=i}},oA=/^age:\s*[\d.]+\s*$/im,Es=class{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new li,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){let t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.loadInternal()}loadInternal(){let{config:t,context:e}=this;if(!t||!e)return;let i=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;let r=this.xhrSetup;r?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return r(i,e.url)}).catch(a=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",e.url,!0),r(i,e.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,e,t)}).catch(a=>{var o;(o=this.callbacks)==null||o.onError({code:i.status,text:a.message},e,i,s)}):this.openAndSendXhr(i,e,t)}openAndSendXhr(t,e,i){t.readyState||t.open("GET",e.url,!0);let s=e.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:a}=i.loadPolicy;if(s)for(let o in s)t.setRequestHeader(o,s[o]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),i.timeout=r&&z(r)?r:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),t.send()}readystatechange(){let{context:t,loader:e,stats:i}=this;if(!t||!e)return;let s=e.readyState,r=this.config;if(!i.aborted&&s>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;let u=e.status,c=e.responseType==="text"?e.responseText:null;if(u>=200&&u<300){let f=c!=null?c:e.response;if(f!=null){var a,o;i.loading.end=Math.max(self.performance.now(),i.loading.first);let p=e.responseType==="arraybuffer"?f.byteLength:f.length;i.loaded=i.total=p,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);let m=(a=this.callbacks)==null?void 0:a.onProgress;m&&m(i,t,f,e);let v={url:e.responseURL,data:f,code:u};(o=this.callbacks)==null||o.onSuccess(v,i,t,e);return}}let h=r.loadPolicy.errorRetry,d=i.retry,A={url:t.url,data:void 0,code:u};if(rs(h,d,!1,A))this.retry(h);else{var l;it.error(`${u} while loading ${t.url}`),(l=this.callbacks)==null||l.onError({code:u,text:e.statusText},t,e,i)}}}loadtimeout(){if(!this.config)return;let t=this.config.loadPolicy.timeoutRetry,e=this.stats.retry;if(rs(t,e,!0))this.retry(t);else{var i;it.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);let s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(t){let{context:e,stats:i}=this;this.retryDelay=_n(t,i.retry),i.retry++,it.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${e==null?void 0:e.url}, retrying ${i.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){let e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&oA.test(this.loader.getAllResponseHeaders())){let e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}},lA={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},uA=at(at({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:Es,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:xr,bufferController:Qr,capLevelController:Ti,errorController:Sr,fpsController:sn,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:qo,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,certLoadPolicy:{default:lA},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},cA()),{},{subtitleStreamController:dn,subtitleTrackController:nn,timelineController:bn,audioStreamController:qr,audioTrackController:Kr,emeController:ve,cmcdController:tn,contentSteeringController:en,interstitialsController:hn});function cA(){return{cueHandler:tA,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function hA(n,t,e){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');let i=xn(n),s=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(a=>{let o=`${a==="level"?"playlist":a}LoadPolicy`,l=t[o]===void 0,u=[];r.forEach(c=>{let h=`${a}Loading${c}`,d=t[h];if(d!==void 0&&l){u.push(h);let A=i[o].default;switch(t[o]={default:A},c){case"TimeOut":A.maxLoadTimeMs=d,A.maxTimeToFirstByteMs=d;break;case"MaxRetry":A.errorRetry.maxNumRetry=d,A.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":A.errorRetry.retryDelayMs=d,A.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":A.errorRetry.maxRetryDelayMs=d,A.timeoutRetry.maxRetryDelayMs=d;break}}}),u.length&&e.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${o}": ${ft(t[o])}`)}),at(at({},i),t)}function xn(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(xn):Object.keys(n).reduce((t,e)=>(t[e]=xn(n[e]),t),{}):n}function dA(n,t){let e=n.loader;e!==bs&&e!==Es?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):eA()&&(n.loader=bs,n.progressive=!0,n.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}var Zi=2,AA=.1,fA=.05,gA=100,Sn=class extends ns{constructor(t,e){super("gap-controller",t.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(g.MEDIA_ENDED,{stalled:!1})}},this.hls=t,this.fragmentTracker=e,this.registerListeners()}registerListeners(){let{hls:t}=this;t&&(t.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){let{hls:t}=this;t&&(t.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(t,e){this.setInterval(gA),this.mediaSource=e.mediaSource;let i=this.media=e.media;de(i,"playing",this.onMediaPlaying),de(i,"waiting",this.onMediaWaiting),de(i,"ended",this.onMediaEnded)}onMediaDetaching(t,e){this.clearInterval();let{media:i}=this;i&&(ae(i,"playing",this.onMediaPlaying),ae(i,"waiting",this.onMediaWaiting),ae(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(t,e){this.buffered=e.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var t;if(!((t=this.media)!=null&&t.readyState)||!this.hasBuffered)return;let e=this.media.currentTime;this.poll(e,this.lastCurrentTime),this.lastCurrentTime=e}poll(t,e){var i,s;let r=(i=this.hls)==null?void 0:i.config;if(!r)return;let{media:a,stalled:o}=this;if(!a)return;let{seeking:l}=a,u=this.seeking&&!l,c=!this.seeking&&l,h=a.paused&&!l||a.ended||a.playbackRate===0;if(this.seeking=l,t!==e){e&&(this.ended=0),this.moved=!0,l||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!h&&t>e&&this.nudgeOnVideoHole(t,e)),this.waiting===0&&this.stallResolved(t);return}if(c||u){u&&this.stallResolved(t);return}if(h){this.nudgeRetry=0,this.stallResolved(t),!this.ended&&a.ended&&this.hls&&(this.ended=t||1,this.hls.trigger(g.MEDIA_ENDED,{stalled:!1}));return}if(!Q.getBuffered(a).length){this.nudgeRetry=0;return}let d=Q.bufferInfo(a,t,0),A=d.nextStart||0,f=this.fragmentTracker;if(l&&f&&this.hls){let k=xo(this.hls.inFlightFragments,t),R=d.len>Zi,D=!A||k||A-t>Zi&&!f.getPartialFragment(t);if(R||D)return;this.moved=!1}let p=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&f){if(!(d.len>0)&&!A)return;let R=Math.max(A,d.start||0)-t,O=!!(p!=null&&p.live)?p.targetduration*2:Zi,P=f.getPartialFragment(t);if(R>0&&(R<=O||P)){a.paused||this._trySkipBufferHole(P);return}}let m=r.detectStallWithCurrentTimeMs,v=self.performance.now(),b=this.waiting;if(o===null){b>0&&v-b<m?this.stalled=b:this.stalled=v;return}let T=v-o;if(!l&&(T>=m||b)&&this.hls){var L;if(((L=this.mediaSource)==null?void 0:L.readyState)==="ended"&&!(p!=null&&p.live)&&Math.abs(t-((p==null?void 0:p.edge)||0))<1){if(this.ended)return;this.ended=t||1,this.hls.trigger(g.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(d),!this.media||!this.hls)return}let I=Q.bufferInfo(a,t,r.maxBufferHole);this._tryFixBufferStall(I,T)}stallResolved(t){let e=this.stalled;if(e&&this.hls&&(this.stalled=null,this.stallReported)){let i=self.performance.now()-e;this.log(`playback not stuck anymore @${t}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(g.STALL_RESOLVED,{})}}nudgeOnVideoHole(t,e){var i;let s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&s&&s.length>1&&t>s.end(0)){let r=Q.bufferedInfo(Q.timeRangesToArray(this.buffered.audio),t,0);if(r.len>1&&e>=r.start){let a=Q.timeRangesToArray(s),o=Q.bufferedInfo(a,e,0).bufferedIndex;if(o>-1&&o<a.length-1){let l=Q.bufferedInfo(a,t,0).bufferedIndex,u=a[o].end,c=a[o+1].start;if((l===-1||l>o)&&c-u<1&&t-u<2){let h=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${t} hole: ${u} -> ${c} buffered index: ${l}`);this.warn(h.message),this.media.currentTime+=1e-6;let d=this.fragmentTracker.getPartialFragment(t)||void 0,A=Q.bufferInfo(this.media,t,0);this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:d,buffer:A.len,bufferInfo:A})}}}}}_tryFixBufferStall(t,e){var i,s;let{fragmentTracker:r,media:a}=this,o=(i=this.hls)==null?void 0:i.config;if(!a||!r||!o)return;let l=a.currentTime,u=(s=this.hls)==null?void 0:s.latestLevelDetails,c=r.getPartialFragment(l);if((c||u!=null&&u.live&&l<u.fragmentStart)&&(this._trySkipBufferHole(c)||!this.media))return;let h=t.buffered;(h&&h.length>1&&t.len>o.maxBufferHole||t.nextStart&&t.nextStart-l<o.maxBufferHole)&&(e>o.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(t))}_reportStall(t){let{hls:e,media:i,stallReported:s,stalled:r}=this;if(!s&&r!==null&&i&&e){this.stallReported=!0;let a=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${ft(t)})`);this.warn(a.message),e.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:t.len,bufferInfo:t,stalled:{start:r}})}}_trySkipBufferHole(t){var e;let{fragmentTracker:i,media:s}=this,r=(e=this.hls)==null?void 0:e.config;if(!s||!i||!r)return 0;let a=s.currentTime,o=Q.bufferInfo(s,a,0),l=a<o.start?o.start:o.nextStart;if(l&&this.hls){let c=o.len<=r.maxBufferHole,h=o.len>0&&o.len<1&&s.readyState<3,d=l-a;if(d>0&&(c||h)){if(d>r.maxBufferHole){let f=!1;if(a===0){let p=i.getAppendedFrag(0,W.MAIN);p&&l<p.end&&(f=!0)}if(!f){let p=t||i.getAppendedFrag(a,W.MAIN);if(p){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||xo(this.hls.inFlightFragments,l))return 0;let v=!1,b=p.end;for(;b<l;){let T=i.getPartialFragment(b);if(T)b+=T.duration;else{v=!0;break}}if(v)return 0}}}let A=Math.max(l+fA,a+AA);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${A}`),this.moved=!0,s.currentTime=A,!(t!=null&&t.gap)){let f=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${A}`);this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:f,reason:f.message,frag:t||void 0,buffer:o.len,bufferInfo:o})}return A}}return 0}_tryNudgeBuffer(t){let{hls:e,media:i,nudgeRetry:s}=this,r=e==null?void 0:e.config;if(!i||!r)return 0;let a=i.currentTime;if(this.nudgeRetry++,s<r.nudgeMaxRetry){let o=a+(s+1)*r.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${a} to ${o}`);this.warn(l.message),i.currentTime=o,e.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:t.len,bufferInfo:t})}else{let o=new Error(`Playhead still not moving while enough data buffered @${a} after ${r.nudgeMaxRetry} nudges`);this.error(o.message),e.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.BUFFER_STALLED_ERROR,error:o,fatal:!0,buffer:t.len,bufferInfo:t})}}};function xo(n,t){let e=So(n.main);if(e&&e.start<=t)return e;let i=So(n.audio);return i&&i.start<=t?i:null}function So(n){if(!n)return null;switch(n.state){case U.IDLE:case U.STOPPED:case U.ENDED:case U.ERROR:return null}return n.frag}var pA=.25;function Ln(){if(typeof self!="undefined")return self.VTTCue||self.TextTrackCue}function Lo(n,t,e,i,s){let r=new n(t,e,"");try{r.value=i,s&&(r.type=s)}catch(a){r=new n(t,e,ft(s?at({type:s},i):i))}return r}var Gi=(()=>{let n=Ln();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function mA(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var In=class{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{!this.hls||this.hls.trigger(g.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){let{hls:t}=this;t.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(g.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(g.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){let{hls:t}=this;t.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(g.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(g.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(t,e){var i;this.media=e.media,((i=e.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){let t=this.hls.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(t,e){this.media=null,!e.transferMedia&&(this.id3Track&&(this.removeCues&&ze(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){let e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(!!this.media){for(let e=0;e<t.length;e++){let i=t[e];if(i.kind==="metadata"&&i.label==="id3")return Rl(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media)return;let{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:s}}}=this;if(!i&&!s)return;let{samples:r}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));let a=Ln();if(!!a)for(let o=0;o<r.length;o++){let l=r[o].type;if(l===Ft.emsg&&!i||!s)continue;let u=cl(r[o].data);if(u){let c=r[o].pts,h=c+r[o].duration;h>Gi&&(h=Gi),h-c<=0&&(h=c+pA);for(let A=0;A<u.length;A++){let f=u[A];if(!hl(f)){this.updateId3CueEnds(c,l);let p=Lo(a,c,h,f,l);p&&this.id3Track.addCue(p)}}}}}updateId3CueEnds(t,e){var i;let s=(i=this.id3Track)==null?void 0:i.cues;if(s)for(let r=s.length;r--;){let a=s[r];a.type===e&&a.startTime<t&&a.endTime===Gi&&(a.endTime=t)}}onBufferFlushing(t,{startOffset:e,endOffset:i,type:s}){let{id3Track:r,hls:a}=this;if(!a)return;let{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(r&&(o||l)){let u;s==="audio"?u=c=>c.type===Ft.audioId3&&l:s==="video"?u=c=>c.type===Ft.emsg&&o:u=c=>c.type===Ft.audioId3&&l||c.type===Ft.emsg&&o,rn(r,e,i,u)}}onLevelUpdated(t,{details:e}){this.updateDateRangeCues(e,!0)}onLevelPtsUpdated(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)}updateDateRangeCues(t,e){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;let{id3Track:i}=this,{dateRanges:s}=t,r=Object.keys(s),a=this.dateRangeCuesAppended;if(i&&e){var o;if((o=i.cues)!=null&&o.length){let c=Object.keys(a).filter(h=>!r.includes(h));for(let h=c.length;h--;){let d=c[h],A=a[d].cues;delete a[d],Object.keys(A).forEach(f=>{try{let p=A[f];p.removeEventListener("enter",this.onEventCueEnter),i.removeCue(p)}catch(p){}})}}else a=this.dateRangeCuesAppended={}}let l=t.fragments[t.fragments.length-1];if(r.length===0||!z(l==null?void 0:l.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));let u=Ln();for(let c=0;c<r.length;c++){let h=r[c],d=s[h],A=d.startTime,f=a[h],p=(f==null?void 0:f.cues)||{},m=(f==null?void 0:f.durationKnown)||!1,v=Gi,{duration:b,endDate:T}=d;if(T&&b!==null)v=A+b,m=!0;else if(d.endOnNext&&!m){let I=r.reduce((k,R)=>{if(R!==d.id){let D=s[R];if(D.class===d.class&&D.startDate>d.startDate&&(!k||d.startDate<k.startDate))return D}return k},null);I&&(v=I.startTime,m=!0)}let L=Object.keys(d.attr);for(let I=0;I<L.length;I++){let k=L[I];if(!Dc(k))continue;let R=p[k];if(R)m&&!f.durationKnown?R.endTime=v:Math.abs(R.startTime-A)>.01&&(R.startTime=A,R.endTime=v);else if(u){let D=d.attr[k];wc(k)&&(D=mA(D));let P=Lo(u,A,v,{key:k,data:D},Ft.dateRange);P&&(P.id=h,this.id3Track.addCue(P),p[k]=P,this.hls.config.interstitialsController&&(k==="X-ASSET-LIST"||k==="X-ASSET-URL")&&P.addEventListener("enter",this.onEventCueEnter))}}a[h]={cues:p,dateRange:d,durationKnown:m}}}},Rn=class{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{let{media:e}=this,i=this.levelDetails;if(!e||!i)return;this.currentTime=e.currentTime;let s=this.computeLatency();if(s===null)return;this._latency=s;let{lowLatencyMode:r,maxLiveSyncPlaybackRate:a}=this.config;if(!r||a===1||!i.live)return;let o=this.targetLatency;if(o===null)return;let l=s-o,u=Math.min(this.maxLatency,o+i.targetduration);if(l<u&&l>.05&&this.forwardBufferLength>1){let h=Math.min(2,Math.max(1,a)),d=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,A=Math.min(h,Math.max(1,d));this.changeMediaPlaybackRate(e,A)}else e.playbackRate!==1&&e.playbackRate!==0&&this.changeMediaPlaybackRate(e,1)},this.hls=t,this.config=t.config,this.registerListeners()}get levelDetails(){var t;return((t=this.hls)==null?void 0:t.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){let{config:t}=this;if(t.liveMaxLatencyDuration!==void 0)return t.liveMaxLatencyDuration;let e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){let t=this.levelDetails;if(t===null||this.hls===null)return null;let{holdBack:e,partHoldBack:i,targetduration:s}=t,{liveSyncDuration:r,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig,u=o&&i||e;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=r!==void 0?r:a*s);let c=s;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)}set targetLatency(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}get liveSyncPosition(){let t=this.estimateLiveEdge(),e=this.targetLatency;if(t===null||e===null)return null;let i=this.levelDetails;if(i===null)return null;let s=i.edge,r=t-e-this.edgeStalled,a=s-i.totalduration,o=s-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(a,r),o)}get drift(){let t=this.levelDetails;return t===null?1:t.drift}get edgeStalled(){let t=this.levelDetails;if(t===null)return 0;let e=(this.config.lowLatencyMode&&t.partTarget||t.targetduration)*3;return Math.max(t.age-e,0)}get forwardBufferLength(){let{media:t}=this,e=this.levelDetails;if(!t||!e)return 0;let i=t.buffered.length;return(i?t.buffered.end(i-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){let{hls:t}=this;!t||(t.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(g.ERROR,this.onError,this))}unregisterListeners(){let{hls:t}=this;!t||(t.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(g.ERROR,this.onError,this))}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){e.advanced&&this.onTimeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(t,e){var i;e.details===w.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(t,e){var i,s;t.playbackRate!==e&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${t.playbackRate} to ${e}`),t.playbackRate=e)}estimateLiveEdge(){let t=this.levelDetails;return t===null?null:t.edge+t.age}computeLatency(){let t=this.estimateLiveEdge();return t===null?null:t-this.currentTime}},Pn=class extends vi{constructor(t,e){super(t,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){let{hls:t}=this;t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(g.LEVEL_LOADED,this.onLevelLoaded,this),t.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(g.FRAG_BUFFERED,this.onFragBuffered,this),t.on(g.ERROR,this.onError,this)}_unregisterListeners(){let{hls:t}=this;t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(g.LEVEL_LOADED,this.onLevelLoaded,this),t.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(g.FRAG_BUFFERED,this.onFragBuffered,this),t.off(g.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){let i=this.hls.config.preferManagedMediaSource,s=[],r={},a={},o=!1,l=!1,u=!1;e.levels.forEach(c=>{var h;let d=c.attrs,{audioCodec:A,videoCodec:f}=c;A&&(c.audioCodec=A=$i(A,i)||void 0),((h=f)==null?void 0:h.indexOf("avc1"))===0&&(f=c.videoCodec=rc(f));let{width:p,height:m,unknownCodecs:v}=c,b=v?v.length:0;if(v)for(let V=b;V--;){let y=v[V];this.isAudioSupported(y)?(c.audioCodec=A=A?`${A},${y}`:y,b--,qe.audio[A.substring(0,4)]=2):this.isVideoSupported(y)&&(c.videoCodec=f=f?`${f},${y}`:y,b--,qe.video[f.substring(0,4)]=2)}if(o||(o=!!(p&&m)),l||(l=!!f),u||(u=!!A),b||A&&!this.isAudioSupported(A)||f&&!this.isVideoSupported(f)){this.log(`Some or all CODECS not supported "${d.CODECS}"`);return}let{CODECS:T,"FRAME-RATE":L,"HDCP-LEVEL":I,"PATHWAY-ID":k,RESOLUTION:R,"VIDEO-RANGE":D}=d,P=`${`${k||"."}-`}${c.bitrate}-${R}-${L}-${T}-${D}-${I}`;if(r[P])if(r[P].uri!==c.url&&!c.attrs["PATHWAY-ID"]){let V=a[P]+=1;c.attrs["PATHWAY-ID"]=new Array(V+1).join(".");let y=this.createLevel(c);r[P]=y,s.push(y)}else r[P].addGroupId("audio",d.AUDIO),r[P].addGroupId("text",d.SUBTITLES);else{let V=this.createLevel(c);r[P]=V,a[P]=1,s.push(V)}}),this.filterAndSortMediaOptions(s,e,o,l,u)}createLevel(t){let e=new De(t),i=t.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){let s=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(s.message),e.supportedResult=zo(s,[])}return e}isAudioSupported(t){return br(t,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(t){return br(t,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(t,e,i,s,r){let a=[],o=[],l=t;if((i||s)&&r&&(l=l.filter(({videoCodec:m,videoRange:v,width:b,height:T})=>(!!m||!!(b&&T))&&uc(v))),l.length===0){Promise.resolve().then(()=>{if(this.hls){let m="no level with compatible codecs found in manifest",v=m;e.levels.length&&(v=`one or more CODECS in variant not supported: ${ft(e.levels.map(T=>T.attrs.CODECS).filter((T,L,I)=>I.indexOf(T)===L))}`,this.warn(v),m+=` (${v})`);let b=new Error(m);this.hls.trigger(g.ERROR,{type:G.MEDIA_ERROR,details:w.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:b,reason:v})}});return}e.audioTracks&&(a=e.audioTracks.filter(m=>!m.audioCodec||this.isAudioSupported(m.audioCodec)),Io(a)),e.subtitles&&(o=e.subtitles,Io(o));let u=l.slice(0);l.sort((m,v)=>{if(m.attrs["HDCP-LEVEL"]!==v.attrs["HDCP-LEVEL"])return(m.attrs["HDCP-LEVEL"]||"")>(v.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&m.height!==v.height)return m.height-v.height;if(m.frameRate!==v.frameRate)return m.frameRate-v.frameRate;if(m.videoRange!==v.videoRange)return ts.indexOf(m.videoRange)-ts.indexOf(v.videoRange);if(m.videoCodec!==v.videoCodec){let b=La(m.videoCodec),T=La(v.videoCodec);if(b!==T)return T-b}if(m.uri===v.uri&&m.codecSet!==v.codecSet){let b=Ji(m.codecSet),T=Ji(v.codecSet);if(b!==T)return T-b}return m.averageBitrate!==v.averageBitrate?m.averageBitrate-v.averageBitrate:0});let c=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let m=0;m<u.length;m++)if(u[m].pathwayId===l[0].pathwayId){c=u[m];break}}this._levels=l;for(let m=0;m<l.length;m++)if(l[m]===c){var h;this._firstLevel=m;let v=c.bitrate,b=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${v}`),((h=this.hls.userConfig)==null?void 0:h.abrEwmaDefaultEstimate)===void 0){let T=Math.min(v,this.hls.config.abrEwmaDefaultEstimateMax);T>b&&b===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=T)}break}let d=r&&!s,A=this.hls.config,f=!!(A.audioStreamController&&A.audioTrackController),p={levels:l,audioTracks:a,subtitleTracks:o,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:r,video:s,altAudio:f&&!d&&a.some(m=>!!m.url)};this.hls.trigger(g.MANIFEST_PARSED,p)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(t){let e=this._levels;if(e.length===0)return;if(t<0||t>=e.length){let c=new Error("invalid level idx"),h=t<0;if(this.hls.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.LEVEL_SWITCH_ERROR,level:t,fatal:h,error:c,reason:c.message}),h)return;t=Math.min(t,e.length-1)}let i=this.currentLevelIndex,s=this.currentLevel,r=s?s.attrs["PATHWAY-ID"]:void 0,a=e[t],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=a,i===t&&s&&r===o)return;this.log(`Switching to level ${t} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${i}${r?" with Pathway "+r:""}`);let l={level:t,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(g.LEVEL_SWITCHING,l);let u=a.details;if(!u||u.live){let c=this.switchParams(a.uri,s==null?void 0:s.details,u);this.loadPlaylist(c)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(this._startLevel===void 0){let t=this.hls.config.startLevel;return t!==void 0?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(t){if(this.steering){let e=this.steering.pathways(),i=t.filter(s=>e.indexOf(s)!==-1);if(t.length<1){this.warn(`pathwayPriority ${t} should contain at least one pathway from list: ${e}`);return}this.steering.pathwayPriority=i}}onError(t,e){e.fatal||!e.context||e.context.type===tt.LEVEL&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,{frag:e}){if(e!==void 0&&e.type===W.MAIN){let i=e.elementaryStreams;if(!Object.keys(i).some(r=>!!i[r]))return;let s=this._levels[e.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(t,e){var i;let{level:s,details:r}=e,a=e.levelInfo;if(!a){var o;this.warn(`Invalid level index ${s}`),(o=e.deliveryDirectives)!=null&&o.skip&&(r.deltaUpdateFailed=!0);return}if(a===this.currentLevel||e.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let l=a.details;l===e.details&&l.advanced&&(l=void 0),this.playlistLoaded(s,e,l)}else(i=e.deliveryDirectives)!=null&&i.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);let i=this.getUrlWithDirectives(t.uri,e),s=this.currentLevelIndex,r=t.attrs["PATHWAY-ID"],a=t.details,o=a==null?void 0:a.age;this.log(`Loading level index ${s}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""}${r?" Pathway "+r:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(g.LEVEL_LOADING,{url:i,level:s,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;if(this._levels.length===1)return;let i=this._levels.filter((r,a)=>a!==t?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(o=>o.level=-1)),!1));tl(i),this._levels=i,this.currentLevelIndex>-1&&(e=this.currentLevel)!=null&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);let s=i.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(g.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(t,{levels:e}){this._levels=e}checkMaxAutoUpdated(){let{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(g.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}};function Io(n){let t={};n.forEach(e=>{let i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++})}function Ul(){return self.SourceBuffer||self.WebKitSourceBuffer}function Bl(){if(!ye())return!1;let t=Ul();return!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function"}function vA(){if(!Bl())return!1;let n=ye();return typeof(n==null?void 0:n.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>n.isTypeSupported(ui(t,"video")))||["mp4a.40.2","fLaC"].some(t=>n.isTypeSupported(ui(t,"audio"))))}function yA(){var n;let t=Ul();return typeof(t==null||(n=t.prototype)==null?void 0:n.changeType)=="function"}var TA=100,Cn=class extends Ai{constructor(t,e,i){super(t,e,i,"stream-controller",W.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{let s=this.media,r=s?s.currentTime:null;if(r===null||!z(r)||(this.log(`Media seeked to ${r.toFixed(3)}`),!this.getBufferedFrag(r)))return;let a=this.getFwdBufferInfoAtPos(s,r,W.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${r} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();let{hls:t}=this;t.on(g.MANIFEST_PARSED,this.onManifestParsed,this),t.on(g.LEVEL_LOADING,this.onLevelLoading,this),t.on(g.LEVEL_LOADED,this.onLevelLoaded,this),t.on(g.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(g.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(g.BUFFER_CREATED,this.onBufferCreated,this),t.on(g.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(g.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();let{hls:t}=this;t.off(g.MANIFEST_PARSED,this.onManifestParsed,this),t.off(g.LEVEL_LOADED,this.onLevelLoaded,this),t.off(g.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(g.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(g.BUFFER_CREATED,this.onBufferCreated,this),t.off(g.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(g.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(t,e){if(this.levels){let{lastCurrentTime:i,hls:s}=this;if(this.stopLoad(),this.setInterval(TA),this.level=-1,!this.startFragRequested){let r=s.startLevel;r===-1&&(s.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=s.firstAutoLevel),s.nextLoadLevel=r,this.level=s.loadLevel,this._hasEnoughToStart=!!e}i>0&&t===-1&&!e&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),t=i),this.state=U.IDLE,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}else this._forceStartLoad=!0,this.state=U.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case U.WAITING_LEVEL:{let{levels:e,level:i}=this,s=e==null?void 0:e[i],r=s==null?void 0:s.details;if(r&&(!r.live||this.levelLastLoaded===s&&!this.waitForLive(s))){if(this.waitForCdnTuneIn(r))break;this.state=U.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=U.IDLE;break}break}case U.FRAG_LOADING_WAITING_RETRY:{var t;let e=self.performance.now(),i=this.retryDate;if(!i||e>=i||(t=this.media)!=null&&t.seeking){let{levels:s,level:r}=this,a=s==null?void 0:s[r];this.resetStartWhenNotLoaded(a||null),this.state=U.IDLE}}break}this.state===U.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var t;super.onTickEnd(),(t=this.media)!=null&&t.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){let{hls:t,levelLastLoaded:e,levels:i,media:s}=this;if(e===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!t.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;let r=this.buffering?t.nextLoadLevel:t.loadLevel;if(!(i!=null&&i[r]))return;let a=i[r],o=this.getMainFwdBufferInfo();if(o===null)return;let l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){let p={};this.altAudio===2&&(p.type="video"),this.hls.trigger(g.BUFFER_EOS,p),this.state=U.ENDED;return}if(!this.buffering)return;t.loadLevel!==r&&t.manualLevel===-1&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=t.nextLoadLevel=r;let u=a.details;if(!u||this.state===U.WAITING_LEVEL||this.waitForLive(a)){this.level=r,this.state=U.WAITING_LEVEL,this.startFragRequested=!1;return}let c=o.len,h=this.getMaxBufferLength(a.maxBitrate);if(c>=h)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);let d=this.backtrackFragment?this.backtrackFragment.start:o.end,A=this.getNextFragment(d,u);if(this.couldBacktrack&&!this.fragPrevious&&A&&xt(A)&&this.fragmentTracker.getState(A)!==yt.OK){var f;let m=((f=this.backtrackFragment)!=null?f:A).sn-u.startSN,v=u.fragments[m-1];v&&A.cc===v.cc&&(A=v,this.fragmentTracker.removeFragment(v))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(A&&this.isLoopLoading(A,d)){if(!A.gap){let m=this.audioOnly&&!this.altAudio?ut.AUDIO:ut.VIDEO,v=(m===ut.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;v&&this.afterBufferFlushed(v,m,W.MAIN)}A=this.getNextFragmentLoopLoading(A,u,o,W.MAIN,h)}!A||(A.initSegment&&!A.initSegment.data&&!this.bitrateTest&&(A=A.initSegment),this.loadFragment(A,a,d))}loadFragment(t,e,i){let s=this.fragmentTracker.getState(t);s===yt.NOT_LOADED||s===yt.PARTIAL?xt(t)?this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):super.loadFragment(t,e,i):this._loadInitSegment(t,e):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,W.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){let{levels:t,media:e}=this;if(e!=null&&e.readyState){let i,s=this.getAppendedFrag(e.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);let r=this.getLevelDetails();if(r!=null&&r.live){let o=this.getMainFwdBufferInfo();if(!o||o.len<r.targetduration*2)return}if(!e.paused&&t){let o=this.hls.nextLoadLevel,l=t[o],u=this.fragLastKbps;u&&this.fragCurrent?i=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:i=0}else i=0;let a=this.getBufferedFrag(e.currentTime+i);if(a){let o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();let l=o.maxStartPTS?o.maxStartPTS:o.start,u=o.duration,c=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){let t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case U.KEY_LOADING:case U.FRAG_LOADING:case U.FRAG_LOADING_WAITING_RETRY:case U.PARSING:case U.PARSED:this.state=U.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,this.altAudio===2?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);let i=e.media;de(i,"playing",this.onMediaPlaying),de(i,"seeked",this.onMediaSeeked)}onMediaDetaching(t,e){let{media:i}=this;i&&(ae(i,"playing",this.onMediaPlaying),ae(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(t,e),!e.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(g.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(t,e){let i=!1,s=!1;e.levels.forEach(r=>{let a=r.audioCodec;a&&(i=i||a.indexOf("mp4a.40.2")!==-1,s=s||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=i&&s&&!yA(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){let{levels:i}=this;if(!i||this.state!==U.IDLE)return;let s=e.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=U.WAITING_LEVEL)}onLevelLoaded(t,e){var i;let{levels:s,startFragRequested:r}=this,a=e.level,o=e.details,l=o.totalduration;if(!s){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${l}`);let u=e.levelInfo,c=this.fragCurrent;c&&(this.state===U.FRAG_LOADING||this.state===U.FRAG_LOADING_WAITING_RETRY)&&c.level!==e.level&&c.loader&&this.abortCurrentFrag();let h=0;if(o.live||(i=u.details)!=null&&i.live){var d;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;h=this.alignPlaylists(o,u.details,(d=this.levelLastLoaded)==null?void 0:d.details)}if(u.details=o,this.levelLastLoaded=u,r||this.setStartPosition(o,h),this.hls.trigger(g.LEVEL_UPDATED,{details:o,level:a}),this.state===U.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=U.IDLE}r&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}synchronizeToLiveEdge(t){let{config:e,media:i}=this;if(!i)return;let s=this.hls.liveSyncPosition,r=this.getLoadPosition(),a=t.fragmentStart,o=t.edge,l=r>=a-e.maxFragLookUpTolerance&&r<=o;if(s!==null&&i.duration>s&&(r<s||!l)){let u=e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;(!l&&i.readyState<4||r<o-u)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),i.readyState&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${s.toFixed(3)}`),i.currentTime=s))}}_handleFragmentLoadProgress(t){var e;let i=t.frag,{part:s,payload:r}=t,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}let o=a[i.level];if(!o){this.warn(`Level ${i.level} not found on progress`);return}let l=o.details;if(!l){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}let u=o.videoCodec,c=l.PTSKnown||!l.live,h=(e=i.initSegment)==null?void 0:e.data,d=this._getAudioCodec(o),A=this.transmuxer=this.transmuxer||new gs(this.hls,W.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=s?s.index:-1,p=f!==-1,m=new di(i.level,i.sn,i.stats.chunkCount,r.byteLength,f,p),v=this.initPTS[i.cc];A.push(r,h,d,u,i,s,l.totalduration,c,m,v)}onAudioTrackSwitching(t,e){let i=this.hls,s=this.altAudio===2;if(is(e.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;let a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.fragmentTracker.removeAllFragments(),i.once(g.BUFFER_FLUSHED,()=>{var a;(a=this.hls)==null||a.trigger(g.AUDIO_TRACK_SWITCHED,e)}),i.trigger(g.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(g.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){let i=is(e.url,this.hls);if(i){let s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i?2:0,this.tick()}onBufferCreated(t,e){let i=e.tracks,s,r,a=!1;for(let o in i){let l=i[o];if(l.id==="main"){if(r=o,s=l,o==="video"){let u=i[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&s?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){let{frag:i,part:s}=e,r=i.type===W.MAIN;if(r){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===U.PARSED&&(this.state=U.IDLE);return}let o=s?s.stats:i.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),xt(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,s)}let a=this.media;!a||(!this._hasEnoughToStart&&Q.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(t,e){var i;if(e.fatal){this.state=U.ERROR;return}switch(e.details){case w.FRAG_GAP:case w.FRAG_PARSING_ERROR:case w.FRAG_DECRYPT_ERROR:case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(W.MAIN,e);break;case w.LEVEL_LOAD_ERROR:case w.LEVEL_LOAD_TIMEOUT:case w.LEVEL_PARSING_ERROR:!e.levelRetry&&this.state===U.WAITING_LEVEL&&((i=e.context)==null?void 0:i.type)===tt.LEVEL&&(this.state=U.IDLE);break;case w.BUFFER_ADD_CODEC_ERROR:case w.BUFFER_APPEND_ERROR:if(e.parent!=="main")return;this.resetLoadingState();break;case w.BUFFER_FULL_ERROR:if(e.parent!=="main")return;this.reduceLengthAndFlushBuffer(e)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case w.INTERNAL_EXCEPTION:this.recoverWorkerError(e);break}}onFragLoadEmergencyAborted(){this.state=U.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(t,{type:e}){if(e!==ut.AUDIO||!this.altAudio){let i=(e===ut.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,e,W.MAIN),this.tick())}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){let{media:t}=this;if(!t)return;let e=t.currentTime,i=this.startPosition;if(i>=0&&e<i){if(t.seeking){this.log(`could not seek to ${i}, already seeking at ${e}`);return}let s=this.timelineOffset;s&&i&&(i+=s);let r=this.getLevelDetails(),a=Q.getBuffered(t),o=a.length?a.start(0):0,l=o-i,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);l>0&&(l<u||this.loadingParts&&l<2*((r==null?void 0:r.partTarget)||0))&&(this.log(`adjusting start position by ${l} to match buffer start`),i+=l,this.startPosition=i),e<i&&(this.log(`seek to target start position ${i} from current time ${e} buffer start ${o}`),t.currentTime=i)}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e.indexOf("mp4a.40.5")!==-1?e="mp4a.40.2":e="mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then(i=>{let{hls:s}=this,r=i==null?void 0:i.frag;if(!r||this.fragContextChanged(r))return;e.fragmentError=0,this.state=U.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;let a=r.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),s.trigger(g.FRAG_LOADED,i),r.bitrateTest=!1})}_handleTransmuxComplete(t){var e;let i=this.playlistType,{hls:s}=this,{remuxResult:r,chunkMeta:a}=t,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}let{frag:l,part:u,level:c}=o,{video:h,text:d,id3:A,initSegment:f}=r,{details:p}=c,m=this.altAudio?void 0:r.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=U.PARSING,f){if(f!=null&&f.tracks){let T=l.initSegment||l;this._bufferInitSegment(c,f.tracks,T,a),s.trigger(g.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:i,tracks:f.tracks})}let v=f.initPTS,b=f.timescale;z(v)&&(this.initPTS[l.cc]={baseTime:v,timescale:b},s.trigger(g.INIT_PTS_FOUND,{frag:l,id:i,initPTS:v,timescale:b}))}if(h&&p){m&&h.type==="audiovideo"&&this.logMuxedErr(l);let v=p.fragments[l.sn-1-p.startSN],b=l.sn===p.startSN,T=!v||l.cc>v.cc;if(r.independent!==!1){let{startPTS:L,endPTS:I,startDTS:k,endDTS:R}=h;if(u)u.elementaryStreams[h.type]={startPTS:L,endPTS:I,startDTS:k,endDTS:R};else if(h.firstKeyFrame&&h.independent&&a.id===1&&!T&&(this.couldBacktrack=!0),h.dropped&&h.independent){let D=this.getMainFwdBufferInfo(),O=(D?D.end:this.getLoadPosition())+this.config.maxBufferHole,P=h.firstKeyFramePTS?h.firstKeyFramePTS:L;if(!b&&O<P-this.config.maxBufferHole&&!T){this.backtrack(l);return}else T&&(l.gap=!0);l.setElementaryStreamInfo(h.type,l.start,I,l.start,R,!0)}else b&&L-(p.appliedTimelineOffset||0)>Zi&&(l.gap=!0);l.setElementaryStreamInfo(h.type,L,I,k,R),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,u,a,b||T)}else if(b||T)l.gap=!0;else{this.backtrack(l);return}}if(m){let{startPTS:v,endPTS:b,startDTS:T,endDTS:L}=m;u&&(u.elementaryStreams[ut.AUDIO]={startPTS:v,endPTS:b,startDTS:T,endDTS:L}),l.setElementaryStreamInfo(ut.AUDIO,v,b,T,L),this.bufferFragmentData(m,l,u,a)}if(p&&A!=null&&(e=A.samples)!=null&&e.length){let v={id:i,frag:l,details:p,samples:A.samples};s.trigger(g.FRAG_PARSING_METADATA,v)}if(p&&d){let v={id:i,frag:l,details:p,samples:d.samples};s.trigger(g.FRAG_PARSING_USERDATA,v)}}logMuxedErr(t){this.warn(`${xt(t)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${t.url}`)}_bufferInitSegment(t,e,i,s){if(this.state!==U.PARSING)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&(delete e.audio,e.audiovideo&&this.logMuxedErr(i));let{audio:r,video:a,audiovideo:o}=e;if(r){let u=Hi(r.codec,t.audioCodec);u==="mp4a"&&(u="mp4a.40.5");let c=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u.indexOf("mp4a.40.5")!==-1?u="mp4a.40.2":u="mp4a.40.5");let h=r.metadata;h&&"channelCount"in h&&(h.channelCount||1)!==1&&c.indexOf("firefox")===-1&&(u="mp4a.40.5")}u&&u.indexOf("mp4a.40.5")!==-1&&c.indexOf("android")!==-1&&r.container!=="audio/mpeg"&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),t.audioCodec&&t.audioCodec!==u&&this.log(`Swapping manifest audio codec "${t.audioCodec}" for "${u}"`),r.levelCodec=u,r.id=W.MAIN,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${u||""}/${t.audioCodec||""}/${r.codec}]`),delete e.audiovideo}if(a){a.levelCodec=t.videoCodec,a.id=W.MAIN;let u=a.codec;if((u==null?void 0:u.length)===4)switch(u){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${t.videoCodec||""}/${u}]${a.codec!==u?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete e.audiovideo}o&&(this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${t.codecs}/${o.codec}]`),delete e.video,delete e.audio);let l=Object.keys(e);if(l.length){if(this.hls.trigger(g.BUFFER_CODECS,e),!this.hls)return;l.forEach(u=>{let h=e[u].initSegment;h!=null&&h.byteLength&&this.hls.trigger(g.BUFFER_APPENDING,{type:u,data:h,frag:i,part:null,chunkMeta:s,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){let t=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(t,W.MAIN)}get maxBufferLength(){let{levels:t,level:e}=this,i=t==null?void 0:t[e];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=U.IDLE}checkFragmentChanged(){let t=this.media,e=null;if(t&&t.readyState>1&&t.seeking===!1){let i=t.currentTime;if(Q.isBuffered(t,i)?e=this.getAppendedFrag(i):Q.isBuffered(t,i+.1)&&(e=this.getAppendedFrag(i+.1)),e){this.backtrackFragment=null;let s=this.fragPlaying,r=e.level;(!s||e.sn!==s.sn||s.level!==r)&&(this.fragPlaying=e,this.hls.trigger(g.FRAG_CHANGED,{frag:e}),(!s||s.level!==r)&&this.hls.trigger(g.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){let t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t;if(this.fragPlaying)return this.fragPlaying;let e=((t=this.media)==null?void 0:t.currentTime)||this.lastCurrentTime;return z(e)?this.getAppendedFrag(e):null}get currentProgramDateTime(){var t;let e=((t=this.media)==null?void 0:t.currentTime)||this.lastCurrentTime;if(z(e)){let i=this.getLevelDetails(),s=this.currentFrag||(i?we(null,i.fragments,e):null);if(s){let r=s.programDateTime;if(r!==null){let a=r+(e-s.start)*1e3;return new Date(a)}}}return null}get currentLevel(){let t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){let t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}},Dn=class{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(let i in this.keyUriToKeyInfo){let s=this.keyUriToKeyInfo[i].loader;if(s){var e;if(t&&t!==((e=s.context)==null?void 0:e.frag.type))return;s.abort()}}}detach(){for(let t in this.keyUriToKeyInfo){let e=this.keyUriToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}}destroy(){this.detach();for(let t in this.keyUriToKeyInfo){let e=this.keyUriToKeyInfo[t].loader;e&&e.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t,e=w.KEY_LOAD_ERROR,i,s,r){return new Yt({type:G.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:r,error:i,networkDetails:s})}loadClear(t,e){if(this.emeController&&this.config.emeEnabled){let{sn:i,cc:s}=t;for(let r=0;r<e.length;r++){let a=e[r];if(s<=a.cc&&(i==="initSegment"||a.sn==="initSegment"||i<a.sn)){this.emeController.selectKeySystemFormat(a).then(o=>{a.setKeyFormat(o)});break}}}}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then(e=>this.loadInternal(t,e)):this.loadInternal(t)}loadInternal(t,e){var i,s;e&&t.setKeyFormat(e);let r=t.decryptdata;if(!r){let u=new Error(e?`Expected frag.decryptdata to be defined after setting format ${e}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,w.KEY_LOAD_ERROR,u))}let a=r.uri;if(!a)return Promise.reject(this.createKeyLoadError(t,w.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((i=o)!=null&&i.decryptdata.key)return r.key=o.decryptdata.key,Promise.resolve({frag:t,keyInfo:o});if((s=o)!=null&&s.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(u=>(r.key=u.keyInfo.decryptdata.key,{frag:t,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return r.keyFormat==="identity"?this.loadKeyHTTP(o,t):this.loadKeyEME(o,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,t);default:return Promise.reject(this.createKeyLoadError(t,w.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(t,e){let i={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){let s=this.emeController.loadKey(i);if(s)return(t.keyLoadPromise=s.then(r=>(t.mediaKeySessionContext=r,i))).catch(r=>{throw t.keyLoadPromise=null,r})}return Promise.resolve(i)}loadKeyHTTP(t,e){let i=this.config,s=i.loader,r=new s(i);return e.keyLoader=t.loader=r,t.keyLoadPromise=new Promise((a,o)=>{let l={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},u=i.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(d,A,f,p)=>{let{frag:m,keyInfo:v,url:b}=f;if(!m.decryptdata||v!==this.keyUriToKeyInfo[b])return o(this.createKeyLoadError(m,w.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),p));v.decryptdata.key=m.decryptdata.key=new Uint8Array(d.data),m.keyLoader=null,v.loader=null,a({frag:m,keyInfo:v})},onError:(d,A,f,p)=>{this.resetLoader(A),o(this.createKeyLoadError(e,w.KEY_LOAD_ERROR,new Error(`HTTP Error ${d.code} loading key ${d.text}`),f,at({url:l.url,data:void 0},d)))},onTimeout:(d,A,f)=>{this.resetLoader(A),o(this.createKeyLoadError(e,w.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),f))},onAbort:(d,A,f)=>{this.resetLoader(A),o(this.createKeyLoadError(e,w.INTERNAL_ABORTED,new Error("key loading aborted"),f))}};r.load(l,c,h)})}resetLoader(t){let{frag:e,keyInfo:i,url:s}=t,r=i.loader;e.keyLoader===r&&(e.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[s],r&&r.destroy()}};function Ro(n){let{type:t}=n;switch(t){case tt.AUDIO_TRACK:return W.AUDIO;case tt.SUBTITLE_TRACK:return W.SUBTITLE;default:return W.MAIN}}function pr(n,t){let e=n.url;return(e===void 0||e.indexOf("data:")===0)&&(e=t.url),e}var wn=class{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){let{hls:t}=this;t.on(g.MANIFEST_LOADING,this.onManifestLoading,this),t.on(g.LEVEL_LOADING,this.onLevelLoading,this),t.on(g.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(g.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){let{hls:t}=this;t.off(g.MANIFEST_LOADING,this.onManifestLoading,this),t.off(g.LEVEL_LOADING,this.onLevelLoading,this),t.off(g.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(g.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(t){let e=this.hls.config,i=e.pLoader,s=e.loader,r=i||s,a=new r(e);return this.loaders[t.type]=a,a}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(let t in this.loaders){let e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){let{url:i}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:tt.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(t,e){let{id:i,level:s,pathwayId:r,url:a,deliveryDirectives:o,levelInfo:l}=e;this.load({id:i,level:s,pathwayId:r,responseType:"text",type:tt.LEVEL,url:a,deliveryDirectives:o,levelOrTrack:l})}onAudioTrackLoading(t,e){let{id:i,groupId:s,url:r,deliveryDirectives:a,track:o}=e;this.load({id:i,groupId:s,level:null,responseType:"text",type:tt.AUDIO_TRACK,url:r,deliveryDirectives:a,levelOrTrack:o})}onSubtitleTrackLoading(t,e){let{id:i,groupId:s,url:r,deliveryDirectives:a,track:o}=e;this.load({id:i,groupId:s,level:null,responseType:"text",type:tt.SUBTITLE_TRACK,url:r,deliveryDirectives:a,levelOrTrack:o})}onLevelsUpdated(t,e){let i=this.loaders[tt.LEVEL];if(i){let s=i.context;s&&!e.levels.some(r=>r===s.levelOrTrack)&&(i.abort(),delete this.loaders[tt.LEVEL])}}load(t){var e;let i=this.hls.config,s=this.getInternalLoader(t);if(s){let u=this.hls.logger,c=s.context;if(c&&c.levelOrTrack===t.levelOrTrack&&(c.url===t.url||c.deliveryDirectives&&!t.deliveryDirectives)){c.url===t.url?u.log(`[playlist-loader]: ignore ${t.url} ongoing request`):u.log(`[playlist-loader]: ignore ${t.url} in favor of ${c.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),s.abort()}let r;if(t.type===tt.MANIFEST?r=i.manifestLoadPolicy.default:r=ct({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(t),z((e=t.deliveryDirectives)==null?void 0:e.part)){let u;if(t.type===tt.LEVEL&&t.level!==null?u=this.hls.levels[t.level].details:t.type===tt.AUDIO_TRACK&&t.id!==null?u=this.hls.audioTracks[t.id].details:t.type===tt.SUBTITLE_TRACK&&t.id!==null&&(u=this.hls.subtitleTracks[t.id].details),u){let c=u.partTarget,h=u.targetduration;if(c&&h){let d=Math.max(c*3,h*.8)*1e3;r=ct({},r,{maxTimeToFirstByteMs:Math.min(d,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(d,r.maxTimeToFirstByteMs)})}}}let a=r.errorRetry||r.timeoutRetry||{},o={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(u,c,h,d)=>{let A=this.getInternalLoader(h);this.resetInternalLoader(h.type);let f=u.data;if(f.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,h,new Error("no EXTM3U delimiter"),d||null,c);return}c.parsing.start=performance.now(),Gt.isMediaPlaylist(f)||h.type!==tt.MANIFEST?this.handleTrackOrLevelPlaylist(u,c,h,d||null,A):this.handleMasterPlaylist(u,c,h,d)},onError:(u,c,h,d)=>{this.handleNetworkError(c,h,!1,u,d)},onTimeout:(u,c,h)=>{this.handleNetworkError(c,h,!0,void 0,u)}};s.load(t,o,l)}checkAutostartLoad(){if(!this.hls)return;let{config:{autoStartLoad:t,startPosition:e},forceStartLoad:i}=this.hls;(t||i)&&(this.hls.logger.log(`${t?"auto":"force"} startLoad with configured startPosition ${e}`),this.hls.startLoad(e))}handleMasterPlaylist(t,e,i,s){let r=this.hls,a=t.data,o=pr(t,i),l=Gt.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(t,i,l.playlistParsingError,s,e);return}let{contentSteering:u,levels:c,sessionData:h,sessionKeys:d,startTimeOffset:A,variableList:f}=l;this.variableList=f;let{AUDIO:p=[],SUBTITLES:m,"CLOSED-CAPTIONS":v}=Gt.parseMasterPlaylistMedia(a,o,l);p.length&&!p.some(T=>!T.url)&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new dt({}),bitrate:0,url:""})),r.trigger(g.MANIFEST_LOADED,{levels:c,audioTracks:p,subtitles:m,captions:v,contentSteering:u,url:o,stats:e,networkDetails:s,sessionData:h,sessionKeys:d,startTimeOffset:A,variableList:f})}handleTrackOrLevelPlaylist(t,e,i,s,r){let a=this.hls,{id:o,level:l,type:u}=i,c=pr(t,i),h=z(l)?l:z(o)?o:0,d=Ro(i),A=Gt.parseLevelPlaylist(t.data,c,h,d,0,this.variableList);if(u===tt.MANIFEST){let f={attrs:new dt({}),bitrate:0,details:A,name:"",url:c};A.requestScheduled=e.loading.start+Qo(A,0),a.trigger(g.MANIFEST_LOADED,{levels:[f],audioTracks:[],url:c,stats:e,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),i.levelDetails=A,this.handlePlaylistLoaded(A,t,e,i,s,r)}handleManifestParsingError(t,e,i,s,r){this.hls.trigger(g.ERROR,{type:G.NETWORK_ERROR,details:w.MANIFEST_PARSING_ERROR,fatal:e.type===tt.MANIFEST,url:t.url,err:i,error:i,reason:i.message,response:t,context:e,networkDetails:s,stats:r})}handleNetworkError(t,e,i=!1,s,r){let a=`A network ${i?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${t.type}`;t.type===tt.LEVEL?a+=`: ${t.level} id: ${t.id}`:(t.type===tt.AUDIO_TRACK||t.type===tt.SUBTITLE_TRACK)&&(a+=` id: ${t.id} group-id: "${t.groupId}"`);let o=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let l=w.UNKNOWN,u=!1,c=this.getInternalLoader(t);switch(t.type){case tt.MANIFEST:l=i?w.MANIFEST_LOAD_TIMEOUT:w.MANIFEST_LOAD_ERROR,u=!0;break;case tt.LEVEL:l=i?w.LEVEL_LOAD_TIMEOUT:w.LEVEL_LOAD_ERROR,u=!1;break;case tt.AUDIO_TRACK:l=i?w.AUDIO_TRACK_LOAD_TIMEOUT:w.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case tt.SUBTITLE_TRACK:l=i?w.SUBTITLE_TRACK_LOAD_TIMEOUT:w.SUBTITLE_LOAD_ERROR,u=!1;break}c&&this.resetInternalLoader(t.type);let h={type:G.NETWORK_ERROR,details:l,fatal:u,url:t.url,loader:c,context:t,error:o,networkDetails:e,stats:r};if(s){let d=(e==null?void 0:e.url)||t.url;h.response=at({url:d,data:void 0},s)}this.hls.trigger(g.ERROR,h)}handlePlaylistLoaded(t,e,i,s,r,a){let o=this.hls,{type:l,level:u,id:c,groupId:h,deliveryDirectives:d}=s,A=pr(e,s),f=Ro(s),p=typeof s.level=="number"&&f===W.MAIN?u:void 0;if(!t.fragments.length){let v=t.playlistParsingError=new Error("No Segments found in Playlist");o.trigger(g.ERROR,{type:G.NETWORK_ERROR,details:w.LEVEL_EMPTY_ERROR,fatal:!1,url:A,error:v,reason:v.message,response:e,context:s,level:p,parent:f,networkDetails:r,stats:i});return}t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));let m=t.playlistParsingError;if(m){if(this.hls.logger.warn(m),!o.config.ignorePlaylistParsingErrors){o.trigger(g.ERROR,{type:G.NETWORK_ERROR,details:w.LEVEL_PARSING_ERROR,fatal:!1,url:A,error:m,reason:m.message,response:e,context:s,level:p,parent:f,networkDetails:r,stats:i});return}t.playlistParsingError=null}switch(t.live&&a&&(a.getCacheAge&&(t.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),l){case tt.MANIFEST:case tt.LEVEL:o.trigger(g.LEVEL_LOADED,{details:t,levelInfo:s.levelOrTrack||o.levels[0],level:p||0,id:c||0,stats:i,networkDetails:r,deliveryDirectives:d,withoutMultiVariant:l===tt.MANIFEST});break;case tt.AUDIO_TRACK:o.trigger(g.AUDIO_TRACK_LOADED,{details:t,track:s.levelOrTrack,id:c||0,groupId:h||"",stats:i,networkDetails:r,deliveryDirectives:d});break;case tt.SUBTITLE_TRACK:o.trigger(g.SUBTITLE_TRACK_LOADED,{details:t,track:s.levelOrTrack,id:c||0,groupId:h||"",stats:i,networkDetails:r,deliveryDirectives:d});break}}},pt=class{static get version(){return fi}static isMSESupported(){return Bl()}static isSupported(){return vA()}static getMediaSource(){return ye()}static get Events(){return g}static get MetadataSchema(){return Ft}static get ErrorTypes(){return G}static get ErrorDetails(){return w}static get DefaultConfig(){return pt.defaultConfig?pt.defaultConfig:uA}static set DefaultConfig(t){pt.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Un,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;let e=this.logger=Mu(t.debug||!1,"Hls instance",t.assetPlayerId),i=this.config=hA(pt.DefaultConfig,t,e);this.userConfig=t,i.progressive&&dA(i,e);let{abrController:s,bufferController:r,capLevelController:a,errorController:o,fpsController:l}=i,u=new o(this),c=this.abrController=new s(this),h=new Lr(this),d=i.interstitialsController,A=d?this.interstitialsController=new d(this,pt):null,f=this.bufferController=new r(this,h),p=this.capLevelController=new a(this),m=new l(this),v=new wn(this),b=i.contentSteeringController,T=b?new b(this):null,L=this.levelController=new Pn(this,T),I=new In(this),k=new Dn(this.config),R=this.streamController=new Cn(this,h,k),D=this.gapController=new Sn(this,h);p.setStreamController(R),m.setStreamController(R);let O=[v,L,R];A&&O.splice(1,0,A),T&&O.splice(1,0,T),this.networkControllers=O;let P=[c,f,D,p,m,I,h];this.audioTrackController=this.createController(i.audioTrackController,O);let V=i.audioStreamController;V&&O.push(this.audioStreamController=new V(this,h,k)),this.subtitleTrackController=this.createController(i.subtitleTrackController,O);let y=i.subtitleStreamController;y&&O.push(this.subtititleStreamController=new y(this,h,k)),this.createController(i.timelineController,P),k.emeController=this.emeController=this.createController(i.emeController,P),this.cmcdController=this.createController(i.cmcdController,P),this.latencyController=this.createController(Rn,P),this.coreComponents=P,O.push(u);let S=u.onErrorOut;typeof S=="function"&&this.on(g.ERROR,S,u),this.on(g.MANIFEST_LOADED,v.onManifestLoaded,v)}createController(t,e){if(t){let i=new t(this);return e&&e.push(i),i}return null}on(t,e,i=this){this._emitter.on(t,e,i)}once(t,e,i=this){this._emitter.once(t,e,i)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,i=this,s){this._emitter.off(t,e,i,s)}listeners(t){return this._emitter.listeners(t)}emit(t,e,i){return this._emitter.emit(t,e,i)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(i){if(this.logger.error("An internal error happened while handling event "+t+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;let s=t===g.ERROR;this.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,fatal:s,event:t,error:i}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){this.logger.log("destroy"),this.trigger(g.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;let t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){if(!t||"media"in t&&!t.media){let r=new Error(`attachMedia failed: invalid argument (${t})`);this.trigger(g.ERROR,{type:G.OTHER_ERROR,details:w.ATTACH_MEDIA_ERROR,fatal:!0,error:r});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());let e="media"in t,i=e?t.media:t,s=e?t:{media:i};this._media=i,this.trigger(g.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(g.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;let t=this.bufferController.transferMedia();return this.trigger(g.MEDIA_DETACHING,{transferMedia:t}),t}loadSource(t){this.stopLoad();let e=this.media,i=this._url,s=this._url=On.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),e&&i&&(i!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(g.MANIFEST_LOADING,{url:t})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(t=-1,e){this.logger.log(`startLoad(${t+(e?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(t,e),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!(this.started||!this.networkControllers));t++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(t=>{t.resumeBuffering&&t.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(t=>{t.pauseBuffering&&t.pauseBuffering()}))}get inFlightFragments(){let t={[W.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(t[W.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[W.SUBTITLE]=this.subtititleStreamController.inFlightFrag),t}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");let t=this._media,e=t==null?void 0:t.currentTime;this.detachMedia(),t&&(this.attachMedia(t),e&&this.startLoad(e))}removeLevel(t){this.levelController.removeLevel(t)}get sessionId(){let t=this._sessionId;return t||(t=this._sessionId=gh()),t}get levels(){let t=this.levelController.levels;return t||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){this.logger.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){this.logger.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){this.logger.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){this.logger.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){let t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){this.logger.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){let e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){let{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get abrEwmaDefaultEstimate(){let{bwEstimator:t}=this.abrController;return t?t.defaultEstimate:NaN}get ttfbEstimate(){let{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(this.logger.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){lc(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){let{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;let i=t.length;for(let s=0;s<i;s++)if(t[s].maxBitrate>=e)return s;return 0}get maxAutoLevel(){let{levels:t,autoLevelCapping:e,maxHdcpLevel:i}=this,s;if(e===-1&&t!=null&&t.length?s=t.length-1:s=e,i)for(let r=s;r--;){let a=t[r].attrs["HDCP-LEVEL"];if(a&&a<=i)return r}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(t){var e;return((e=this.audioTrackController)==null?void 0:e.setAudioOption(t))||null}setSubtitleOption(t){var e;return((e=this.subtitleTrackController)==null?void 0:e.setSubtitleOption(t))||null}get allAudioTracks(){let t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){let t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){let t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){let e=this.audioTrackController;e&&(e.audioTrack=t)}get allSubtitleTracks(){let t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){let t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){let t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){let e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){let t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){let e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(t){this.latencyController.targetLatency=t}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(t){this.levelController.pathwayPriority=t}get bufferedToEnd(){var t;return!!((t=this.bufferController)!=null&&t.bufferedToEnd)}get interstitialsManager(){var t;return((t=this.interstitialsController)==null?void 0:t.interstitialsManager)||null}getMediaDecodingInfo(t,e=this.allAudioTracks){let i=Go(e);return Wo(t,i,navigator.mediaCapabilities)}};pt.defaultConfig=void 0;var Zl=ya(zl());function Wl(){return navigator.userAgent.search(/Edge|Edg/)>-1}function xA(){return Wl()?!1:navigator.userAgent.search(/Chrome/)>-1}function ke(){return Wl()||xA()?!1:navigator.userAgent.search(/Safari/)>-1}var SA=()=>{if(!ke())return!1;let n=window.navigator.userAgent.match(/Version\/([^\s]+)/);return!n||n.length<2?!1:Number.parseFloat(n[1])<=15.1},Kn=()=>{if(SA()||window.navigator.userAgent.search("PanasonicSDK")>=0)return!0;if(window.navigator.userAgent.search("Web0S; Linux/SmartTV")>=0){let n=window.navigator.userAgent.search("Chrome/");if(n>=0)return Number.parseInt(window.navigator.userAgent.substr(n+7))<=53}if(window.navigator.userAgent.search("TSBNetTV")>=0){let n=window.navigator.userAgent.search("Chrome/");if(n>=0)return Number.parseInt(window.navigator.userAgent.substr(n+7))<=55}return!1};var Zn=n=>{let t=n.match(/.{1,2}/g);if(!t)throw new Error(`Invalid Hex String: ${n}`);return new Uint8Array(t.map(e=>parseInt(e,16)))},Is=n=>{let t=n.charCodeAt(0);return 55296<=t&&t<=56319||56320<=t&&t<=57343},Gl=["g1","g2","e1","e3"],Yn=n=>{let t=new URL(n),e=t.pathname.split("/"),i=e.map((s,r)=>r===e.length-2?s+"_1min":s).join("/");return t.origin+i},Hl=n=>Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).reduce((t,e)=>t+e),Rs=n=>new Promise((t,e)=>{let i=new FileReader;i.addEventListener("load",()=>{i.result?t(i.result):e(i.error)}),i.readAsArrayBuffer(n)});var LA=n=>{let t=n.length%4===3?1:n.length%4===2?2:n.length%4===1?3:0,e=n.replace(/-/g,"+").replace(/_/g,"/")+"=".repeat(t),i=window.atob(e),s=i.length,r=new Uint8Array(s);for(let a=0;a<s;a++)r[a]=i.charCodeAt(a);return r},Ps=n=>{let t=n.split(".")[1],e=new TextDecoder().decode(LA(t));return JSON.parse(e)},Xl={control:{g1:{video_descriptor:"",message:{enabled:!0,default_image_url:"",schedule:[]},program:[]},g2:{video_descriptor:"",message:{enabled:!0,default_image_url:"",schedule:[]},program:[]},e1:{video_descriptor:"",message:{enabled:!0,default_image_url:"",schedule:[]},program:[]},e3:{video_descriptor:"",message:{enabled:!0,default_image_url:"",schedule:[]},program:[]}},rawControl:{control_7fe0_0400:{message_enable:!0,message_default_image_url:"",message_schedule:[],video_descriptor:"",program:[]},control_7fe0_0401:{message_enable:!0,message_default_image_url:"",message_schedule:[],video_descriptor:"",program:[]},control_7fe1_0408:{message_enable:!0,message_default_image_url:"",message_schedule:[],video_descriptor:"",program:[]},control_7fe1_040a:{message_enable:!0,message_default_image_url:"",message_schedule:[],video_descriptor:"",program:[]}},timeDiff:0},Qn=n=>{let t=Number.parseInt(n.slice(0,2)),e=Number.parseInt(n.slice(2,4)),i=Number.parseInt(n.slice(4,6));return(t*60+e)*60+i},ql=n=>{let t=new Date(n),e=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),r=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0"),l=-t.getTimezoneOffset(),u=l>=0?"+":"-",c=String(Math.floor(Math.abs(l)/60)).padStart(2,"0"),h=String(Math.abs(l)%60).padStart(2,"0"),d=`${u}${c}:${h}`;return`${e}-${i}-${s}T${r}:${a}:${o}${d}`};var rt=[["rgba(  0,   0,   0,   1)","rgba(255,   0,   0,   1)","rgba(  0, 255,   0,   1)","rgba(255, 255,   0,   1)","rgba(  0,   0, 255,   1)","rgba(255,   0, 255,   1)","rgba(  0, 255, 255,   1)","rgba(255, 255, 255,   1)","rgba(  0,   0,   0,   0)","rgba(170,   0,   0,   1)","rgba(  0, 170,   0,   1)","rgba(170, 170,   0,   1)","rgba(  0,   0, 170,   1)","rgba(170,   0, 170,   1)","rgba(  0, 170, 170,   1)","rgba(170, 170, 170,   1)"],["rgba(  0,   0,  85,   1)","rgba(  0,  85,   0,   1)","rgba(  0,  85,  85,   1)","rgba(  0,  85, 170,   1)","rgba(  0,  85, 255,   1)","rgba(  0, 170,  85,   1)","rgba(  0, 170, 255,   1)","rgba(  0, 255,  85,   1)","rgba(  0, 255, 170,   1)","rgba( 85,   0,   0,   1)","rgba( 85,   0,  85,   1)","rgba( 85,   0, 170,   1)","rgba( 85,   0, 255,   1)","rgba( 85,  85,   0,   1)","rgba( 85,  85,  85,   1)","rgba( 85,  85, 170,   1)"],["rgba( 85,  85, 255,   1)","rgba( 85, 170,   0,   1)","rgba( 85, 170,  85,   1)","rgba( 85, 170, 170,   1)","rgba( 85, 170, 255,   1)","rgba( 85, 255,   0,   1)","rgba( 85, 255,  85,   1)","rgba( 85, 255, 170,   1)","rgba( 85, 255, 255,   1)","rgba(170,   0,  85,   1)","rgba(170,   0, 255,   1)","rgba(170,  85,   0,   1)","rgba(170,  85,  85,   1)","rgba(170,  85, 170,   1)","rgba(170,  85, 255,   1)","rgba(170, 170,  85,   1)"],["rgba(170, 170, 255,   1)","rgba(170, 255,   0,   1)","rgba(170, 255,  85,   1)","rgba(170, 255, 170,   1)","rgba(170, 255, 255,   1)","rgba(255,   0,  85,   1)","rgba(255,   0, 170,   1)","rgba(255,  85,   0,   1)","rgba(255,  85,  85,   1)","rgba(255,  85, 170,   1)","rgba(255,  85, 255,   1)","rgba(255, 170,   0,   1)","rgba(255, 170,  85,   1)","rgba(255, 170, 170,   1)","rgba(255, 170, 255,   1)","rgba(255, 255,  85,   1)"],["rgba(255, 255, 170,   1)","rgba(  0,   0,   0, 0.5)","rgba(255,   0,   0, 0.5)","rgba(  0, 255,   0, 0.5)","rgba(255, 255,   0, 0.5)","rgba(  0,   0, 255, 0.5)","rgba(255,   0, 255, 0.5)","rgba(  0, 255, 255, 0.5)","rgba(255, 255, 255, 0.5)","rgba(170,   0,   0, 0.5)","rgba(  0, 170,   0, 0.5)","rgba(170, 170,   0, 0.5)","rgba(  0,   0, 170, 0.5)","rgba(170,   0, 170, 0.5)","rgba(  0, 170, 170, 0.5)","rgba(170, 170, 170, 0.5)"],["rgba(  0,   0,  85, 0.5)","rgba(  0,  85,   0, 0.5)","rgba(  0,  85,  85, 0.5)","rgba(  0,  85, 170, 0.5)","rgba(  0,  85, 255, 0.5)","rgba(  0, 170,  85, 0.5)","rgba(  0, 170, 255, 0.5)","rgba(  0, 255,  85, 0.5)","rgba(  0, 255, 170, 0.5)","rgba( 85,   0,   0, 0.5)","rgba( 85,   0,  85, 0.5)","rgba( 85,   0, 170, 0.5)","rgba( 85,   0, 255, 0.5)","rgba( 85,  85,   0, 0.5)","rgba( 85,  85,  85, 0.5)","rgba( 85,  85, 170, 0.5)"],["rgba( 85,  85, 255, 0.5)","rgba( 85, 170,   0, 0.5)","rgba( 85, 170,  85, 0.5)","rgba( 85, 170, 170, 0.5)","rgba( 85, 170, 255, 0.5)","rgba( 85, 255,   9, 0.5)","rgba( 85, 255,  85, 0.5)","rgba( 85, 255, 170, 0.5)","rgba( 85, 255, 255, 0.5)","rgba(170,   0,  85, 0.5)","rgba(170,   0, 255, 0.5)","rgba(170,  85,   0, 0.5)","rgba(170,  85,  85, 0.5)","rgba(170,  85, 170, 0.5)","rgba(170,  85, 255, 0.5)","rgba(170, 170,  85, 0.5)"],["rgba(170, 170, 255, 0.5)","rgba(170, 255,   0, 0.5)","rgba(170, 255,  85, 0.5)","rgba(170, 255, 170, 0.5)","rgba(170, 255, 255, 0.5)","rgba(255,   0,  85, 0.5)","rgba(255,   0, 170, 0.5)","rgba(255,  85,   9, 0.5)","rgba(255,  85,  85, 0.5)","rgba(255,  85, 170, 0.5)","rgba(255,  85, 255, 0.5)","rgba(255, 170,   0, 0.5)","rgba(255, 170,  85, 0.5)","rgba(255, 170, 170, 0.5)","rgba(255, 170, 255, 0.5)","rgba(255, 255,  85, 0.5)"]];var Cs=new Set(["\u3402","\u{20158}","\u4EFD","\u4EFF","\u4F9A","\u4FC9","\u509C","\u511E","\u51BC","\u351F","\u5307","\u5361","\u536C","\u8A79","\u{20BB7}","\u544D","\u5496","\u549C","\u54A9","\u550E","\u554A","\u5672","\u56E4","\u5733","\u5734","\uFA10","\u5880","\u59E4","\u5A23","\u5A55","\u5BEC","\uFA11","\u37E2","\u5EAC","\u5F34","\u5F45","\u5FB7","\u6017","\uFA6B","\u6130","\u6624","\u66C8","\u66D9","\u66FA","\u66FB","\u6852","\u9FC4","\u6911","\u693B","\u6A45","\u6A91","\u6ADB","\u{233CC}","\u{233FE}","\u{235C4}","\u6BF1","\u6CE0","\u6D2E","\uFA45","\u6DBF","\u6DCA","\u6DF8","\uFA46","\u6F5E","\u6FF9","\u7064","\uFA6C","\u{242EE}","\u7147","\u71C1","\u7200","\u739F","\u73A8","\u73C9","\u73D6","\u741B","\u7421","\uFA4A","\u7426","\u742A","\u742C","\u7439","\u744B","\u3EDA","\u7575","\u7581","\u7772","\u4093","\u78C8","\u78E0","\u7947","\u79AE","\u9FC6","\u4103","\u9FC5","\u79DA","\u7A1E","\u7B7F","\u7C31","\u4264","\u7D8B","\u7FA1","\u8118","\u813A","\uFA6D","\u82AE","\u845B","\u84DC","\u84EC","\u8559","\u85CE","\u8755","\u87EC","\u880B","\u88F5","\u2EC6","\u8AF6","\u8DCE","\u8FBB","\u8FF6","\u90DD","\u9127","\u912D","\u91B2","\u9233","\u9288","\u9321","\u9348","\u9592","\u96DE","\u9903","\u9940","\u9AD9","\u9BD6","\u9DD7","\u9EB4","\u9EB5","\u26CC","\u26CD","\u2757","\u26CF","\u26D0","\u26D1","\u26D2","\u26D5","\u26D3","\u26D4","\u{1F17F}","\u{1F18A}","\u26D6","\u26D7","\u26D8","\u26D9","\u26DA","\u26DB","\u26DC","\u26DD","\u26DE","\u26DF","\u26E0","\u26E1","\u2B55","\u3248","\u3249","\u324A","\u324B","\u324C","\u324D","\u324E","\u324F","\u2491","\u2492","\u2493","\u{1F14A}","\u{1F14C}","\u{1F13F}","\u{1F146}","\u{1F14B}","\u{1F210}","\u{1F211}","\u{1F212}","\u{1F213}","\u{1F142}","\u{1F214}","\u{1F215}","\u{1F216}","\u{1F14D}","\u{1F131}","\u{1F13D}","\u2B1B","\u2B24","\u{1F217}","\u{1F218}","\u{1F219}","\u{1F21A}","\u{1F21B}","\u26BF","\u{1F21C}","\u{1F21D}","\u{1F21E}","\u{1F21F}","\u{1F220}","\u{1F221}","\u{1F222}","\u{1F223}","\u{1F224}","\u{1F225}","\u{1F14E}","\u3299","\u{1F200}","\u26E3","\u2B56","\u2B57","\u2B58","\u2B59","\u2613","\u328B","\u26E8","\u3246","\u3245","\u3245","\u26E9","\u0FD6","\u26EA","\u26EB","\u26EC","\u2668","\u26ED","\u26EE","\u26EF","\u2693","\u2708","\u26F0","\u26F1","\u26F2","\u26F3","\u26F4","\u26F5","\u{1F157}","\u24B9","\u24C8","\u26F6","\u{1F15F}","\u{1F18B}","\u{1F18D}","\u{1F18C}","\u{1F179}","\u26F7","\u26F8","\u26F9","\u26FA","\u{1F17B}","\u260E","\u26FB","\u26FC","\u26FD","\u26FE","\u{1F17C}","\u26FF","\u27A1","\u2B05","\u2B06","\u2B07","\u2B2F","\u2B2E","\uE28B","\uE28C","\uE28D","\uE28E","\u33A1","\u33A5","\u339D","\u33A0","\u33A4","\u{1F100}","\u2488","\u2489","\u248A","\u248B","\u248C","\u248D","\u248E","\u248F","\u2490","\uE290","\uE291","\uE292","\uE293","\uE294","\uE295","\u{1F101}","\u{1F102}","\u{1F103}","\u{1F104}","\u{1F105}","\u{1F106}","\u{1F107}","\u{1F108}","\u{1F109}","\u{1F10A}","\u3233","\u3236","\u3232","\u3231","\u3239","\u3244","\u25B6","\u25C0","\u3016","\u3017","\u27D0","\xB2","\xB3","\u{1F12D}","\uE2A5","\uE2A6","\uE2A7","\uE2A8","\uE2A9","\uE2AA","\uE2AB","\uE2AC","\uE2AD","\uE2AE","\uE2AF","\uE2B0","\uE2B1","\uE2B2","\uE2B3","\uE2B4","\uE2B5","\uE2B6","\uE2B7","\uE2B8","\uE2B9","\uE2BA","\uE2BB","\uE2BC","\uE2BD","\uE2BE","\uE2BF","\uE2C0","\uE2C1","\uE2C2","\u{1F12C}","\u{1F12B}","\u3247","\u{1F190}","\u{1F226}","\u213B","\u322A","\u322B","\u322C","\u322D","\u322E","\u322F","\u3230","\u3237","\u337E","\u337D","\u337C","\u337B","\u2116","\u2121","\u3036","\u26BE","\u{1F240}","\u{1F241}","\u{1F242}","\u{1F243}","\u{1F244}","\u{1F245}","\u{1F246}","\u{1F247}","\u{1F248}","\u{1F12A}","\u{1F227}","\u{1F228}","\u{1F229}","\u{1F214}","\u{1F22A}","\u{1F22B}","\u{1F22C}","\u{1F22D}","\u{1F22E}","\u{1F22F}","\u{1F230}","\u{1F231}","\u2113","\u338F","\u3390","\u33CA","\u339E","\u33A2","\u3371","\xBD","\u2189","\u2153","\u2154","\xBC","\xBE","\u2155","\u2156","\u2157","\u2158","\u2159","\u215A","\u2150","\u215B","\u2151","\u2152","\u2600","\u2601","\u2602","\u26C4","\u2616","\u2617","\u26C9","\u26CA","\u2666","\u2665","\u2663","\u2660","\u26CB","\u2A00","\u203C","\u2049","\u26C5","\u2614","\u26C6","\u2603","\u26C7","\u26A1","\u26C8","\u269E","\u269F","\u266C","\uE2FB","\u2160","\u2161","\u2162","\u2163","\u2164","\u2165","\u2166","\u2167","\u2168","\u2169","\u216A","\u216B","\u2470","\u2471","\u2472","\u2473","\u2474","\u2475","\u2476","\u2477","\u2478","\u2479","\u247A","\u247B","\u247C","\u247D","\u247E","\u247F","\u3251","\u3252","\u3253","\u3254","\u{1F110}","\u{1F111}","\u{1F112}","\u{1F113}","\u{1F114}","\u{1F115}","\u{1F116}","\u{1F117}","\u{1F118}","\u{1F119}","\u{1F11A}","\u{1F11B}","\u{1F11C}","\u{1F11D}","\u{1F11E}","\u{1F11F}","\u{1F120}","\u{1F121}","\u{1F122}","\u{1F123}","\u{1F124}","\u{1F125}","\u{1F126}","\u{1F127}","\u{1F128}","\u{1F129}","\u3255","\u3256","\u3257","\u3258","\u3259","\u325A","\u2460","\u2461","\u2462","\u2463","\u2464","\u2465","\u2466","\u2467","\u2468","\u2469","\u246A","\u246B","\u246C","\u246D","\u246E","\u246F","\u2776","\u2777","\u2778","\u2779","\u277A","\u277B","\u277C","\u277D","\u277E","\u277F","\u24EB","\u24EC","\u325B"]);var Jn=new Set(["\u3001","\u3002"]);var j=2,Ei=class{constructor(){this.onscreen_canvas=null;this.onscreen_svg=null;this.offscreen_canvas=null;this.purpose_width=960*j;this.purpose_height=540*j;this.swf_x=960*j;this.swf_y=540*j;this.sdf_x=960*j;this.sdf_y=540*j;this.sdp_x=0*j;this.sdp_y=0*j;this.ssm_x=36*j;this.ssm_y=36*j;this.shs=4*j;this.svs=24*j;this.text_size_x=1;this.text_size_y=1;this.position_x=-1;this.position_y=-1;this.pallet=0;this.fg_color=rt[this.pallet][7];this.bg_color=rt[this.pallet][8];this.hlc=0;this.stl=!1;this.orn=null;this.normalFont='"MS Gothic", sans-serif';this.gaijiFont=this.normalFont;this.normalBaselineOffset=0;this.gaijiBaselineOffset=0}initialize(){this.purpose_width=960*j,this.purpose_height=540*j,this.swf_x=960*j,this.swf_y=540*j,this.sdf_x=960*j,this.sdf_y=540*j,this.sdp_x=0*j,this.sdp_y=0*j,this.ssm_x=36*j,this.ssm_y=36*j,this.shs=4*j,this.svs=24*j,this.text_size_x=1,this.text_size_y=1,this.position_x=-1,this.position_y=-1,this.pallet=0,this.fg_color=rt[this.pallet][7],this.bg_color=rt[this.pallet][8],this.hlc=0,this.stl=!1,this.orn=null,this.normalFont='"MS Gothic", sans-serif',this.gaijiFont=this.normalFont,this.normalBaselineOffset=0,this.gaijiBaselineOffset=0}width(){return Math.floor((this.shs+this.ssm_x)*this.text_size_x)}height(){return Math.floor((this.svs+this.ssm_y)*this.text_size_y)}width_magnification(){return Math.ceil(this.purpose_width/this.swf_x)}height_magnification(){return Math.ceil(this.purpose_height/this.swf_y)}canvas_width(){return this.swf_x*this.width_magnification()}canvas_height(){return this.swf_y*this.height_magnification()}move_absolute_dot(t,e){this.position_x=t,this.position_y=e}move_absolute_pos(t,e){this.position_x=this.sdp_x+t*this.width(),this.position_y=this.sdp_y+(e+1)*this.height()}move_relative_pos(t,e){for((this.position_x<0||this.position_y<0)&&this.move_absolute_pos(0,0);t<0;)this.position_x-=this.width(),t++,this.position_x<this.sdp_x&&(this.position_x=this.sdp_x+this.sdf_x-this.width(),e--);for(;t>0;)this.position_x+=this.width(),t--,this.position_x>=this.sdp_x+this.sdf_x&&(this.position_x=this.sdp_x,e++);for(;e<0;)this.position_y-=this.height(),e++;for(;e>0;)this.position_y+=this.height(),e--}move_newline(){(this.position_x<0||this.position_y<0)&&this.move_absolute_pos(0,0),this.position_x=this.sdp_x,this.position_y=this.position_y+this.height()}render(t){var e,i,s,r,a,o,l,u,c,h,d,A,f,p,m,v;for(this.initialize(),this.onscreen_canvas=(e=t.canvas)!=null?e:null,this.onscreen_svg=(i=t.svg)!=null?i:null,this.purpose_width=(a=(r=t==null?void 0:t.width)!=null?r:(s=t==null?void 0:t.canvas)==null?void 0:s.width)!=null?a:this.purpose_width,this.purpose_height=(u=(l=t==null?void 0:t.height)!=null?l:(o=t==null?void 0:t.canvas)==null?void 0:o.height)!=null?u:this.purpose_height,this.normalFont=(c=t.normalFont)!=null?c:this.normalFont,this.gaijiFont=(d=(h=t.gaijiFont)!=null?h:this.gaijiFont)!=null?d:this.normalFont,this.normalBaselineOffset=(A=t==null?void 0:t.normalBaselineOffset)!=null?A:this.normalBaselineOffset,this.gaijiBaselineOffset=(f=t==null?void 0:t.gaijiBaselineOffset)!=null?f:this.gaijiBaselineOffset;(p=this.onscreen_svg)!=null&&p.firstChild;)(v=this.onscreen_svg)==null||v.removeChild((m=this.onscreen_svg)==null?void 0:m.firstChild);if(this.parseText(t.text,0,t.text.length),this.onscreen_canvas){let b=this.onscreen_canvas.getContext("2d");b&&(b.clearRect(0,0,this.onscreen_canvas.width,this.onscreen_canvas.height),this.offscreen_canvas&&b.drawImage(this.offscreen_canvas,0,0,this.offscreen_canvas.width,this.offscreen_canvas.height,0,0,this.onscreen_canvas.width,this.onscreen_canvas.height))}this.offscreen_canvas&&(this.offscreen_canvas.width=this.offscreen_canvas.height=0),this.offscreen_canvas=null,this.onscreen_canvas=null}parseText(t,e,i){for(let s=e;s<i;)if(t[s]==="["){let r=s+1,a=t.indexOf("]",r);this.parseControlCode(t.substring(r,a)),s=a+1}else Is(t[s])?(this.renderCharacter(t.substring(s,s+2)),s+=2):(this.renderCharacter(t[s]),s+=1)}parseControlCode(t){var s,r,a;let e=t.split("_");switch(e[0]){case"SWF":{let o=Number.parseInt(e[1]);o===5?(this.swf_x=1920*j,this.swf_y=1080*j,(s=this.onscreen_svg)==null||s.setAttribute("viewBox",`0 0 ${this.swf_x} ${this.swf_y}`)):o===7?(this.swf_x=960*j,this.swf_y=540*j,(r=this.onscreen_svg)==null||r.setAttribute("viewBox",`0 0 ${this.swf_x} ${this.swf_y}`)):o===9&&(this.swf_x=720*j,this.swf_y=480*j,(a=this.onscreen_svg)==null||a.setAttribute("viewBox",`0 0 ${this.swf_x} ${this.swf_y}`));break}case"SDF":{let o=Number.parseInt(e[1])*j,l=Number.parseInt(e[2])*j;this.sdf_x=o,this.sdf_y=l;break}case"SDP":{let o=Number.parseInt(e[1])*j,l=Number.parseInt(e[2])*j;this.sdp_x=o,this.sdp_y=l;break}case"SSM":{let o=Number.parseInt(e[1])*j,l=Number.parseInt(e[2])*j;this.ssm_x=o,this.ssm_y=l;break}case"SHS":{let o=Number.parseInt(e[1])*j;this.shs=o;break}case"SVS":{let o=Number.parseInt(e[1])*j;this.svs=o;break}case"APB":{this.move_relative_pos(-1,0);break}case"APF":{this.move_relative_pos(1,0);break}case"APD":{this.move_relative_pos(0,1);break}case"APU":{this.move_relative_pos(0,-1);break}case"APR":{this.move_newline();break}case"PAPF":{let o=Number.parseInt(e[1]);this.move_relative_pos(o,0);break}case"APS":{let o=Number.parseInt(e[1]),l=Number.parseInt(e[2]);this.move_absolute_pos(l,o);break}case"ACPS":{let o=Number.parseInt(e[1])*j,l=Number.parseInt(e[2])*j;this.move_absolute_dot(o,l);break}case"BKF":{this.fg_color=rt[this.pallet][0];break}case"RDF":{this.fg_color=rt[this.pallet][1];break}case"GRF":{this.fg_color=rt[this.pallet][2];break}case"YLF":{this.fg_color=rt[this.pallet][3];break}case"BLF":{this.fg_color=rt[this.pallet][4];break}case"MGF":{this.fg_color=rt[this.pallet][5];break}case"CNF":{this.fg_color=rt[this.pallet][6];break}case"WHF":{this.fg_color=rt[this.pallet][7];break}case"COL":{if(e.length==2){let o=Number.parseInt(e[1]);this.pallet=o}else{let o=Number.parseInt(e[1]),l=Number.parseInt(e[2]);o===4?this.fg_color=rt[this.pallet][l]:o===5&&(this.bg_color=rt[this.pallet][l])}break}case"SSZ":{this.text_size_x=this.text_size_y=.5;break}case"MSZ":{this.text_size_x=.5,this.text_size_y=1;break}case"NSZ":{this.text_size_x=this.text_size_y=1;break}case"STL":{this.stl=!0;break}case"SPL":{this.stl=!1;break}case"HLC":{let o=Number.parseInt(e[1]);this.hlc=o;break}case"ORN":{if(e.length===1)this.orn=null;else{let o=Number.parseInt(e[1]),l=Number.parseInt(e[2]);this.orn=rt[o][l]}break}case"DRCS":{let o=Number.parseInt(e[1]),l=Number.parseInt(e[2]),u=Number.parseInt(e[3]),c=e[4],h=window.atob(c);this.renderDRCS(h,o,l,u);break}case"TTFONT":break;case"TT":{let o=e[3],l=String.fromCodePoint(Number.parseInt(o,16));this.renderCharacter(l);break}}}renderCharacter(t){if(!!this.onscreen_canvas){if(this.onscreen_canvas&&!this.offscreen_canvas&&(this.offscreen_canvas=document.createElement("canvas"),this.offscreen_canvas.width=this.canvas_width(),this.offscreen_canvas.height=this.canvas_height()),(this.position_x<0||this.position_y<0)&&this.move_absolute_pos(0,0),this.renderBackground(),this.onscreen_svg){let e=document.createElementNS("http://www.w3.org/2000/svg","g"),i=Kn()?this.text_size_x:1,s=Kn()?this.text_size_y:1;if(Cs.has(t)){let r=this.position_x/i+this.shs*this.text_size_x/2,a=this.position_y/s-this.svs*this.text_size_y/2-this.ssm_y*this.text_size_y/this.gaijiBaselineOffset;if(this.orn){let o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",`${r}`),o.setAttribute("y",`${a}`),o.style.fill="none",o.style.stroke=this.orn,o.style.fontSize=`${this.ssm_x}px`,o.style.fontFamily=`${this.gaijiFont}`,o.style.strokeWidth=`${4*j}`,o.style.strokeLinejoin="round",o.textContent=t,e.appendChild(o)}{let o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",`${r}`),o.setAttribute("y",`${a}`),o.style.fill=this.fg_color,o.style.stroke="none",o.style.fontSize=`${this.ssm_x}px`,o.style.fontFamily=`${this.gaijiFont}`,o.style.strokeWidth="0",o.textContent=t,e.appendChild(o)}this.text_size_x===.5&&this.text_size_y===1&&Jn.has(t)?(e.setAttribute("transform",`scale(${this.text_size_x}, ${this.text_size_y})`),e.style.transformOrigin=`${r}px ${a}px`):(e.setAttribute("transform",`scale(${this.text_size_x}, ${this.text_size_y})`),e.style.transformOrigin=`${r}px ${a}px`)}else{let r=this.position_x/i+this.shs*this.text_size_x/2,a=this.position_y/s-this.svs*this.text_size_y/2-this.ssm_y*this.text_size_y/this.normalBaselineOffset;if(this.orn){let o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",`${r}`),o.setAttribute("y",`${a}`),o.style.fill="none",o.style.stroke=this.orn,o.style.fontSize=`${this.ssm_x}px`,o.style.fontFamily=`${this.normalFont}`,o.style.strokeWidth=`${4*j}`,o.style.strokeLinejoin="round",o.textContent=t,e.appendChild(o)}{let o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",`${r}`),o.setAttribute("y",`${a}`),o.style.fill=this.fg_color,o.style.stroke="none",o.style.fontSize=`${this.ssm_x}px`,o.style.fontFamily=`${this.normalFont}`,o.style.strokeWidth="0",o.textContent=t,e.appendChild(o)}this.text_size_x===.5&&this.text_size_y===1&&Jn.has(t)?(e.setAttribute("transform",`scale(${this.text_size_x}, ${this.text_size_y})`),e.style.transformOrigin=`${r}px ${a}px`):(e.setAttribute("transform",`scale(${this.text_size_x}, ${this.text_size_y})`),e.style.transformOrigin=`${r}px ${a}px`)}this.onscreen_svg.appendChild(e)}this.move_relative_pos(1,0)}}renderDRCS(t,e,i,s){var a;if(!this.onscreen_canvas)return;this.onscreen_canvas&&!this.offscreen_canvas&&(this.offscreen_canvas=document.createElement("canvas"),this.offscreen_canvas.width=this.canvas_width(),this.offscreen_canvas.height=this.canvas_height()),this.renderBackground();let r=(a=this.offscreen_canvas)==null?void 0:a.getContext("2d");if(!!r){if(this.orn){r.fillStyle=this.orn;for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)for(let u=0;u<i;u++)for(let c=0;c<e;c++){let h=0;for(let d=0;d<s;d++){let A=Math.floor(((u*e+c)*s+d)/8),f=7-((u*e+c)*s+d)%8;h*=2,h+=(t.charCodeAt(A)&1<<f)>>f}h>0&&r.fillRect((this.position_x-0+Math.floor(this.shs*this.text_size_x/2)+c*j+l*j)*this.width_magnification(),(this.position_y-this.height()+Math.floor(this.svs*this.text_size_y/2)+u*j+o*j)*this.height_magnification(),1*j*this.width_magnification(),1*j*this.height_magnification())}}r.fillStyle=this.fg_color;for(let o=0;o<i;o++)for(let l=0;l<e;l++){let u=0;for(let c=0;c<s;c++){let h=Math.floor(((o*e+l)*s+c)/8),d=7-((o*e+l)*s+c)%8;u*=2,u+=(t.charCodeAt(h)&1<<d)>>d}u>0&&r.fillRect((this.position_x-0+Math.floor(this.shs*this.text_size_x/2)+l*j)*this.width_magnification(),(this.position_y-this.height()+Math.floor(this.svs*this.text_size_y/2)+o*j)*this.height_magnification(),1*j*this.width_magnification(),1*j*this.height_magnification())}this.move_relative_pos(1,0)}}renderBackground(){var e;if(!this.onscreen_canvas)return;let t=(e=this.offscreen_canvas)==null?void 0:e.getContext("2d");!t||(t.fillStyle=this.bg_color,t.fillRect(this.position_x*this.width_magnification(),(this.position_y-this.height())*this.height_magnification(),this.width()*this.width_magnification(),this.height()*this.height_magnification()),this.hlc&1&&(t.fillStyle=this.fg_color,t.fillRect(this.position_x*this.width_magnification(),(this.position_y-1)*this.height_magnification(),this.width()*this.width_magnification(),1*this.height_magnification())),this.hlc&2&&(t.fillStyle=this.fg_color,t.fillRect((this.position_x+this.width()-1)*this.width_magnification(),(this.position_y-this.height())*this.height_magnification(),1*this.width_magnification(),this.height()*this.height_magnification())),this.hlc&4&&(t.fillStyle=this.fg_color,t.fillRect(this.position_x*this.width_magnification(),(this.position_y-this.height())*this.height_magnification(),this.width()*this.width_magnification(),1*this.height_magnification())),this.hlc&8&&(t.fillStyle=this.fg_color,t.fillRect(this.position_x*this.width_magnification(),(this.position_y-this.height())*this.height_magnification(),1*this.width_magnification(),this.height()*this.height_magnification())),this.stl&&(t.fillStyle=this.fg_color,t.fillRect(this.position_x*this.width_magnification(),(this.position_y-1)*this.height_magnification(),this.width()*this.width_magnification(),1*this.height_magnification())))}};var jl=["color","text-shadow","text-decoration","font-size"],IA="\u25A1",RA=n=>/^[(\u3040-\u309F|\u30A0-\u30FF|\s|\u301C|\uFF5E)]+$/.test(n),xi=class{constructor(){this.purpose_width=960;this.purpose_height=540;this.swf_x=960;this.swf_y=540;this.sdf_x=960;this.sdf_y=540;this.sdp_x=0;this.sdp_y=0;this.ssm_x=36;this.ssm_y=36;this.shs=4;this.svs=24;this.onscreen_text_size_x=1;this.text_size_x=1;this.text_size_y=1;this.old_practical_text_size_x=1;this.old_practical_text_size_y=1;this.position_x=-1;this.position_y=-1;this.pallet=0;this.fg_color=rt[this.pallet][7];this.bg_color=rt[this.pallet][8];this.stl=!1;this.orn=null;this.texts=[];this.styleChanged=!1;this.normalFont='"MS Gothic", sans-serif';this.gaijiFont=this.normalFont;this.ttFont=null}initialize(){this.purpose_width=960,this.purpose_height=540,this.swf_x=960,this.swf_y=540,this.sdf_x=960,this.sdf_y=540,this.sdp_x=0,this.sdp_y=0,this.ssm_x=36,this.ssm_y=36,this.shs=4,this.svs=24,this.onscreen_text_size_x=1,this.text_size_x=1,this.text_size_y=1,this.position_x=-1,this.position_y=-1,this.pallet=0,this.fg_color=rt[this.pallet][7],this.bg_color=rt[this.pallet][8],this.stl=!1,this.orn=null,this.texts=[],this.styleChanged=!1,this.normalFont='"MS Gothic", sans-serif',this.gaijiFont=this.normalFont}width(){return Math.floor((this.shs+this.ssm_x)*this.onscreen_text_size_x)}height(){return Math.floor((this.svs+this.ssm_y)*this.text_size_y)}width_magnification(){return Math.ceil(this.purpose_width/this.swf_x)}height_magnification(){return Math.ceil(this.purpose_height/this.swf_y)}canvas_width(){return this.swf_x*this.width_magnification()}canvas_height(){return this.swf_y*this.height_magnification()}move_absolute_dot(t,e){this.position_x=t,this.position_y=e}move_absolute_pos(t,e){this.position_x=this.sdp_x+t*this.width(),this.position_y=this.sdp_y+(e+1)*this.height()}move_relative_pos(t,e){for((this.position_x<0||this.position_y<0)&&this.move_absolute_pos(0,0);t<0;)this.position_x-=this.width(),t++,this.position_x<this.sdp_x&&(this.position_x=this.sdp_x+this.sdf_x-this.width(),e--);for(;t>0;)this.position_x+=this.width(),t--,this.position_x>=this.sdp_x+this.sdf_x&&(this.position_x=this.sdp_x,e++);for(;e<0;)this.position_y-=this.height(),e++;for(;e>0;)this.position_y+=this.height(),e--}move_newline(){(this.position_x<0||this.position_y<0)&&this.move_absolute_pos(0,0),this.position_x=this.sdp_x,this.position_y=this.position_y+this.height()}textize(t){var i,s,r;this.initialize(),this.normalFont=(i=t.normalFont)!=null?i:this.normalFont,this.gaijiFont=(r=(s=t.gaijiFont)!=null?s:this.gaijiFont)!=null?r:this.normalFont,this.drcsMap=t.drcsMap,this.parseText(t.text,0,t.text.length);for(let a=0;a<this.texts.length;a++){let o=this.texts[a];if(o.text_size_x!==.5||o.text_size_y!==.5)continue;let l=o.text.map(h=>h.text.textContent).join(""),u=o.text[o.text.length-1].position_x+o.text[o.text.length-1].width-1,c=o.text[o.text.length-1].position_y;for(let h=0;h<this.texts.length;h++){if(a===h)continue;let d=this.texts[h],f=d.text.map(I=>I.text.textContent).join("").trim().length===0,p=l.trim().length===0;if(!(RA(l)&&!p)&&!f)continue;let b=!1,T=0;for(;T<d.text.length;T++){for(let I=0;I<o.text.length;I++){let k=o.text[I].position_x,R=d.text[T].position_x,D=d.text[T].position_x+d.text[T].width-1,O=d.text[T].position_y-d.text[T].height,P=d.text[T].position_y;if(R<=k&&k<=D&&O<=c&&c<=P){b=!0;break}}if(b)break}if(!b)continue;let L=T;for(;L<d.text.length;L++){let I=d.text[L].position_x,k=d.text[L].position_x+d.text[L].width-1,R=d.text[L].position_y-d.text[L].height,D=d.text[L].position_y;if(I<=u&&u<=k&&R<=c&&c<=D)break}L=Math.min(L,d.text.length-1),o.isRuby=!0,d.rubys.push({text:o.text,style:o.style,begin:T,last:L});break}}this.texts.sort((a,o)=>a.text[0].position_y<o.text[0].position_y?-1:a.text[0].position_y>o.text[0].position_y?1:a.text[0].position_x<o.text[0].position_x?-1:a.text[0].position_x>o.text[0].position_x?1:0);let e=document.createDocumentFragment();for(let a=0;a<this.texts.length;a++){let o=this.texts[a];if(o.isRuby)continue;let l=document.createElement("span"),u=0,c=document.createElement("span");for(let d=0;d<o.rubys.length;d++){let A=o.rubys[d];if(u<A.begin)l.appendChild(o.text[u].text),u++,d--;else if(A.begin<=u&&u<=A.last)c.appendChild(o.text[u].text),u++,d--;else if(u>A.last){let f=document.createElement("ruby"),p=document.createElement("rp");p.appendChild(document.createTextNode("("));let m=document.createElement("rp");m.appendChild(document.createTextNode(")"));let v=document.createElement("rt"),b={color:A.style.color,"text-shadow":A.style["text-shadow"]};o.text_size_x===.5&&o.text_size_y===.5&&(b["font-size"]="font-size: 1em;"),v.style.cssText=jl.map(T=>{var L;return(L=b[T])!=null?L:""}).join("");for(let T=0;T<A.text.length;T++)v.appendChild(A.text[T].text);f.appendChild(c),f.appendChild(p),f.appendChild(v),f.appendChild(m),l.appendChild(f),c=document.createElement("span");continue}}for(;u<o.text.length;)l.appendChild(o.text[u].text),u++;let h="display: inline-block; box-sizing: border-box;"+jl.map(d=>{var A;return(A=o.style[d])!=null?A:""}).join("");l.style.cssText=h,e.appendChild(l)}return e}parseText(t,e,i){for(let s=e;s<i;)if(t[s]==="["){let r=s+1,a=t.indexOf("]",r);this.parseControlCode(t.substring(r,a)),s=a+1}else Is(t[s])?(this.textizeCharacter(t.substring(s,s+2)),s+=2):(this.textizeCharacter(t[s]),s+=1)}parseControlCode(t){var s;let e=t.split("_");switch(e[0]){case"SWF":{let r=Number.parseInt(e[1]);r===5?(this.swf_x=1920,this.swf_y=1080):r===7?(this.swf_x=960,this.swf_y=540):r===9&&(this.swf_x=720,this.swf_y=480),this.styleChanged=!0;break}case"SDF":{let r=Number.parseInt(e[1]),a=Number.parseInt(e[2]);this.sdf_x=r,this.sdf_y=a,this.styleChanged=!0;break}case"SDP":{let r=Number.parseInt(e[1]),a=Number.parseInt(e[2]);this.sdp_x=r,this.sdp_y=a,this.styleChanged=!0;break}case"SSM":{let r=Number.parseInt(e[1]),a=Number.parseInt(e[2]);this.ssm_x=r,this.ssm_y=a,this.styleChanged=!0;break}case"SHS":{let r=Number.parseInt(e[1]);this.shs=r,this.styleChanged=!0;break}case"SVS":{let r=Number.parseInt(e[1]);this.svs=r,this.styleChanged=!0;break}case"APB":{this.move_relative_pos(-1,0),this.styleChanged=!0;break}case"APF":{this.move_relative_pos(1,0),this.styleChanged=!0;break}case"APD":{this.move_relative_pos(0,1),this.styleChanged=!0;break}case"APU":{this.move_relative_pos(0,-1),this.styleChanged=!0;break}case"APR":{this.move_newline(),this.styleChanged=!0;break}case"PAPF":{let r=Number.parseInt(e[1]);this.move_relative_pos(r,0),this.styleChanged=!0;break}case"APS":{let r=this.position_x,a=this.position_y,o=Number.parseInt(e[1]),l=Number.parseInt(e[2]);this.move_absolute_pos(l,o),(r!==this.position_x||a!==this.position_y)&&(this.styleChanged=!0);break}case"ACPS":{let r=this.position_x,a=this.position_y,o=Number.parseInt(e[1]),l=Number.parseInt(e[2]);this.move_absolute_dot(o,l),(r!==this.position_x||a!==this.position_y)&&(this.styleChanged=!0);break}case"BKF":{this.fg_color=rt[this.pallet][0],this.styleChanged=!0;break}case"RDF":{this.fg_color=rt[this.pallet][1],this.styleChanged=!0;break}case"GRF":{this.fg_color=rt[this.pallet][2],this.styleChanged=!0;break}case"YLF":{this.fg_color=rt[this.pallet][3],this.styleChanged=!0;break}case"BLF":{this.fg_color=rt[this.pallet][4],this.styleChanged=!0;break}case"MGF":{this.fg_color=rt[this.pallet][5],this.styleChanged=!0;break}case"CNF":{this.fg_color=rt[this.pallet][6],this.styleChanged=!0;break}case"WHF":{this.fg_color=rt[this.pallet][7],this.styleChanged=!0;break}case"COL":{if(e.length==2){let r=Number.parseInt(e[1]);this.pallet=r}else{let r=Number.parseInt(e[1]),a=Number.parseInt(e[2]);r===4?(this.fg_color=rt[this.pallet][a],this.styleChanged=!0):r===5&&(this.bg_color=rt[this.pallet][a],this.styleChanged=!0)}break}case"SSZ":{this.onscreen_text_size_x=.5,this.text_size_x=.5,this.text_size_y=.5;break}case"MSZ":{this.onscreen_text_size_x=.5,this.text_size_x=1,this.text_size_y=1;break}case"NSZ":{this.onscreen_text_size_x=1,this.text_size_x=1,this.text_size_y=1;break}case"STL":{this.stl=!0,this.styleChanged=!0;break}case"SPL":{this.stl=!1,this.styleChanged=!0;break}case"HLC":{this.styleChanged=!0;break}case"ORN":{if(e.length===1)this.orn=null,this.styleChanged=!0;else{let r=Number.parseInt(e[1]),a=Number.parseInt(e[2]);this.orn=rt[r][a],this.styleChanged=!0}break}case"DRCS":{let r=e[4],a=(s=this.drcsMap)==null?void 0:s.get(r);a?this.parseText(a,0,a==null?void 0:a.length):this.parseText(IA,0,1);break}case"TTFONT":{this.ttFont&&document.fonts.delete(this.ttFont);let r=e[1];new FontFace("tt-font",`url("data:application/x-font-ttf;base64,${r}") format("truetype")`,{style:"normal",weight:"700"}).load().then(a=>{this.ttFont=a,document.fonts.add(a)});break}case"TT":{let r=e[3],a=String.fromCodePoint(Number.parseInt(r,16));this.parseText(a,0,1)}}}prepareTextize(){let t=this.old_practical_text_size_x!=this.text_size_x||this.old_practical_text_size_y!=this.text_size_y;if(this.old_practical_text_size_x=this.text_size_x,this.old_practical_text_size_y=this.text_size_y,this.texts.length===0||this.styleChanged||t){let e={};e.color=`color: ${this.fg_color};`,this.orn&&(e["text-shadow"]=`text-shadow: 0.5px 0.5px 0 ${this.orn},-0.5px 0.5px 0 ${this.orn},0.5px -0.5px 0 ${this.orn},-0.5px -0.5px 0 ${this.orn};`),this.stl&&(e["text-decoration"]="text-decoration: underline;"),this.text_size_x===.5&&this.text_size_y===.5?e["font-size"]="font-size: 0.5em;":this.text_size_x===1&&this.text_size_y===1&&(e["font-size"]="font-size: 1em;"),this.texts.push({isRuby:!1,text:[],rubys:[],style:e,text_size_x:this.text_size_x,text_size_y:this.text_size_y})}this.styleChanged=!1}textizeCharacter(t){this.prepareTextize();let e=this.texts[this.texts.length-1],i=document.createElement("span");i.style.fontFamily=Cs.has(t)?this.gaijiFont:this.normalFont,i.appendChild(document.createTextNode(t)),e.text.push({text:i,position_x:this.position_x,position_y:this.position_y,width:this.width(),height:this.height()}),this.move_relative_pos(1,0)}textizeDRCS(t,e,i,s){var o;this.prepareTextize();let r=document.createElement("canvas");r.width=e,r.height=i,r.style.width=`${this.text_size_x}em`,r.style.height=`${this.text_size_y}em`;let a=r.getContext("2d");if(!!a){if(this.orn){a.fillStyle=(o=this.orn)!=null?o:"";for(let l=-2;l<=2;l++)for(let u=-2;u<=2;u++)for(let c=0;c<i;c++)for(let h=0;h<e;h++){let d=0;for(let A=0;A<s;A++){let f=Math.floor(((c*e+h)*s+A)/8),p=7-((c*e+h)*s+A)%8;d*=2,d+=(t.charCodeAt(f)&1<<p)>>p}d>0&&a.fillRect(h+u,c+l,1,1)}}a.fillStyle=this.fg_color;for(let l=0;l<i;l++){for(let c=0;c<e;c++){let h=0;for(let d=0;d<s;d++){let A=Math.floor(((l*e+c)*s+d)/8),f=7-((l*e+c)*s+d)%8;h*=2,h+=(t.charCodeAt(A)&1<<f)>>f}h>0&&a.fillRect(c,l,1,1)}this.texts[this.texts.length-1].text.push({text:r,position_x:this.position_x,position_y:this.position_y,width:e,height:i}),this.move_relative_pos(1,0)}}}};var Ds="OUT_SUBTITLE_EVENT",Kl="Japanese",Si=class{constructor(t){this.media=null;this.track=null;this.subtitleElement=null;this.canvas=null;this.svg=null;this.mutationObserver=null;this.resizeObserver=null;this.onAddtrackHandler=this.onAddtrack.bind(this);this.onCueChangeHandler=this.onCueChange.bind(this);this.onResizeHandler=this.onResize.bind(this);this.onCanplayHandler=this.onCanplay.bind(this);this.doInSubtitleRender=!0;this.managerOption=t!=null?t:{},this.renderer=new Ei,this.textizer=new xi,this.emitter=new Zl.default}attachMedia(t,e){this.detachMedia(),this.media=t,this.subtitleElement=e!=null?e:t.parentElement,this.media.addEventListener("canplay",this.onCanplayHandler),this.setupCanvas()}detachMedia(){var t;this.cleanupCanvas(),this.cleanupTrack(),(t=this.media)==null||t.removeEventListener("canplay",this.onCanplayHandler),this.media=this.subtitleElement=null}dispose(){this.detachMedia()}getCanvas(){return this.canvas}refresh(){this.onResize()}show(){this.doInSubtitleRender=!0,this.onCueChange()}hide(){this.doInSubtitleRender=!1,this.clean()}clean(){if(this.canvas){let t=this.canvas.getContext("2d");if(!t)return;t.clearRect(0,0,this.canvas.width,this.canvas.height)}if(this.svg)for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild)}addOutSubtitleListener(t){this.emitter.on(Ds,t)}removeOutSubtitleListener(t){this.emitter.removeListener(Ds,t)}setDRCSAltCharMap(t){this.drcsMap=t}getLastCue(){var e;let t=(e=this.track)==null?void 0:e.activeCues;return t&&t.length>0?t[t.length-1]:null}render(t){this.renderer.render(wt(It({},this.managerOption),{text:t,canvas:this.canvas,svg:this.svg,width:this.canvas.width,height:this.canvas.height,normalFont:"tt-font, HiraginoTVSansRdS-W4",normalBaselineOffset:10,gaijiFont:"tt-font, HiraginoTVSansRdS-W4",gaijiBaselineOffset:10}))}textize(t){return this.textizer.textize(wt(It({},this.managerOption),{text:t,normalFont:"tt-font, HiraginoTVSansRdS-W4",gaijiFont:"tt-font, HiraginoTVSansRdS-W4",drcsMap:this.drcsMap}))}onCueChange(){if(!this.media||!this.svg||!this.track||!this.canvas)return;this.track.mode!=="hidden"&&(this.track.mode="hidden");let t=this.getLastCue();if(t&&t.startTime<=this.media.currentTime&&this.media.currentTime<=t.endTime){let e=this.textizer.textize(wt(It({},this.managerOption),{text:t.text,normalFont:"tt-font, HiraginoTVSansRdS-W4",gaijiFont:"tt-font, HiraginoTVSansRdS-W4",drcsMap:this.drcsMap}));this.emitter.emit(Ds,e)}else this.emitter.emit(Ds,document.createDocumentFragment());this.doInSubtitleRender&&(this.clean(),t&&t.startTime<=this.media.currentTime&&this.media.currentTime<=t.endTime&&this.renderer.render(wt(It({},this.managerOption),{text:t.text,canvas:this.canvas,svg:this.svg,width:this.canvas.width,height:this.canvas.height,normalFont:"tt-font, HiraginoTVSansRdS-W4",normalBaselineOffset:10,gaijiFont:"tt-font, HiraginoTVSansRdS-W4",gaijiBaselineOffset:10})))}onResize(){if(!this.canvas||!this.svg||!this.media)return;let t=window.getComputedStyle(this.media),e=Number.parseInt(t.width),i=Number.parseInt(t.height);if(this.canvas.width=e,this.canvas.height=i,!!this.track&&this.doInSubtitleRender){let s=this.canvas.getContext("2d");if(!s)return;s.clearRect(0,0,this.canvas.width,this.canvas.height);let r=this.track.activeCues;if(r&&r.length>0){let a=r[r.length-1];a.startTime<=this.media.currentTime&&this.media.currentTime<=a.endTime&&this.renderer.render(wt(It({},this.managerOption),{text:a.text,canvas:this.canvas,width:this.canvas.width,height:this.canvas.height,normalFont:void 0,normalBaselineOffset:10,gaijiFont:"HiraginoTVSansRdS-W4",gaijiBaselineOffset:10}))}}}onAddtrack(t){let e=t.track;e.label===Kl&&(this.cleanupTrack(),this.track=e,ke()||(this.track.mode="disabled"),this.track.mode="hidden",this.track.addEventListener("cuechange",this.onCueChangeHandler))}onCanplay(){this.setupTrack()}setupTrack(){if(!!this.media){for(let t=0;t<this.media.textTracks.length;t++){let e=this.media.textTracks[t];if(e.label===Kl){this.track=e;break}}this.track&&(ke()||(this.track.mode="disabled"),this.track.mode="hidden",this.track.addEventListener("cuechange",this.onCueChangeHandler)),this.media.textTracks.addEventListener("addtrack",this.onAddtrackHandler)}}setupCanvas(){!this.media||!this.subtitleElement||(this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top=this.canvas.style.left="0",this.canvas.style.pointerEvents="none",this.canvas.style.width="100%",this.canvas.style.height="100%",this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttributeNS(null,"version","1.1"),this.svg.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svg.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.svg.setAttribute("preserveAspectRatio","none"),this.svg.style.position="absolute",this.svg.style.top=this.canvas.style.left="0",this.svg.style.pointerEvents="none",this.svg.style.width="100%",this.svg.style.height="100%",this.onResize(),this.subtitleElement.appendChild(this.canvas),this.subtitleElement.appendChild(this.svg),window.ResizeObserver?(this.resizeObserver=new ResizeObserver(()=>{this.onResize()}),this.resizeObserver.observe(this.media)):window.MutationObserver&&(window.addEventListener("resize",this.onResizeHandler),this.mutationObserver=new MutationObserver(()=>{this.onResize()}),this.mutationObserver.observe(this.media,{attributes:!0,attributeFilter:["class","style"]})))}cleanupTrack(){var t,e;(t=this.track)==null||t.removeEventListener("cuechange",this.onCueChangeHandler),(e=this.media)==null||e.textTracks.removeEventListener("addtrack",this.onAddtrackHandler),this.track=null}cleanupCanvas(){window.removeEventListener("resize",this.onResizeHandler),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.clean(),this.canvas=this.svg=this.subtitleElement=null}};var Ke=class{constructor(t,e){this.playerObserverList=[];this.onUpdateCurrentTimeHandler=this.onUpdateCurrentTime.bind(this);this.fragChangedCallback=void 0;var i;this.setVideoView(e),this.errorEventListener=(i=t.errorEventListener)!=null?i:()=>{},this.onShouldUpdateDRMToken=t.onShouldUpdateDRMToken,this.subtitleEnabled=!1,this.subtitleManager=new Si,t.drcsAltCharMap&&this.subtitleManager.setDRCSAltCharMap(t.drcsAltCharMap)}get isVOD(){return Number.isFinite(this.video.duration)}init(t){return Y(this,null,function*(){this.endPos=t.endPos})}play(){return this.video.play()}pause(){this.video.pause()}destroy(){this.video.removeEventListener("timeupdate",this.onUpdateCurrentTimeHandler)}setVideoView(t){this.video&&this.video.removeEventListener("timeupdate",this.onUpdateCurrentTimeHandler),this.video=t,this.video.addEventListener("timeupdate",this.onUpdateCurrentTimeHandler)}setSubtitleView(t){this.subtitleManager.detachMedia(),this.subtitleManager.attachMedia(this.video,t)}hasSubtitleView(){return Boolean(this.subtitleManager.subtitleElement)}setDRMToken(t){this.drmToken=t}get paused(){return this.video.paused}get currentTime(){return this.video.currentTime}set currentTime(t){this.video.currentTime=t}get volume(){return this.video.volume}set volume(t){this.video.volume=t}get muted(){return this.video.muted}set muted(t){this.video.muted=t}get playbackRate(){return this.video.playbackRate}set playbackRate(t){this.video.playbackRate=t}get duration(){return this.video.duration}get seeking(){return this.video.seeking}setSubtitleEnabled(t){this.subtitleEnabled=t,t?this.subtitleManager.show():this.subtitleManager.hide()}addSubtitleCallback(t){this.subtitleManager.addOutSubtitleListener(t)}removeSubtitleCallback(t){this.subtitleManager.removeOutSubtitleListener(t)}addEventListener(t,e,i){this.video.addEventListener(t,e,i)}removeEventListener(t,e,i){this.video.removeEventListener(t,e,i)}setErrorEventListener(t){this.errorEventListener=t}setUpEventLog(){let t=["load","loadstart","loadedmetadata","loadeddata","play","playing","canplay","canplaythrough","timeupdate","pause","seeking","seeked","ended"];for(let e of t)this.video.addEventListener(e,()=>console.log(e,`paused: ${this.paused}, seeking: ${this.video.seeking}`))}onUpdateCurrentTime(t){let e=t.target.currentTime;this.playerObserverList.forEach(i=>i.onUpdateCurrentTime(e)),this.endPos&&this.endPos<=e&&(this.video.dispatchEvent(new Event("ended")),this.stop())}addPlayerObserver(t){this.playerObserverList.push(t)}clearPlayerObserver(){this.playerObserverList=[]}};var At={VideoinfoJsonNotFound:{code:2002000009,critical:!0,msg:void 0},VideoinfoJsonMalformed:{code:2002000011,critical:!0,msg:void 0},ControlJsonNotFound:{code:2002000007,msg:void 0},ControlJsonMalformed:{code:2002000008,msg:void 0},ThumbnailsJsonNotFound:{code:2002000012,critical:!1,msg:void 0},ThumbnailsJsonMalformed:{code:2002000013,critical:!1,msg:void 0},ThumbnailSpriteNotFound:{code:2002000001,critical:!1,msg:void 0},ThumbnailSpriteDecodeFailure:{code:2002000002,critical:!1,msg:void 0},DrcsAltCharsJsonNotFound:{code:2002000014,critical:!1,msg:void 0},DrcsAltCharsJsonMalformed:{code:2002000015,critical:!1,msg:void 0},NetworkError:{code:2212e6,critical:!0,msg:void 0},MediaError:{code:2213e6,critical:!0,msg:void 0},OtherError:{code:2205e6,critical:!0,msg:void 0}};var PA=1,Ze=class extends Ke{constructor(e,i){super(e,i);this.isReinitAllowed=!0;this.retryCount=0;let s={liveSyncDurationCount:4,lowLatencyMode:!1,nudgeMaxRetry:10,manifestLoadingMaxRetry:4,backBufferLength:0,emeEnabled:!0,licenseXhrSetup:(r,a)=>{this.drmToken&&(r.open("POST",a,!0),r.setRequestHeader("Authorization",`Bearer ${this.drmToken}`))},startLevel:-1,testBandwidth:!1,abrEwmaDefaultEstimate:1564e3*1.5};s.drmSystemOptions={audioRobustness:"SW_SECURE_CRYPTO",videoRobustness:"SW_SECURE_CRYPTO"},s.liveDurationInfinity=!0,this.hlsOption=s}_init(e){return Y(this,null,function*(){var l;let{manifestUrl:i,startPos:s,isLive:r,isCMCDEnabled:a}=e;(l=this.abortController)==null||l.abort(),this.abortController=new AbortController;let o=this.abortController.signal;return new Promise((u,c)=>Y(this,null,function*(){var h;if(o==null||o.addEventListener("abort",()=>c(`init process is aborted. ${i}`)),((h=this.initOption)==null?void 0:h.drmToken)&&this.onShouldUpdateDRMToken){let{exp:d}=Ps(this.initOption.drmToken);d*1e3<Date.now()&&(yield this.onShouldUpdateDRMToken())}this.hlsjs&&(this.video.pause(),this.video.removeAttribute("src"),this.video.load(),yield this.video.setMediaKeys(null).catch(d=>console.warn("setMediaKeys(null) failed",d)),yield new Promise(d=>{this.hlsjs.once(pt.Events.MEDIA_DETACHED,()=>d()),this.hlsjs.detachMedia()}),this.hlsjs.destroy(),this.hlsjs=void 0,this.destroyPromise=new Promise(d=>setTimeout(d,200))),this.destroyPromise&&(yield this.destroyPromise),!(o!=null&&o.aborted)&&(this.hlsOption.liveMaxLatencyDurationCount=r?5:void 0,this.hlsOption.startPosition=r?-1:s,this.hlsOption.widevineLicenseUrl=e.widevineLicenseUrl,this.hlsOption.cmcd=a?{useHeaders:!0}:void 0,this.hlsjs=new pt(It(It({},this.hlsOption),e.hlsjsOption)),this.hlsjs.on(pt.Events.ERROR,(d,A)=>{this.onError(A)}),this.hlsjs.on(pt.Events.FRAG_CHANGED,(d,A)=>{this.fragChangedCallback&&this.fragChangedCallback(A.frag.url)}),yield new Promise(d=>{this.hlsjs.once(pt.Events.MEDIA_ATTACHED,()=>d()),this.hlsjs.attachMedia(this.video)}),this.subtitleManager.hide(),!(o!=null&&o.aborted)&&(this.hlsjs.loadSource(i),this.hlsjs.subtitleDisplay=!1,yield new Promise(d=>{this.hlsjs.once(pt.Events.LEVEL_LOADED,(A,f)=>{var m,v,b;let{programDateTime:p}=f.details.fragments[0];if(p&&(this.startDate=p),this.audioTrackName){for(let T=0;T<((b=(v=(m=this.hlsjs)==null?void 0:m.audioTracks)==null?void 0:v.length)!=null?b:0);T++)if(this.hlsjs.audioTracks[T].name===this.audioTrackName){this.hlsjs.audioTrack=T;break}}d()})}),this.isReinitAllowed=!0,u()))}))})}init(e){return Y(this,null,function*(){Di(Ze.prototype,this,"init").call(this,e),this.initOption=e,this.drmToken=e.drmToken,this.isReinitAllowed=!1,this.retryCount=0,yield this._init(e)})}stop(){var e,i;this.paused||(this.pause(),this.video.dispatchEvent(new Event("pause"))),(e=this.abortController)==null||e.abort(),(i=this.hlsjs)==null||i.stopLoad(),this.subtitleManager.hide(),this.video.removeAttribute("src"),this.video.load()}destroy(){var e;super.destroy(),this.stop(),this.subtitleManager.detachMedia(),this.video.setMediaKeys(null).catch(i=>console.warn("setMediaKeys(null) failed",i)),(e=this.hlsjs)==null||e.destroy()}getCurrentDate(){let e=this.startDate;if(e==null)return;let i=this.video.currentTime*1e3;return new Date(e+i)}getAudioTrackList(){return this.hlsjs.audioTracks}getAudioTrack(){return this.hlsjs.audioTrack}setAudioTrack(e){this.hlsjs.audioTrack=e}getAudioTrackNameList(){var e,i;return Array.from(new Set((i=(e=this.hlsjs)==null?void 0:e.audioTracks)==null?void 0:i.map(s=>s.name)))}getAudioTrackName(){var e,i,s,r;return(r=(s=(e=this.hlsjs)==null?void 0:e.audioTracks)==null?void 0:s[(i=this.hlsjs)==null?void 0:i.audioTrack])==null?void 0:r.name}setAudioTrackName(e){var i,s,r;if(this.audioTrackName!==e){for(let a=0;a<((r=(s=(i=this.hlsjs)==null?void 0:i.audioTracks)==null?void 0:s.length)!=null?r:0);a++)if(this.hlsjs.audioTracks[a].name===e){this.hlsjs.audioTrack=a,this.audioTrackName=e;break}}}onError(e){return Y(this,null,function*(){var i,s,r;if(!(e.details===pt.ErrorDetails.SUBTITLE_LOAD_ERROR&&this.retryCount>0)){if(e.type===pt.ErrorTypes.NETWORK_ERROR&&this.isReinitAllowed&&this.initOption&&this.retryCount<PA&&!this.isVOD&&!((s=(i=e.frag)==null?void 0:i.relurl)!=null&&s.endsWith(".vtt"))){this.retryCount++,this.isReinitAllowed=!1;let a=this.initOption.isLive?-1:this.video.currentTime,o=this.playbackRate;yield this._init(wt(It({},this.initOption),{startPos:a})),yield this.play(),this.playbackRate=o,this.setSubtitleEnabled(this.subtitleEnabled),window.setTimeout(()=>{this.retryCount=0},3e3);return}if(e.details===pt.ErrorDetails.BUFFER_SEEK_OVER_HOLE&&((r=e.frag)==null?void 0:r.start)){this.video.currentTime=e.frag.start;return}if(e.fatal)switch(e.type){case pt.ErrorTypes.NETWORK_ERROR:this.errorEventListener(At.NetworkError);break;case pt.ErrorTypes.MEDIA_ERROR:this.errorEventListener(At.MediaError);break;default:this.errorEventListener(At.OtherError);break}}})}};var CA=n=>{let t=new ArrayBuffer(n.length*2),e=new Uint16Array(t);for(let i=0,s=n.length;i<s;i++)e[i]=n.charCodeAt(i);return e},DA=n=>{let t=new Uint16Array(n.buffer);return String.fromCharCode.apply(null,t)},wA=n=>{let t=DA(n),e=/skd:\/\/(.*)/.exec(t);if(!e||e.length<2)throw new Error("Invalid contentId");return e[1]},OA=(n,t,e)=>{typeof t=="string"&&(t=CA(t));let i=0,s=new ArrayBuffer(n.byteLength+4+t.byteLength+4+e.byteLength),r=new DataView(s),a=new Uint8Array(s,i,n.byteLength);a.set(n),i+=a.byteLength,r.setUint32(i,t.byteLength,!0),i+=4;let o=new Uint16Array(s,i,t.length);return o.set(t),i+=o.byteLength,r.setUint32(i,e.byteLength,!0),i+=4,new Uint8Array(s,i,e.byteLength).set(e),new Uint8Array(s,0,s.byteLength)},$n=class{constructor(){this.onneedkeyHandler=this.onneedkey.bind(this);this.onerrorHandler=this.onerror.bind(this)}init(t){return Y(this,null,function*(){this.video=t.video,this.fairplayCertUrl=t.fairplayCertUrl,this.fairplayLicenseUrl=t.fairplayLicenseUrl,this.licenseXhrSetup=t.licenseXhrSetup,yield this.loadCertificate()})}loadCertificate(){return Y(this,null,function*(){if(!this.video||!this.fairplayCertUrl)return;let t=new XMLHttpRequest;this.licenseXhrSetup&&this.licenseXhrSetup(t,this.fairplayCertUrl),t.responseType="arraybuffer",yield new Promise((e,i)=>{t.addEventListener("load",e),t.addEventListener("error",i),t.send("certificate")}),this.certificate=new Uint8Array(t.response),this.video.addEventListener("webkitneedkey",this.onneedkeyHandler,!1),this.video.addEventListener("error",this.onerrorHandler,!1)})}onerror(t){}onneedkey(t){if(!this.certificate)throw new Error("Could not load certificate");let e=t.target,i=t.initData,s=wA(i);if(i=OA(i,s,this.certificate),!e.webkitKeys){let a=this.selectKeySystem();e.webkitSetMediaKeys(new window.WebKitMediaKeys(a))}if(!e.webkitKeys)throw new Error("Could not create MediaKeys");let r=e.webkitKeys.createSession("video/mp4",i);if(!r)throw new Error("Could not create key session");e.dispatchEvent(new CustomEvent("addKeySession",{detail:{keySession:r},bubbles:!0,cancelable:!0})),r.contentId=s,r.addEventListener("webkitkeymessage",this.licenseRequestReady.bind(this),!1),r.addEventListener("webkitkeyerror",this.onkeyerror.bind(this),!1)}selectKeySystem(){if(window.WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4"))return"com.apple.fps.1_0";throw"Key System not supported"}licenseRequestReady(t){if(!this.fairplayLicenseUrl)return;let e=t.target,i=t.message,s=new XMLHttpRequest;this.licenseXhrSetup&&this.licenseXhrSetup(s,this.fairplayLicenseUrl),s.readyState||s.open("POST",this.fairplayLicenseUrl,!0),s.responseType="arraybuffer",s.session=e,s.addEventListener("load",this.licenseRequestLoaded.bind(this),!1),s.addEventListener("error",this.licenseRequestFailed.bind(this),!1),s.setRequestHeader("Content-type","application/json"),s.send(i)}licenseRequestLoaded(t){let e=t.target;e.session.update(new Uint8Array(e.response))}licenseRequestFailed(){}onkeyerror(){}destroy(){var t,e;(t=this.video)==null||t.removeEventListener("webkitneedkey",this.onneedkeyHandler,!1),(e=this.video)==null||e.removeEventListener("error",this.onerrorHandler,!1)}},Yl=new $n;var Ye=class extends Ke{constructor(e,i){super(e,i)}init(e){return Y(this,null,function*(){Di(Ye.prototype,this,"init").call(this,e);let{manifestUrl:i,startPos:s,drmToken:r}=e;this.stop(),this.drmToken=r,this.abortController=new AbortController;let a=this.abortController.signal;return new Promise((o,l)=>Y(this,null,function*(){if(a==null||a.addEventListener("abort",()=>l(`init process is aborted. ${i}`)),this.subtitleManager.hide(),this.drmToken&&this.onShouldUpdateDRMToken){let{exp:u}=Ps(this.drmToken);u*1e3<Date.now()&&(yield this.onShouldUpdateDRMToken())}this.drmToken&&(yield Yl.init({video:this.video,fairplayCertUrl:e.fairplayCertUrl,fairplayLicenseUrl:e.fairplayLicenseUrl,licenseXhrSetup:(u,c)=>{u.open("POST",c,!0),u.setRequestHeader("Authorization",`Bearer ${this.drmToken}`)}})),this.video.addEventListener("error",()=>this.onError()),this.video.src=i,this.video.load(),this.video.pause(),yield new Promise(u=>this.video.addEventListener("canplay",()=>u(),{once:!0})),this.video.seekable.length!==0&&0<=s&&s<=this.video.seekable.end(0)&&(this.currentTime=s),o()}))})}stop(){var e;this.paused||(this.pause(),this.video.dispatchEvent(new Event("pause"))),(e=this.abortController)==null||e.abort(),this.subtitleManager.hide(),this.video.removeAttribute("src"),this.video.load()}destroy(){super.destroy(),this.stop(),this.subtitleManager.detachMedia()}getCurrentDate(){let i=this.video.getStartDate().getTime();if(Number.isNaN(i))return;let s=this.video.currentTime*1e3;return new Date(i+s)}getAudioTrackList(){return Array.from(this.video.audioTracks)}getAudioTrack(){return this.getAudioTrackList().findIndex(e=>e.enabled)}setAudioTrack(e){this.getAudioTrackList().forEach((i,s)=>{i.enabled=s===e})}getAudioTrackNameList(){return this.getAudioTrackList().map(e=>e.label)}getAudioTrackName(){let e=this.getAudioTrack();if(!(e<0))return this.getAudioTrackList()[e].label}setAudioTrackName(e){let i=this.getAudioTrackList().findIndex(s=>s.label===e);i>=0&&this.setAudioTrack(i)}onError(){var e;if(!!this.errorEventListener)switch((e=this.video.error)==null?void 0:e.code){case MediaError.MEDIA_ERR_NETWORK:this.errorEventListener(At.NetworkError);break;case MediaError.MEDIA_ERR_DECODE:this.errorEventListener(At.MediaError);break;default:this.errorEventListener(At.OtherError);break}}};var kA=function(n,t,e){if(e||arguments.length===2)for(var i=0,s=t.length,r;i<s;i++)(r||!(i in t))&&(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))};function Ql(n){return n}function ta(n,t,e,i,s,r,a,o,l){switch(arguments.length){case 1:return n;case 2:return t(n);case 3:return e(t(n));case 4:return i(e(t(n)));case 5:return s(i(e(t(n))));case 6:return r(s(i(e(t(n)))));case 7:return a(r(s(i(e(t(n))))));case 8:return o(a(r(s(i(e(t(n)))))));case 9:return l(o(a(r(s(i(e(t(n))))))));default:{for(var u=arguments[0],c=1;c<arguments.length;c++)u=arguments[c](u);return u}}}var ws=function(n,t){var e=typeof n=="number"?function(i){return i.length>=n}:n;return function(){var i=Array.from(arguments);return e(arguments)?t.apply(this,i):function(s){return t.apply(void 0,kA([s],i,!1))}}};var Jl=function(n){return n._tag==="Left"},$l=function(n){return n._tag==="Right"},tu=function(n){return{_tag:"Left",left:n}},eu=function(n){return{_tag:"Right",right:n}};function ea(n){return function(t,e){return n.map(t,function(){return e})}}function iu(n){var t=ea(n);return function(e){return t(e,void 0)}}function su(n){return function(t,e){return n.chain(t,function(i){return n.map(e(i),function(){return i})})}}var ru=tu,Os=eu,NA=ws(2,function(n,t){return Pt(n)?n:t(n.right)}),nu=function(n,t){return ta(n,UA(t))},FA=function(n,t){return ta(n,VA(t))};var ia="Either";var UA=function(n){return function(t){return Pt(t)?t:Os(n(t.right))}},au={URI:ia,map:nu},fp=ws(2,ea(au)),gp=iu(au);var BA=function(n){return function(t){return Pt(t)?t:Pt(n)?n:Os(t.right(n.right))}},VA=BA;var zA={URI:ia,map:nu,ap:FA,chain:NA};var WA={URI:ia,fromEither:Ql};var Pt=Jl,sa=$l;var pp=ws(2,su(zA));var mp={fromEither:WA.fromEither};var lt=function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(i[r]=s[r])},n(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ks=function(){return ks=Object.assign||function(n){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},ks.apply(this,arguments)};var Fs=ru,Nt=function(n,t,e){return Fs([{value:n,context:t,message:e}])},Ct=Os,ht=function(){function n(t,e,i,s){this.name=t,this.is=e,this.validate=i,this.encode=s,this.decode=this.decode.bind(this)}return n.prototype.pipe=function(t,e){var i=this;return e===void 0&&(e="pipe(".concat(this.name,", ").concat(t.name,")")),new n(e,t.is,function(s,r){var a=i.validate(s,r);return Pt(a)?a:t.validate(a.right,r)},this.encode===gt&&t.encode===gt?gt:function(s){return i.encode(t.encode(s))})},n.prototype.asDecoder=function(){return this},n.prototype.asEncoder=function(){return this},n.prototype.decode=function(t){return this.validate(t,[{key:"",type:this,actual:t}])},n}();var gt=function(n){return n};function GA(n){return n.displayName||n.name||"<function".concat(n.length,">")}function Ms(n,t,e,i){for(var s=n.length,r=Array(s+1),a=0;a<s;a++)r[a]=n[a];return r[s]={key:t,type:e,actual:i},r}function aa(n,t){for(var e=t.length,i=0;i<e;i++)n.push(t[i])}var _s=Object.prototype.hasOwnProperty;function HA(n){return Object.keys(n).map(function(t){return"".concat(t,": ").concat(n[t].name)}).join(", ")}function na(n){for(var t=0;t<n.length;t++)if(n[t].encode!==gt)return!1;return!0}function XA(n){return"{ ".concat(HA(n)," }")}function qA(n){return"("+n.map(function(t){return t.name}).join(" | ")+")"}function jA(n){return n.length>0}var Bt={};function lu(n,t){for(var e=[],i=0,s=n;i<s.length;i++){var r=s[i];t.indexOf(r)!==-1&&e.push(r)}return e}function KA(n,t){if(n===Bt)return t;if(t===Bt)return n;var e=Object.assign({},n);for(var i in t)if(_s.call(n,i)){var s=lu(n[i],t[i]);if(jA(s))e[i]=s;else{e=Bt;break}}else e[i]=t[i];return e}function ZA(n,t){if(n===Bt||t===Bt)return Bt;var e=Bt;for(var i in n)if(_s.call(t,i)){var s=lu(n[i],t[i]);s.length===0&&(e===Bt&&(e={}),e[i]=n[i].concat(t[i]))}return e}function YA(n){return n._tag==="LiteralType"}function QA(n){return n._tag==="InterfaceType"}function JA(n){return n._tag==="StrictType"}function $A(n){return n._tag==="ExactType"}function tf(n){return n._tag==="RefinementType"}function ef(n){return n._tag==="IntersectionType"}function sf(n){return n._tag==="UnionType"}function rf(n){return n._tag==="RecursiveType"}function nf(n){return n._tag==="ReadonlyType"}var ra=[];function Me(n){if(ra.indexOf(n)!==-1)return Bt;if(QA(n)||JA(n)){var t=Bt;for(var e in n.props){var i=n.props[e];YA(i)&&(t===Bt&&(t={}),t[e]=[i.value])}return t}else{if($A(n)||tf(n)||nf(n))return Me(n.type);if(ef(n))return n.types.reduce(function(r,a){return KA(r,Me(a))},Bt);if(sf(n))return n.types.slice(1).reduce(function(r,a){return ZA(r,Me(a))},Me(n.types[0]));if(rf(n)){ra.push(n);var s=Me(n.type);return ra.pop(),s}}return Bt}function af(n){var t=Me(n[0]),e=Object.keys(t),i=n.length,s=function(u){for(var c=t[u].slice(),h=[t[u]],d=1;d<i;d++){var A=n[d],f=Me(A),p=f[u];if(p===void 0)return"continue-keys";if(p.some(function(m){return c.indexOf(m)!==-1}))return"continue-keys";c.push.apply(c,p),h.push(p)}return{value:[u,h]}};t:for(var r=0,a=e;r<a.length;r++){var o=a[r],l=s(o);if(typeof l=="object")return l.value;switch(l){case"continue-keys":continue t}}}var of=function(n){lt(t,n);function t(){var e=n.call(this,"null",function(i){return i===null},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="NullType",e}return t}(ht);var le=new of,lf=function(n){lt(t,n);function t(){var e=n.call(this,"undefined",function(i){return i===void 0},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="UndefinedType",e}return t}(ht);var Jt=new lf,uf=function(n){lt(t,n);function t(){var e=n.call(this,"void",Jt.is,Jt.validate,gt)||this;return e._tag="VoidType",e}return t}(ht);var Tp=new uf,cf=function(n){lt(t,n);function t(){var e=n.call(this,"unknown",function(i){return!0},Ct,gt)||this;return e._tag="UnknownType",e}return t}(ht);var bp=new cf,hf=function(n){lt(t,n);function t(){var e=n.call(this,"string",function(i){return typeof i=="string"},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="StringType",e}return t}(ht);var $=new hf,df=function(n){lt(t,n);function t(){var e=n.call(this,"number",function(i){return typeof i=="number"},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="NumberType",e}return t}(ht);var Vt=new df,Af=function(n){lt(t,n);function t(){var e=n.call(this,"bigint",function(i){return typeof i=="bigint"},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="BigIntType",e}return t}(ht);var Ep=new Af,ff=function(n){lt(t,n);function t(){var e=n.call(this,"boolean",function(i){return typeof i=="boolean"},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="BooleanType",e}return t}(ht);var Ae=new ff,gf=function(n){lt(t,n);function t(){var e=n.call(this,"UnknownArray",Array.isArray,function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="AnyArrayType",e}return t}(ht);var ou=new gf,pf=function(n){lt(t,n);function t(){var e=n.call(this,"UnknownRecord",function(i){return i!==null&&typeof i=="object"&&!Array.isArray(i)},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="AnyDictionaryType",e}return t}(ht);var Ns=new pf;var mf=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.value=a,o._tag="LiteralType",o}return t}(ht);function Ee(n,t){t===void 0&&(t=JSON.stringify(n));var e=function(i){return i===n};return new mf(t,e,function(i,s){return e(i)?Ct(n):Nt(i,s)},gt,n)}var xp=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.keys=a,o._tag="KeyofType",o}return t}(ht);var vf=function(n){lt(t,n);function t(e,i,s,r,a,o){var l=n.call(this,e,i,s,r)||this;return l.type=a,l.predicate=o,l._tag="RefinementType",l}return t}(ht);function yf(n,t,e){return cu(n,t,e)}var Sp=yf(Vt,function(n){return Number.isInteger(n)},"Int"),Tf=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.runDefinition=a,o._tag="RecursiveType",o}return t}(ht);Object.defineProperty(Tf.prototype,"type",{get:function(){return this.runDefinition()},enumerable:!0,configurable:!0});var bf=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.type=a,o._tag="ArrayType",o}return t}(ht);function Xt(n,t){return t===void 0&&(t="Array<".concat(n.name,">")),new bf(t,function(e){return ou.is(e)&&e.every(n.is)},function(e,i){var s=ou.validate(e,i);if(Pt(s))return s;for(var r=s.right,a=r.length,o=r,l=[],u=0;u<a;u++){var c=r[u],h=n.validate(c,Ms(i,String(u),n,c));if(Pt(h))aa(l,h.left);else{var d=h.right;d!==c&&(o===r&&(o=r.slice()),o[u]=d)}}return l.length>0?Fs(l):Ct(o)},n.encode===gt?gt:function(e){return e.map(n.encode)},n)}var Ef=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.props=a,o._tag="InterfaceType",o}return t}(ht);function mt(n,t){t===void 0&&(t=XA(n));var e=Object.keys(n),i=e.map(function(r){return n[r]}),s=e.length;return new Ef(t,function(r){if(Ns.is(r)){for(var a=0;a<s;a++){var o=e[a],l=r[o];if(l===void 0&&!_s.call(r,o)||!i[a].is(l))return!1}return!0}return!1},function(r,a){var o=Ns.validate(r,a);if(Pt(o))return o;for(var l=o.right,u=l,c=[],h=0;h<s;h++){var d=e[h],A=u[d],f=i[h],p=f.validate(A,Ms(a,d,f,A));if(Pt(p))aa(c,p.left);else{var m=p.right;(m!==A||m===void 0&&!_s.call(u,d))&&(u===l&&(u=ks({},l)),u[d]=m)}}return c.length>0?Fs(c):Ct(u)},na(i)?gt:function(r){for(var a=ks({},r),o=0;o<s;o++){var l=e[o],u=i[o].encode;u!==gt&&(a[l]=u(r[l]))}return a},n)}var Lp=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.props=a,o._tag="PartialType",o}return t}(ht);var Ip=function(n){lt(t,n);function t(e,i,s,r,a,o){var l=n.call(this,e,i,s,r)||this;return l.domain=a,l.codomain=o,l._tag="DictionaryType",l}return t}(ht);var uu=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.types=a,o._tag="UnionType",o}return t}(ht);function St(n,t){t===void 0&&(t=qA(n));var e=af(n);if(e!==void 0&&n.length>0){var i=e[0],s=e[1],r=s.length,a=function(o){for(var l=0;l<r;l++)if(s[l].indexOf(o)!==-1)return l};return new If(t,function(o){if(Ns.is(o)){var l=a(o[i]);return l!==void 0?n[l].is(o):!1}return!1},function(o,l){var u=Ns.validate(o,l);if(Pt(u))return u;var c=u.right,h=a(c[i]);if(h===void 0)return Nt(o,l);var d=n[h];return d.validate(c,Ms(l,String(h),d,c))},na(n)?gt:function(o){var l=a(o[i]);if(l===void 0)throw new Error("no codec found to encode value in union codec ".concat(t));return n[l].encode(o)},n,i)}else return new uu(t,function(o){return n.some(function(l){return l.is(o)})},function(o,l){for(var u=[],c=0;c<n.length;c++){var h=n[c],d=h.validate(o,Ms(l,String(c),h,o));if(Pt(d))aa(u,d.left);else return Ct(d.right)}return Fs(u)},na(n)?gt:function(o){for(var l=0,u=n;l<u.length;l++){var c=u[l];if(c.is(o))return c.encode(o)}throw new Error("no codec found to encode value in union type ".concat(t))},n)}var Rp=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.types=a,o._tag="IntersectionType",o}return t}(ht);var Pp=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.types=a,o._tag="TupleType",o}return t}(ht);var Cp=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.type=a,o._tag="ReadonlyType",o}return t}(ht);var Dp=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.type=a,o._tag="ReadonlyArrayType",o}return t}(ht);var wp=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.type=a,o._tag="ExactType",o}return t}(ht);var xf=function(n){lt(t,n);function t(){var e=n.call(this,"Function",function(i){return typeof i=="function"},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="FunctionType",e}return t}(ht);var Op=new xf,Sf=function(n){lt(t,n);function t(){var e=n.call(this,"never",function(i){return!1},function(i,s){return Nt(i,s)},function(){throw new Error("cannot encode never")})||this;return e._tag="NeverType",e}return t}(ht);var kp=new Sf,Lf=function(n){lt(t,n);function t(){var e=n.call(this,"any",function(i){return!0},Ct,gt)||this;return e._tag="AnyType",e}return t}(ht);var Mp=new Lf;function cu(n,t,e){return e===void 0&&(e="(".concat(n.name," | ").concat(GA(t),")")),new vf(e,function(i){return n.is(i)&&t(i)},function(i,s){var r=n.validate(i,s);if(Pt(r))return r;var a=r.right;return t(a)?Ct(a):Nt(a,s)},n.encode,n,t)}var _p=cu(Vt,Number.isInteger,"Integer"),If=function(n){lt(t,n);function t(e,i,s,r,a,o){var l=n.call(this,e,i,s,r,a)||this;return l.tag=o,l}return t}(uu);var Rf=function(n){lt(t,n);function t(){var e=n.call(this,"object",function(i){return i!==null&&typeof i=="object"},function(i,s){return e.is(i)?Ct(i):Nt(i,s)},gt)||this;return e._tag="ObjectType",e}return t}(ht);var Np=new Rf;var Fp=function(n){lt(t,n);function t(e,i,s,r,a){var o=n.call(this,e,i,s,r)||this;return o.props=a,o._tag="StrictType",o}return t}(ht);var Cf=ya(Au());var Df=St([Ee("bare"),Ee("cenc"),Ee("cbcs")]),wf=St([Ee("H.264"),Ee("H.265"),$,Jt]),Of=St([Ee("SDR"),Ee("HDR"),$,Jt]),kf=mt({drm_type:Df,bitrate_limit_type:$,url:$,video_codec:wf,dynamic_range:Of}),Mf=n=>({drmType:n.drm_type,bitrateLimit:Number.parseInt(n.bitrate_limit_type.slice(1)),bitrateType:n.bitrate_limit_type[0]==="m"?"Multi":"Single",url:n.url,videoCodec:n.video_codec==="H.265"?"H.265":"H.264",dynamicRange:n.dynamic_range==="HDR"?"HDR":"SDR"}),_f=mt({start:$,duration:$,message:$}),Nf=mt({manifests:Xt(kf),thumnails:St([$,Jt]),allow_multispeed:St([Ae,Jt]),need_L1_hd:St([Ae,Jt]),drm_server_fairplay:St([$,Jt]),drm_server_widevine:St([$,Jt]),disclaimer:St([Xt(_f),Jt,le])}),Ff=mt({start:Vt,interval:Vt,group:Vt,columns:Vt,width:Vt,height:Vt,url:$}),Uf=mt({drcs:$,alternative:$}),Bf=mt({map:Xt(Uf)}),Vf=mt({enabled:Ae,default_image_url:$,schedule:Xt(mt({image_url:St([$,le]),show_at:Vt,hide_at:Vt}))}),zf=mt({allow_dvr:Ae,id:$,start_at:$,end_at:$,video_descriptor:St([$,le])}),Wf=mt({allow_dvr:Ae,stream_id:$,start_at:$,end_at:$,video_descriptor:St([$,le])}),Gf=mt({allow_dvr:Ae,id:$,start_at:Vt,end_at:Vt,video_descriptor:St([$,le])}),Bs=mt({message_enable:Ae,message_default_image_url:$,message_schedule:Xt(mt({message_image_url:St([$,le]),show_at:$,hide_at:St([$,le])})),video_descriptor:$,program:Xt(zf)}),Vs=mt({message_enable:Ae,message_default_image_url:$,message_schedule:Xt(mt({message_image_url:St([$,le]),show_at:$,hide_at:St([$,le])})),video_descriptor:$,program:Xt(Wf)}),qp=mt({video_descriptor:$,message:Vf,program:Xt(Gf)}),Hf=mt({control_7fe0_0400:Bs,control_7fe0_0401:Bs,control_7fe1_0408:Bs,control_7fe1_040a:Bs}),Xf=mt({control_7fe0_0400:Vs,control_7fe0_0401:Vs,control_7fe1_0408:Vs,control_7fe1_040a:Vs}),jp=mt({api_keys:Xt(mt({api_key:$,apps:Xt($)}))}),qf=(n,t=void 0)=>Y(void 0,null,function*(){var a,o,l;let e={};if(t!==void 0){let u=new AbortController;setTimeout(()=>u.abort(),t),e={signal:u.signal}}let i=yield fetch(n,e).catch(()=>{});if(i===void 0)return Promise.reject(At.NetworkError);if(!i.ok)return Promise.reject(At.VideoinfoJsonNotFound);let s=Nf.decode(yield i.json());if(Pt(s))return Promise.reject(At.VideoinfoJsonMalformed);let r=((a=s.right.disclaimer)!=null?a:[]).map(({start:u,duration:c,message:h})=>({start:Qn(u),duration:Qn(c),message:h})).filter(({start:u,duration:c})=>Number.isFinite(u)&&Number.isFinite(c));return{manifests:s.right.manifests.map(Mf),thumnails:s.right.thumnails,allowMultispeed:(o=s.right.allow_multispeed)!=null?o:!0,needL1HD:(l=s.right.need_L1_hd)!=null?l:!1,widevineLicenseUrl:s.right.drm_server_widevine,fairplayLicenseUrl:s.right.drm_server_fairplay,corrections:r}}),jf=n=>Y(void 0,null,function*(){let t=yield fetch(n).catch(()=>{});if(t===void 0)return Promise.reject(At.NetworkError);if(!t.ok)return Promise.reject(At.ThumbnailsJsonNotFound);let e=Ff.decode(yield t.json());return Pt(e)?Promise.reject(At.ThumbnailsJsonMalformed):e.right}),Kf=n=>Y(void 0,null,function*(){let t=yield fetch(n).catch(()=>{});if(t===void 0)return Promise.reject(At.NetworkError);if(!t.ok)return Promise.reject(At.DrcsAltCharsJsonNotFound);let e=Bf.decode(yield t.json());if(Pt(e))return Promise.reject(At.DrcsAltCharsJsonMalformed);let i=new Map;for(let{drcs:s,alternative:r}of e.right.map)i.set(s,r);return i}),zs=n=>({video_descriptor:n.video_descriptor,message:{enabled:n.message_enable,default_image_url:n.message_default_image_url,schedule:n.message_schedule.reverse().map(t=>({image_url:t.message_image_url,show_at:Date.parse(t.show_at),hide_at:t.hide_at?Date.parse(t.hide_at):Number.MAX_SAFE_INTEGER}))},program:n.program.reverse().map(t=>wt(It({},t),{start_at:Date.parse(t.start_at),end_at:Date.parse(t.end_at)}))}),Ws=n=>({video_descriptor:n.video_descriptor,message:{enabled:n.message_enable,default_image_url:n.message_default_image_url,schedule:n.message_schedule.reverse().map(t=>({image_url:t.message_image_url,show_at:Date.parse(t.show_at),hide_at:t.hide_at?Date.parse(t.hide_at):Number.MAX_SAFE_INTEGER}))},program:n.program.reverse().map(t=>wt(It({},t),{id:t.stream_id,start_at:Date.parse(t.start_at),end_at:Date.parse(t.end_at)}))}),Zf=(n,t)=>Y(void 0,null,function*(){var f;let e=yield fetch(n).catch(()=>{});if(e===void 0||!e.ok)return Promise.reject(wt(It({},At.ControlJsonNotFound),{critical:t}));let i=e.headers.get("date"),s=i?new Date(i).getTime()-Date.now():0,r=(f=e.headers.get("x-amz-meta-hash"))==null?void 0:f.trim();if(!r)return Promise.reject(wt(It({},At.ControlJsonNotFound),{critical:t}));let a=yield e.blob(),o=new Uint8Array(yield Rs(a)),l=new TextEncoder().encode("4f361385f977ddf881df2055fa1863cb"),u=new Uint8Array(o.byteLength+l.byteLength);u.set(l),u.set(o,l.byteLength);let c=yield crypto.subtle.digest("SHA-256",u).then(Hl);if(r!==c)return Promise.reject(wt(It({},At.ControlJsonNotFound),{critical:t}));let h=JSON.parse(new TextDecoder().decode(o)),d=Hf.decode(h);if(sa(d))return{control:{g1:zs(d.right.control_7fe0_0400),g2:zs(d.right.control_7fe0_0401),e1:zs(d.right.control_7fe1_0408),e3:zs(d.right.control_7fe1_040a)},rawControl:d.right,timeDiff:s};let A=Xf.decode(h);return sa(A)?{control:{g1:Ws(A.right.control_7fe0_0400),g2:Ws(A.right.control_7fe0_0401),e1:Ws(A.right.control_7fe1_0408),e3:Ws(A.right.control_7fe1_040a)},rawControl:A.right,timeDiff:s}:Promise.reject(wt(It({},At.ControlJsonMalformed),{critical:t}))});var $t={fetchVideoInfo:qf,fetchThumbnailInfo:jf,fetchDRCSAltChars:Kf,fetchControl:Zf};var Yf=()=>Promise.resolve(Xl),fu={fetchControl:Yf};function Qf(n,t,e){return Y(this,null,function*(){let i=yield crypto.subtle.importKey("raw",Zn(t),"AES-CBC",!0,["decrypt"]),s=Zn(e),r=yield Rs(n),a=yield crypto.subtle.decrypt({name:"AES-CBC",iv:s},i,r);return new Blob([a])})}function oa(n){return n[0]===0&&n[1]===0&&n[2]===0}var Qe=class{constructor(t,e){this.spriteCache=new Map;this.thumbailCache=new Map;this.aesOption={key:"f5b74956cef09a3168e435504b661461",iv:"e8009e514f41bd0ccfe2ced85b4f5cd4"},this.errorEventListener=e,this.canvas=document.createElement("canvas"),this.thumbnailInfoPromise=$t.fetchThumbnailInfo(t)}fetchSprite(t){let e=`thumbnails_${t.toString().padStart(4,"0")}.dat`,i=new URL(this.thumbnailInfo.url),s=i.pathname.split("/");return s[s.length-1]=e,i.pathname=s.join("/"),new Promise((r,a)=>{Y(this,null,function*(){let o;try{o=yield fetch(i.href).then(c=>c.blob())}catch(c){a(At.ThumbnailSpriteNotFound);return}let l;if(this.aesOption)try{l=yield Qf(o,this.aesOption.key,this.aesOption.iv)}catch(c){a(At.ThumbnailSpriteDecodeFailure);return}else l=o;let u=new Image;u.onload=()=>r(u),u.src=URL.createObjectURL(l)})})}clipThumbnail(t,e){let{interval:i,group:s,columns:r,width:a,height:o}=this.thumbnailInfo,l=i*s,u=Math.trunc(t/l),c=Math.trunc((t-l*u)/i),h=Math.trunc(c/r),d=c%r,A=h*o,f=d*a;this.canvas.width=a,this.canvas.height=o,this.canvas.getContext("2d",{willReadFrequently:!0}).drawImage(e,f,A,a,o,0,0,a,o)}isThumbnailBlank(){let t=this.canvas.getContext("2d",{willReadFrequently:!0}),e=t.getImageData(this.canvas.width*.25,this.canvas.height*.25,1,1).data,i=t.getImageData(this.canvas.width*.5,this.canvas.height*.5,1,1).data,s=t.getImageData(this.canvas.width*.75,this.canvas.height*.75,1,1).data;return oa(e)&&oa(i)&&oa(s)}getThumbnail(t,e){return new Promise((i,s)=>{e==null||e.addEventListener("abort",()=>s("getThumbnail promise aborted")),Y(this,null,function*(){if(!this.thumbnailInfo)try{this.thumbnailInfo=yield this.thumbnailInfoPromise}catch(A){this.errorEventListener(A),s(A);return}if(e!=null&&e.aborted)return;let{interval:r,group:a}=this.thumbnailInfo,o=Math.trunc(t/r);if(this.thumbailCache.has(o)){let A=this.thumbailCache.get(o);i(A);return}let l=r*a,u=Math.trunc(t/l);if(this.spriteCache.has(u)){let A=yield this.spriteCache.get(u);if(this.clipThumbnail(t,A),!this.isThumbnailBlank()){let f=this.canvas.toDataURL("image/jpeg",.5);this.thumbailCache.set(o,f),i(f);return}}let c,h=this.fetchSprite(u);this.spriteCache.set(u,h);try{c=yield h}catch(A){this.errorEventListener(A),setTimeout(()=>this.spriteCache.delete(u),2e3),s();return}if(e!=null&&e.aborted)return;this.clipThumbnail(t,c);let d=this.canvas.toDataURL("image/jpeg",.5);this.thumbailCache.set(o,d),i(d)})})}getThumbnailCache(t){if(!this.thumbnailInfo)return;let e=Math.trunc(t/this.thumbnailInfo.interval);return this.thumbailCache.get(e)}clearThumbnail(){this.thumbailCache.clear(),this.spriteCache.clear()}setErrorEventListener(t){this.errorEventListener=t}debug_getSprite(t){return Y(this,null,function*(){return this.thumbnailInfo||(yield this.getThumbnail(0)),(yield this.fetchSprite(t)).src})}};var Je=class{constructor(t,e,i,s,r,a){this.controlJsonObserverList=[];this.controlJsonUrl=t,this.control=e,this.rawControl=i,this.timeDiff=s,this.api=a,this.errorEventListener=r,this.startPolling()}get isPollingEnabled(){return this.pollingTimerId!==void 0}static create(t,e,i){return Y(this,null,function*(){let{control:s,rawControl:r,timeDiff:a}=yield i.fetchControl(t,!0);return new Je(t,s,r,a,e,i)})}updateControlJson(){return Y(this,null,function*(){try{let{control:t,rawControl:e,timeDiff:i}=yield this.api.fetchControl(this.controlJsonUrl,!1);this.control=t,this.rawControl=e,this.timeDiff=i}catch(t){this.errorEventListener(t);return}this.controlJsonObserverList.forEach(t=>t.onUpdateControlJson())})}getSimulVideoinfoURL(t){return this.control[t].video_descriptor}getProgramInfo(t,e){let i=this.control[t].program,s=e.getTime();for(let r of i)if(r.start_at<=s&&s<=r.end_at)return r}getProgramInfoByStreamId(t){for(let e of Gl){let i=this.control[e].program.find(s=>s.id===t);if(i)return i}}getRawControl(){return this.rawControl}getTimeDiff(){return this.timeDiff}getMessageInfo(t){return this.control[t].message}addControlJsonObserver(t){this.controlJsonObserverList.push(t)}clearControlJsonObserverList(){this.controlJsonObserverList=[]}startPolling(){this.isPollingEnabled||(this.pollingTimerId=window.setInterval(()=>this.updateControlJson(),60*1e3))}stopPolling(){window.clearInterval(this.pollingTimerId),this.pollingTimerId=void 0}destroy(){this.stopPolling()}setErrorEventListener(t){this.errorEventListener=t}};var Gs=class{setMessageView(t){this.messageElem=t}showMessage(t){this.messageElem.style.backgroundImage=t,this.messageElem.style.backgroundRepeat="no-repeat",this.messageElem.style.backgroundSize="contain",this.messageElem.style.backgroundPosition="center"}hideMessage(){this.messageElem.style.backgroundImage="",this.messageElem.style.backgroundRepeat="",this.messageElem.style.backgroundSize="",this.messageElem.style.backgroundPosition=""}};var gu="iVBORw0KGgoAAAANSUhEUgAAB4AAAAQ4CAYAAADo08FDAAAACXBIWXMAAAsTAAALEwEAmpwYAAAO1GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOnhtcFJpZ2h0cz0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3JpZ2h0cy8iIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjk1ZTQzYTVkLWZhMWMtMTA0Yi04MTVlLWMxMmMwZjE5MDg0NyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1ZWQzMDg5Ni0wOTFiLTRlMGMtODE3Yi1jMWVmZTYxYzk1ZTYiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0idXVpZDo1Q0ExNjA4Mjc4NENERDExODY0MEZBMkUzMDMyNUMxRSIgeG1wOk1vZGlmeURhdGU9IjIwMjItMDEtMjBUMjE6NTk6NDIrMDk6MDAiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDA4LTA3LTA1VDIzOjAwOjU0KzA5OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIyLTAxLTIwVDIxOjU5OjQyKzA5OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBSaWdodHM6TWFya2VkPSJGYWxzZSIgdGlmZjpPcmllbnRhdGlvbj0iMSIgdGlmZjpYUmVzb2x1dGlvbj0iNzIwMDAwLzEwMDAwIiB0aWZmOllSZXNvbHV0aW9uPSI3MjAwMDAvMTAwMDAiIHRpZmY6UmVzb2x1dGlvblVuaXQ9IjIiIGV4aWY6Q29sb3JTcGFjZT0iMSIgZXhpZjpQaXhlbFhEaW1lbnNpb249IjE5MjAiIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSIxMDgwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ZmU1YWNhNWYtNmZiZi00Mjk0LWFlMmMtNWRmYTdjNDU1MDkzIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6MGNiZjI5ZWYtZDJjNC1iMjQ4LWJiMzUtYTU4ZTc4ZGY1YWZlIiBzdFJlZjpvcmlnaW5hbERvY3VtZW50SUQ9InV1aWQ6NUNBMTYwODI3ODRDREQxMTg2NDBGQTJFMzAzMjVDMUUiLz4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MDE4MDExNzQwNzIwNjgxMTkxMDlCMTM0OTBBMjc4NEYiIHN0RXZ0OndoZW49IjIwMTEtMDgtMDJUMTI6MTQ6NTQrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDUzUgTWFjaW50b3NoIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpmZTVhY2E1Zi02ZmJmLTQyOTQtYWUyYy01ZGZhN2M0NTUwOTMiIHN0RXZ0OndoZW49IjIwMjItMDEtMjBUMjE6NTk6NDIrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjb252ZXJ0ZWQiIHN0RXZ0OnBhcmFtZXRlcnM9ImZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImRlcml2ZWQiIHN0RXZ0OnBhcmFtZXRlcnM9ImNvbnZlcnRlZCBmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1ZWQzMDg5Ni0wOTFiLTRlMGMtODE3Yi1jMWVmZTYxYzk1ZTYiIHN0RXZ0OndoZW49IjIwMjItMDEtMjBUMjE6NTk6NDIrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChNYWNpbnRvc2gpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8cGhvdG9zaG9wOlRleHRMYXllcnM+IDxyZGY6QmFnPiA8cmRmOmxpIHBob3Rvc2hvcDpMYXllck5hbWU9Ik5IS+ODl+ODqeOCueOBp+OBr+OAgeaUvumAgeS4reOBrueVque1hOOBqCDopovpgIPjgZfnlarntYTjgpLjgZTopqfjgYTjgZ/jgaDjgZHjgb7jgZnjgIIgV2Vi44K144Kk44OI44GL44KJ55m76Yyy5omL57aa44GN44KS44GZ44KL44Go44CBIOOBk+OBruODoeODg+OCu+ODvOOCuOOBr+ihqOekuuOBlSIgcGhvdG9zaG9wOkxheWVyVGV4dD0iTkhL44OX44Op44K544Gn44Gv44CB5pS+6YCB5Lit44Gu55Wq57WE44GoIOimi+mAg+OBl+eVque1hOOCkuOBlOimp+OBhOOBn+OBoOOBkeOBvuOBmeOAgiBXZWLjgrXjgqTjg4jjgYvjgonnmbvpjLLmiYvntprjgY3jgpLjgZnjgovjgajjgIEg44GT44Gu44Oh44OD44K744O844K444Gv6KGo56S644GV44KM44Gq44GP44Gq44KK44G+44GZ44CCIOeZu+mMsuWujOS6huOBq+OBr+OAgeWPl+S/oeWlkee0hOeKtuazgeOBrueiuuiqjeOBjCDlv4XopoHjgavjgarjgorjgb7jgZnjgIIgIi8+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6VGV4dExheWVycz4gPHBob3Rvc2hvcDpEb2N1bWVudEFuY2VzdG9ycz4gPHJkZjpCYWc+IDxyZGY6bGk+NjhDRkE3NUE3OTNBN0JCNUJCRjYxNUMyQUI4OEZDRDY8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6MGNiZjI5ZWYtZDJjNC1iMjQ4LWJiMzUtYTU4ZTc4ZGY1YWZlPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjNmZWFkZTUxLTI3YzctNzQ0MC05OGE2LTc2NGY3ZmU5NjEwOTwvcmRmOmxpPiA8cmRmOmxpPnV1aWQ6MDFGMzExNDZGQzFBMTFERTlCRTI5NTE1NTcwNDIyQ0Y8L3JkZjpsaT4gPHJkZjpsaT51dWlkOjI4OTEyNDEzNDdFQkRFMTE5NDFCRDYzMkNBQThFNjcyPC9yZGY6bGk+IDxyZGY6bGk+dXVpZDo1Q0ExNjA4Mjc4NENERDExODY0MEZBMkUzMDMyNUMxRTwvcmRmOmxpPiA8cmRmOmxpPnV1aWQ6NjU5OTgxQzRGQzg4MTFERUI5MTdCMkI5MUMxMTczMTc8L3JkZjpsaT4gPHJkZjpsaT54bXAuZGlkOjRmMTBjY2ExLWU1YjEtNGJiZS1iZWQxLWI2MTlhMzIzYzAwYTwvcmRmOmxpPiA8cmRmOmxpPnhtcC5kaWQ6NmMwYjBmZDctMjY2Yi00YWFlLWFiNjEtZjEyMzVlN2IwYTU2PC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+eBG95wABc71JREFUeJzs3W+IlPe9N/5PDvezlXpoYJNwGwrr6RQJ3WCCUDRFMlVWUyzhEO0cyYPIbrUwnoTsghLi+kATigtr0FuhJrMkD4LZ6M3hUDnVRbMlpFkCUmW3FHFbF0Jzk2TBcgzOY38P/M0eZ+fa/zP75+vrBYHO5cw135m95prp9f5+Pt9H7t27FwAAAAAAAACsfP+01AMAAAAAAAAAoD4EwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMAAAAAAAAkQgAMAAAAAAAAkAgBMAAAAAAAAEAiBMAAAAAAAAAAiRAAAwAAAAAAACRCAAwAAAAAAACQCAEwAAAAAAAAQCIEwAAAAAAAAACJEAADAAAAAAAAJEIADAAAAAAAAJAIATAAAAAAAABAIgTAAAAAAAAAAIkQAAMA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F2u9yEoQnM/n4+c//3nm+zRXN2/erMvYsi78T15jNsu2bduit7c39u3bN6eWxBXlcjmOHTu2qBMCZjq37927t6EBXy6Xi8OHD9dsHxkZmTjvTddyuLe3NwqFQtW2crk88Tnv7e2Nl19+edrw/fjx49O2mq6M4+23384897S0tMSpU6dix44d006qma7SbmRkpOZzt23btllNKljKqrz9+/cv2XM/DP7whz/M6vtubGws/vM//3NJKsNXrVqVWYU/k6yJG/PZT2UMC3H16tUYGBiY+KwNDQ0t6H2cTVVtxP1JNvX6Xd3a2hr37t2LiPvnk6effnrWj618H3d3d8e2bdvqOjELVgoBMAAAAMvCXC7q1FNHR0fdqkoW8zUsdNyLMdbZhEszmaoKeGxsLP70pz/Ff/zHfyzJupH1NtMF8fHx8fjb3/4WN27cWBbVaXv27Klqs7vcKq+7urriqaeeira2tkULfx80ODhY9V4Ui8VYv359rFmzJp544ok5hVt///vf6zKm0dHRKJfLVSFuU1NT5PP5Gf9uXV1dcebMmThw4MCsW+dXJmYs1YSAjo6OWLduXc1F/8q64I30zDPPZIaz77777sT/3rp165zC/eHh4cjlclO2t64YHx+P1157bVbnxf7+/rh27VqcP39+ymOyra0tnnvuuXjmmWcy/45TtZQdGxubcm3sbdu2RXd3d+zfv39e65s32sNSJblUzp49O+2kgaWY2DRZZQJEPdRrP3NVqdbO5/Px61//eskq6pfa0aNH4+jRo5HL5WLfvn3x1FNPxQ9/+EOVwTwUBMAAAADAsnX69OnYvXt3rFq1Kq5evRpffvllfPzxx8mt13jlypUoFApx69atuHv3bty4cSPu3LkzpzWTF1Olze4rr7yyrILfB1UqV6erglwsU/0NK5VhLS0tsXr16ontlaA44n4VV72cOXMmVq9eHdevX591K/aK0dHRiUknuVwutm7dWjPuiPuB4I0bN5bFMbFnz564du1aNDU1RblcjoMHDy7K5ymrAnloaKjquecaMn7xxRcxOjoaFy5cmDI8GxgYiFdffXVO58fR0dF4+umnp63u6+/vn3KfWZ0axsbGYvv27dOOoxLK9Pb2xosvvrhswphyuZzc98tyMzg4GAMDA/HEE09MtPpeDhObUjV5QtLDanR0tOb3QKFQiEcffbSmcnvD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";var Jf=n=>{let t=window.atob(n.replace(/^.*,/,"")),e=new Uint8Array(t.length);for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return new Blob([e.buffer],{type:"image/png"})},Hs=class{constructor(t){this.imageMap=new Map;this.controljsonManager=t,this.domManipulator=new Gs,this.embeddedMessage=URL.createObjectURL(Jf(gu))}setMessageView(t){this.domManipulator.setMessageView(t)}setMessageChangeTimer(t){let{schedule:e}=this.controljsonManager.getMessageInfo(t),i=Date.now(),s=e.slice().reverse(),r;for(let a of s)if(i<=a.show_at){r=a.show_at;break}else if(i<=a.hide_at){r=a.hide_at;break}this.nextMessageChangeTime!==r&&(this.nextMessageChangeTime=r,r&&(this.timerId=window.setTimeout(()=>{this.channel&&(this._showMessageImage(this.channel),this.setMessageChangeTimer(this.channel))},r-Date.now())))}showMessage(t){return Y(this,null,function*(){return this.channel=t,window.clearInterval(this.timerId),this.setMessageChangeTimer(t),this._showMessageImage(t)})}hideMessage(){this.channel=void 0,window.clearInterval(this.timerId),this.domManipulator.hideMessage()}_showMessageImage(t){return Y(this,null,function*(){let e=yield this.getMeesageImage(t);e?this.domManipulator.showMessage(`url(${e})`):this.domManipulator.hideMessage()})}getMeesageImage(t){return Y(this,null,function*(){let e=this.controljsonManager.getMessageInfo(t);if(!e)return this.embeddedMessage;if(!e.enabled)return;let i=Date.now(),s=e.schedule.find(({show_at:o,hide_at:l})=>o<=i&&i<=l),r=s?s.image_url:e.default_image_url;if(!r)return;let a=this.imageMap.get(r);if(a)return a;try{let o=yield fetch(r).then(u=>u.blob()),l=URL.createObjectURL(o);return this.imageMap.set(r,l),l}catch(o){return this.embeddedMessage}})}getShouldShowMessage(t){return Y(this,null,function*(){return Boolean(yield this.getMeesageImage(t))})}onUpdateControlJson(){this.channel&&(this._showMessageImage(this.channel),this.setMessageChangeTimer(this.channel))}destroy(){this.imageMap.clear(),window.clearInterval(this.timerId)}};var $f=680,xe={Container:"tvplus-player__correction-container",Row:"tvplus-player__correction-row"},tg=`
.${xe.Container} {
  display: flex;
  flex-direction: column;
  box-sizing: border-box;
  position: absolute;
  background-color: rgba(0, 0, 0, 0.5);
  color: white;
  width: 100%;
  top: 0px;
  margin-top: 0px;
  font-family: "Hiragino Kaku Gothic ProN", "Meiryo", "\u30E1\u30A4\u30EA\u30AA", sans-serif;
  line-height: 1;
}

.${xe.Container}.-disabled {
  display: none;
}

.${xe.Row} {
  margin: 12px 0 8px 16px;
}

.${xe.Row}.-small {
  margin: 4px 0 2px 10px;
}

.${xe.Row}:empty {
  display: none;
}
`,pu="tvplus-player__correction--styles",la=class{constructor(){this.css=null;this.mountPoint=null;this.fontSize=0;this.onResizeHandler=this.onResize.bind(this);this.mutationObserver=null;this.resizeObserver=null}attachCorrectionRoot(t){if(!document.getElementById(pu)){let e=URL.createObjectURL(new Blob([tg]));this.css=document.createElement("link"),this.css.setAttribute("rel","stylesheet"),this.css.setAttribute("href",e),this.css.setAttribute("id",pu),document.body.appendChild(this.css)}this.mountPoint&&this.mountPoint.removeChild(this.container),this.mountPoint=t,this.container=document.createElement("div"),this.upper=document.createElement("div"),this.lower=document.createElement("div"),this.container.classList.add(xe.Container),this.upper.classList.add(xe.Row),this.lower.classList.add(xe.Row),this.container.appendChild(this.upper),this.container.appendChild(this.lower),this.mountPoint.appendChild(this.container),this.onResize(),window.ResizeObserver?(this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.resizeObserver=new ResizeObserver(()=>{this.onResize()}),this.resizeObserver.observe(this.container)):window.MutationObserver&&(this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null,window.removeEventListener("resize",this.onResizeHandler)),window.addEventListener("resize",this.onResizeHandler),this.mutationObserver=new MutationObserver(()=>{this.onResize()}),this.mutationObserver.observe(this.container,{attributes:!0,attributeFilter:["class","style"]}))}onResize(){let t=this.container.offsetWidth;t<=$f?(this.fontSize=t/20-1,this.upper.classList.add("-small"),this.lower.classList.add("-small")):(this.fontSize=t*.7/20-1,this.upper.classList.remove("-small"),this.lower.classList.remove("-small")),this.container.style.cssText=`font-size: ${this.fontSize}px;`}onChangeCorrection(t,e){this.upper.innerText=t,this.lower.innerText=e}setCorrectionEnabled(t){!t?this.container.classList.remove("-disabled"):this.container.classList.add("-disabled")}destroy(){var t;this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null,window.removeEventListener("resize",this.onResizeHandler)),this.css&&document.body.removeChild(this.css),this.container&&((t=this.mountPoint)==null||t.removeChild(this.container))}},Xs=class{constructor(){this.domManipulator=new la;this.correctionList=[];this.currentCorrection=void 0}setCorrectionView(t){this.domManipulator.attachCorrectionRoot(t)}hasCorrectionView(){return Boolean(this.domManipulator.mountPoint)}setCorrectionList(t){this.correctionList=t}setCorrectionEnabled(t){this.domManipulator.setCorrectionEnabled(t)}onUpdateCurrentTime(t){var r,a;let e=this.correctionList.find(({start:o,duration:l})=>o<=t&&t<=o+l);if(this.currentCorrection===e)return;this.currentCorrection=e;let i=(r=e==null?void 0:e.message.substring(0,20))!=null?r:"",s=(a=e==null?void 0:e.message.substring(20,40))!=null?a:"";this.domManipulator.onChangeCorrection(i,s)}destroy(){this.domManipulator.destroy()}};var qs=class{constructor(t,e,i,s,r,a){this.isStarted=!1;this.sessionEnded=!1;this.onPlayingHandler=this.onPlaying.bind(this);this.onPlayHandler=this.onPlay.bind(this);this.onSeekedHandler=this.onSeeked.bind(this);this.onPauseHandler=this.onPause.bind(this);this.player=t,this.interval1=e,this.interval2=i,this.heartbeatUrl=s,this.playbackStateUrl=r,this.onErrorHandler=a,this.player.addEventListener("playing",this.onPlayingHandler),this.player.addEventListener("play",this.onPlayHandler),this.player.addEventListener("seeked",this.onSeekedHandler),this.player.addEventListener("pause",this.onPauseHandler)}onPlaying(){!this.isStarted&&!this.player.seeking&&(this.isStarted=!0,this.sendData("start"))}onPlay(){this.player.seeking||this.sendData("discontinuity")}onSeeked(){if(!this.player.paused){if(!this.isStarted){this.isStarted=!0,this.sendData("start");return}this.sendData("discontinuity")}}onPause(){this.player.seeking||this.sendData("end")}sendData(t){return Y(this,null,function*(){var A,f,p,m,v,b,T,L,I,k,R,D,O,P,V,y,S,x,E,F,N,M,_,B,X,H,J,et,st,nt,Tt,Lt,qt,$e,Ii,Ri,_e,Ne,js;if(this.sessionEnded||!this.isStarted)return;t==="end"&&window.clearTimeout(this.timerId);let e=Date.now(),i;t==="start"||t==="discontinuity"?(i=0,this.lastSendTime=void 0,this.lastSendType0Time=e,window.clearTimeout(this.timerId)):e-this.lastSendType0Time<this.interval2*1e3?i=1:i=2;let s=typeof((A=this.payload)==null?void 0:A.startPosition)=="number"?(f=this.payload)==null?void 0:f.startPosition:NaN,a=(typeof((p=this.payload)==null?void 0:p.endPosition)=="number"?(m=this.payload)==null?void 0:m.endPosition:NaN)-s,o=Number.isFinite(a)?a:Number.isFinite(this.player.duration)?Math.floor(this.player.duration*1e3):0,l;if(((v=this.payload)==null?void 0:v.typeOfList)==="moment"){let K=(b=this.player.getCurrentDate())==null?void 0:b.getTime();K&&Number.isFinite(s)?l=K-s:l=this.player.currentTime*1e3}else l=this.player.currentTime*1e3;let u=Math.max(Math.floor(l),0),c=i===0?0:this.lastSendTime?e-this.lastSendTime:0,h=l<0?0:c,d=ql(e);if(this.heartbeatUrl){let K=yield fetch(this.heartbeatUrl,{method:"post",headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"},body:JSON.stringify({message:"heartbeat",value:t,currentPosition:u,interval:h,type:i,profileId:(T=this.payload)==null?void 0:T.profileId,status:(L=this.payload)==null?void 0:L.status,policyVer:(I=this.payload)==null?void 0:I.policyVer,deckId:(k=this.payload)==null?void 0:k.deckId,deckUId:(R=this.payload)==null?void 0:R.deckUId,typeOfDeck:(D=this.payload)==null?void 0:D.typeOfDeck,playlistId:(O=this.payload)==null?void 0:O.playlistId,playlistUId:(P=this.payload)==null?void 0:P.playlistUId,itemId:(V=this.payload)==null?void 0:V.itemId,index:(y=this.payload)==null?void 0:y.index,modeOfItem:(S=this.payload)==null?void 0:S.modeOfItem,typeOfItem:(x=this.payload)==null?void 0:x.typeOfItem,typeOfList:(E=this.payload)==null?void 0:E.typeOfList,mediaAction:(F=this.payload)==null?void 0:F.mediaAction,duration:o,deviceId:(N=this.payload)==null?void 0:N.deviceId,appName:(M=this.payload)==null?void 0:M.appName,deviceType:(_=this.payload)==null?void 0:_.deviceType,ua:(X=(B=this.payload)==null?void 0:B.ua)!=null?X:window.navigator.userAgent,dateBeat:d,tag:(H=this.payload)==null?void 0:H.tag,area:(J=this.payload)==null?void 0:J.area,context:(et=this.payload)==null?void 0:et.context,profileType:(st=this.payload)==null?void 0:st.profileType,entity:(nt=this.payload)==null?void 0:nt.entity,activatedBy:(Tt=this.payload)==null?void 0:Tt.activatedBy})}).catch(()=>{});if(((K==null?void 0:K.ok)||this.lastSendTime===void 0)&&(this.lastSendTime=e),!(K!=null&&K.ok))if(K){let bt=yield K.json().catch(()=>({error:{code:0,statuscode:K.status,message:""}}));this.onErrorHandler(bt)}else this.onErrorHandler({error:{code:0,statuscode:0,message:"Failed to fetch"}})}if(this.playbackStateUrl&&t==="end"&&fetch(this.playbackStateUrl,{method:"post",headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"},body:JSON.stringify({currentPosition:Math.max(u,0),status:(Lt=this.payload)==null?void 0:Lt.status,itemId:(qt=this.payload)==null?void 0:qt.itemId,index:($e=this.payload)==null?void 0:$e.index,modeOfItem:(Ii=this.payload)==null?void 0:Ii.modeOfItem,typeOfItem:(Ri=this.payload)==null?void 0:Ri.typeOfItem,mediaAction:(_e=this.payload)==null?void 0:_e.mediaAction,duration:o,dateBeat:d,context:(Ne=this.payload)==null?void 0:Ne.context,policyVer:(js=this.payload)==null?void 0:js.policyVer})}).catch(()=>{}),window.clearTimeout(this.timerId),t!=="end"){let K=i===0||i===1?this.interval1:this.interval2;this.timerId=window.setTimeout(()=>this.sendData("continuity"),K*1e3)}})}clearSession(){this.lastSendTime=void 0,this.lastSendType0Time=void 0,this.isStarted=!1,window.clearTimeout(this.timerId),this.timerId=void 0,this.sessionEnded=!1}startSession(){this.clearSession()}endSession(){this.sessionEnded=!0,window.clearTimeout(this.timerId)}destroy(){this.endSession(),this.player.removeEventListener("playing",this.onPlayingHandler),this.player.removeEventListener("play",this.onPlayHandler),this.player.removeEventListener("seeked",this.onSeekedHandler),this.player.removeEventListener("pause",this.onPauseHandler)}};var mu=1500,eg={Live:"Live",DVR:"DVR",VOD:"VOD"},Li=class{constructor(t,e,i,s,r,a){this.videoParent=null;var o;this.playerCore=a,this.errorEventListener=(o=t.errorEventListener)!=null?o:()=>{},this.controlJsonManager=e,this.messageManager=new Hs(e),s&&this.messageManager.setMessageView(s),this.option=t,this.bitrateLimit=Number.MAX_SAFE_INTEGER,this.isABREnabled=!0,this.correctionManager=new Xs,this.playerCore.addPlayerObserver(this.correctionManager),this.isAuthorized=r,r||Object.defineProperty(this,"isAuthorized",{writable:!1,configurable:!1}),this.videoParent=i.parentElement}static create(t,e,i){return Y(this,null,function*(){if(t.errorEventListener||(t.errorEventListener=()=>{}),!t.drcsAltCharMap&&t.drcsAltCharUrl)try{t.drcsAltCharMap=yield $t.fetchDRCSAltChars(t.drcsAltCharUrl)}catch(l){t.errorEventListener(l),t.drcsAltCharMap=new Map}let r=yield Je.create(t.controlJsonUrl?t.controlJsonUrl:"",t.errorEventListener,t.controlJsonUrl?$t:fu),a=ke()?new Ye(t,e):new Ze(t,e);return new Li(t,r,e,i,!0,a)})}setMessageView(t){this.messageManager.setMessageView(t)}setSubtitleView(t){this.playerCore.setSubtitleView(t)}setCorrectionView(t){this.correctionManager.setCorrectionView(t)}setErrorEventListener(t){var e;this.errorEventListener=t,this.playerCore.setErrorEventListener(t),this.controlJsonManager.setErrorEventListener(t),(e=this.thumbnailManager)==null||e.setErrorEventListener(t)}initLive(t,e,i=!0){if(!this.option.controlJsonUrl)throw new Error("Live\u6A5F\u80FD\u304C\u7121\u52B9\u3067\u3059");let s=this.controlJsonManager.getSimulVideoinfoURL(t);return this.channel=t,this.dvrStreamId=void 0,this._init({videoinfoUrl:s,drmToken:e,startPos:-1,endPos:void 0,isCMCDEnabled:i,isLive:!0})}initDVR(t,e,i,s=!0){if(!this.option.controlJsonUrl)throw new Error("Live\u6A5F\u80FD\u304C\u7121\u52B9\u3067\u3059");let r=this.controlJsonManager.getProgramInfoByStreamId(t);if(!r)throw new Error("\u6307\u5B9A\u3055\u308C\u305Fstream_id\u306B\u4E00\u81F4\u3059\u308B\u756A\u7D44\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093");if(!r.allow_dvr||!r.video_descriptor)throw new Error("\u8FFD\u3044\u304B\u3051\u518D\u751F\u4E0D\u53EF\u306E\u756A\u7D44\u3067\u3059");return this.channel=void 0,this.dvrStreamId=t,this._init({videoinfoUrl:r.video_descriptor,isCMCDEnabled:s,startPos:Math.max(e,.03),drmToken:i,endPos:void 0,isLive:!1})}initVOD(t,e,i,s,r=!0){return this.channel=void 0,this.dvrStreamId=void 0,this._init({videoinfoUrl:t,isCMCDEnabled:r,drmToken:s,startPos:e,endPos:i,isLive:!1})}init1MinuteVOD(t,e,i,s=!0){return this.channel=void 0,this.dvrStreamId=void 0,this._init({videoinfoUrl:Yn(t),isCMCDEnabled:s,drmToken:i,startPos:e,endPos:void 0,isLive:!1})}initWithVideoinfoUrl(t,e,i,s,r=!0){this.channel=void 0,this.dvrStreamId=void 0;let a=t.includes("/simul/");return this._init({videoinfoUrl:t,drmToken:s,startPos:Math.max(e,.03),endPos:i,isCMCDEnabled:r,isLive:a})}_init(t){return Y(this,null,function*(){var i;!this.playerCore.hasSubtitleView()&&this.videoParent&&this.playerCore.setSubtitleView(this.videoParent),!this.correctionManager.hasCorrectionView()&&this.videoParent&&this.correctionManager.setCorrectionView(this.videoParent),(i=this.abortController)==null||i.abort(),this.abortController=new AbortController;let e=this.abortController.signal;return new Promise((s,r)=>Y(this,null,function*(){var d,A,f,p,m;e.addEventListener("abort",()=>r("init process is aborted.")),this.playerCore.playbackRate=1,this.timerId&&window.clearInterval(this.timerId);let a=t.drmToken;this.controlJsonManager.clearControlJsonObserverList(),this.controlJsonManager.addControlJsonObserver(this.messageManager),this.controlJsonManager.addControlJsonObserver(this);try{this.videoInfo=yield $t.fetchVideoInfo(t.videoinfoUrl)}catch(v){r(v);return}if(e.aborted)return;(d=this.thumbnailManager)==null||d.clearThumbnail(),this.thumbnailManager=void 0;let o=t.drmToken?this.getDRMType():"bare",u=o==="cenc"&&this.videoInfo.needL1HD&&!this.option.widevineL1Available?Math.min(this.bitrateLimit,mu):this.bitrateLimit,h=this.videoInfo.manifests.filter(v=>v.drmType===o&&v.bitrateType===this.getBitrateType()&&v.bitrateLimit<=u&&v.videoCodec==="H.264"&&v.dynamicRange==="SDR").sort((v,b)=>b.bitrateLimit-v.bitrateLimit)[0];h||(h=this.videoInfo.manifests.filter(v=>v.drmType===this.getDRMType())[0]);try{yield this.playerCore.init({manifestUrl:h.url,startPos:t.startPos,endPos:t.endPos,isCMCDEnabled:t.isCMCDEnabled,drmToken:a,isLive:t.isLive,widevineLicenseUrl:(A=this.videoInfo.widevineLicenseUrl)!=null?A:this.option.widevineLicenseUrl,fairplayCertUrl:(f=this.videoInfo.fairplayLicenseUrl)!=null?f:this.option.fairplayCertUrl,fairplayLicenseUrl:(p=this.videoInfo.fairplayLicenseUrl)!=null?p:this.option.fairplayLicenseUrl,hlsjsOption:this.option.hlsJsOption})}catch(v){r(v);return}if(!e.aborted){if(this.channel){let v=(m=this.getCurrentDate())!=null?m:new Date(Date.now()+this.getTimeDiff()-5e4),b=this.controlJsonManager.getProgramInfo(this.channel,v);if(b){if(b!=null&&b.video_descriptor){let T=yield $t.fetchVideoInfo(b.video_descriptor).catch(()=>{});this.videoInfo.thumnails=T==null?void 0:T.thumnails}this.dvrStreamId=b.id,this.timerId=window.setTimeout(()=>{this.onUpdateControlJson()},b.end_at-v.getTime()+3e3)}}e.aborted||(this.videoInfo.thumnails&&(this.thumbnailManager=new Qe(this.videoInfo.thumnails,this.errorEventListener)),this.correctionManager.setCorrectionList(this.videoInfo.corrections),s())}}))})}onUpdateControlJson(){return Y(this,null,function*(){var i,s;if(!this.channel)return;let t=this.playerCore.getCurrentDate();if(!t)return;let e=this.controlJsonManager.getProgramInfo(this.channel,t);!e||this.dvrStreamId!==e.id&&(this.dvrStreamId=e.id,(i=this.thumbnailManager)==null||i.clearThumbnail(),this.thumbnailManager=void 0,!!(e!=null&&e.video_descriptor)&&e.video_descriptor.length!==0&&(this.videoInfo=yield $t.fetchVideoInfo(e.video_descriptor).catch(()=>{}),(s=this.videoInfo)!=null&&s.thumnails&&(this.thumbnailManager=new Qe(this.videoInfo.thumnails,this.errorEventListener),this.timerId&&window.clearTimeout(this.timerId),this.timerId=window.setTimeout(()=>{this.onUpdateControlJson()},e.end_at-t.getTime()+3e3))))})}play(){return this.playerCore.play()}pause(){this.playerCore.pause()}get paused(){return this.playerCore.paused}stop(){this.playerCore.stop()}destroy(){var t,e;this.stop(),this.playerCore.destroy(),(t=this.controlJsonManager)==null||t.destroy(),(e=this.thumbnailManager)==null||e.clearThumbnail(),this.messageManager.destroy(),this.correctionManager.destroy()}getCurrentDate(){return this.playerCore.getCurrentDate()}get currentTime(){return this.playerCore.currentTime}set currentTime(t){this.playerCore.currentTime=t}get volume(){return this.playerCore.volume}set volume(t){this.playerCore.volume=t}get muted(){return this.playerCore.muted}set muted(t){this.playerCore.muted=t}canChangePlaybackRate(){var t;return(t=this.videoInfo)==null?void 0:t.allowMultispeed}setPlaybackRate(t){this.canChangePlaybackRate()&&(this.playerCore.playbackRate=t)}getPlaybackRate(){return this.playerCore.playbackRate}get duration(){return this.playerCore.duration}get seeking(){return this.playerCore.seeking}getAudioTrackNameList(){return this.playerCore.getAudioTrackNameList()}getAudioTrackName(){return this.playerCore.getAudioTrackName()}setAudioTrackName(t){this.playerCore.setAudioTrackName(t)}get isThumbnailAvailable(){return this.thumbnailManager!==void 0}getThumbnail(t,e){var i,s;return(s=(i=this.thumbnailManager)==null?void 0:i.getThumbnail(t,e))!=null?s:Promise.resolve("")}getThumbnailCache(t){var e;return(e=this.thumbnailManager)==null?void 0:e.getThumbnailCache(t)}clearThumbnailCache(){var t;(t=this.thumbnailManager)==null||t.clearThumbnail()}getAvailableBitrateList(){return this.videoInfo?this.videoInfo.manifests.filter(t=>t.drmType===this.getDRMType()&&t.bitrateType==this.getBitrateType()&&t.videoCodec==="H.264"&&t.dynamicRange==="SDR").map(t=>t.bitrateLimit).sort((t,e)=>e-t):[]}setBitrateLimit(t){this.bitrateLimit=t}getBitrateLimit(){return this.bitrateLimit}setIsABREnabled(t){this.isABREnabled=t}getIsABREnabled(){return this.isABREnabled}setCorrectionEnabled(t){this.correctionManager.setCorrectionEnabled(t)}setSubtitleEnabled(t){this.playerCore.setSubtitleEnabled(t)}addSubtitleCallback(t){this.playerCore.addSubtitleCallback(t)}removeSubtitleCallback(t){this.playerCore.removeSubtitleCallback(t)}addEventListener(t,e,i){this.playerCore.addEventListener(t,e,i)}removeEventListener(t,e,i){this.playerCore.removeEventListener(t,e,i)}showMessageImage(t){return Y(this,null,function*(){return this.messageManager.showMessage(t)})}hideMessageImage(){this.messageManager.hideMessage()}getShouldShowMessageImage(t){return this.messageManager.getShouldShowMessage(t)}updateDRMToken(t){this.playerCore.setDRMToken(t)}canPlay1MinuteVOD(t,e=3e3){return Y(this,null,function*(){return(yield $t.fetchVideoInfo(Yn(t),e)).manifests.length!==0})}getDRMType(){return ke()?"cbcs":"cenc"}getBitrateType(){return this.isABREnabled?"Multi":"Single"}startPolling(){this.controlJsonManager.startPolling()}stopPolling(){this.controlJsonManager.stopPolling()}getControlJson(){return this.controlJsonManager.getRawControl()}getProgramInfoList(){let{control_7fe0_0400:t,control_7fe0_0401:e,control_7fe1_0408:i,control_7fe1_040a:s}=this.controlJsonManager.getRawControl();return{g1:t.program,g2:e.program,e1:i.program,e3:s.program}}getTimeDiff(){return this.controlJsonManager.getTimeDiff()}getMasterPlaylistURL(t){return Y(this,null,function*(){var a;let e=yield $t.fetchVideoInfo(t),s=this.getDRMType()==="cenc"&&e.needL1HD&&!this.option.widevineL1Available?Math.min(this.bitrateLimit,mu):this.bitrateLimit;return(a=e.manifests.filter(o=>o.drmType===this.getDRMType()&&o.bitrateType===this.getBitrateType()&&o.bitrateLimit<=s&&o.videoCodec==="H.264"&&o.dynamicRange==="SDR").sort((o,l)=>l.bitrateLimit-o.bitrateLimit)[0])==null?void 0:a.url})}initWithM3U8(t,e,i){return Y(this,null,function*(){this.thumbnailManager=void 0,this.debug_manifestUrl=t;let s=t.includes("/simul/");return this.playerCore.init({manifestUrl:t,startPos:e,endPos:void 0,isCMCDEnabled:!1,isLive:s,drmToken:i,widevineLicenseUrl:this.option.widevineLicenseUrl,fairplayCertUrl:this.option.fairplayCertUrl,fairplayLicenseUrl:this.option.fairplayLicenseUrl})})}debug_getManifestUrl(){}debug_getDVRDuration(){let t=this.controlJsonManager.getProgramInfo(this.channel,this.getCurrentDate());return t?(t.end_at-t.start_at)/1e3:0}debug_getProgram(t,e,i){return i===eg.Live?this.controlJsonManager.getProgramInfo(t,this.getCurrentDate()):this.controlJsonManager.getProgramInfoByStreamId(e)}debug_getPlayPosition(t,e,i){let s=this.debug_getProgram(t,e,i),r=s?this.getCurrentDate().getTime()-s.start_at:0;return Math.floor(r/1e3)}debug_getSprite(t,e){return Y(this,null,function*(){var i})}debug_addFragChangedCallback(t){this.playerCore.fragChangedCallback=t}};export{qs as HeartBeat,Li as default};
/**
 * [js-md5]{@link https://github.com/emn178/js-md5}
 *
 * @namespace md5
 * @version 0.8.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2023
 * @license MIT
 */
